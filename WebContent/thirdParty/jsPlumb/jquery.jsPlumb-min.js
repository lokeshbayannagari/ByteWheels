!function(){"undefined"==typeof Math.sgn&&(Math.sgn=function(t){return 0==t?0:t>0?1:-1});var t={subtract:function(t,n){return{x:t.x-n.x,y:t.y-n.y}},dotProduct:function(t,n){return t.x*n.x+t.y*n.y},square:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},scale:function(t,n){return{x:t.x*n,y:t.y*n}}},n=64,e=Math.pow(2,-n-1),s=function(n,e){for(var s=[],i=r(n,e),a=e.length-1,l=2*a-1,u=o(i,l,s,0),h=t.subtract(n,e[0]),d=t.square(h),p=0,m=0;u>m;m++){h=t.subtract(n,c(e,a,s[m],null,null));var f=t.square(h);d>f&&(d=f,p=s[m])}return h=t.subtract(n,e[a]),f=t.square(h),d>f&&(d=f,p=1),{location:p,distance:d}},i=function(t,n){var e=s(t,n);return{point:c(n,n.length-1,e.location,null,null),location:e.location}},r=function(n,e){for(var s=e.length-1,i=2*s-1,r=[],o=[],a=[],l=[],u=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],c=0;s>=c;c++)r[c]=t.subtract(e[c],n);for(var c=0;s-1>=c;c++)o[c]=t.subtract(e[c+1],e[c]),o[c]=t.scale(o[c],3);for(var h=0;s-1>=h;h++)for(var d=0;s>=d;d++)a[h]||(a[h]=[]),a[h][d]=t.dotProduct(o[h],r[d]);for(c=0;i>=c;c++)l[c]||(l[c]=[]),l[c].y=0,l[c].x=parseFloat(c)/i;for(var p=s,m=s-1,f=0;p+m>=f;f++){var g=Math.max(0,f-m),b=Math.min(f,p);for(c=g;b>=c;c++)j=f-c,l[c+j].y+=a[j][c]*u[j][c]}return l},o=function(t,e,s,i){var r,h,d=[],p=[],m=[],f=[];switch(a(t,e)){case 0:return 0;case 1:if(i>=n)return s[0]=(t[0].x+t[e].x)/2,1;if(l(t,e))return s[0]=u(t,e),1}c(t,e,.5,d,p),r=o(d,e,m,i+1),h=o(p,e,f,i+1);for(var g=0;r>g;g++)s[g]=m[g];for(var g=0;h>g;g++)s[g+r]=f[g];return r+h},a=function(t,n){var e,s,i=0;e=s=Math.sgn(t[0].y);for(var r=1;n>=r;r++)e=Math.sgn(t[r].y),e!=s&&i++,s=e;return i},l=function(t,n){var s,i,r,o,a,l,u,c,h,d,p,m,f,g,b,v;l=t[0].y-t[n].y,u=t[n].x-t[0].x,c=t[0].x*t[n].y-t[n].x*t[0].y;for(var y=max_distance_below=0,P=1;n>P;P++){var j=l*t[P].x+u*t[P].y+c;j>y?y=j:j<max_distance_below&&(max_distance_below=j)}return p=0,m=1,f=0,g=l,b=u,v=c-y,h=p*b-g*m,d=1/h,i=(m*v-b*f)*d,g=l,b=u,v=c-max_distance_below,h=p*b-g*m,d=1/h,r=(m*v-b*f)*d,o=Math.min(i,r),a=Math.max(i,r),s=a-o,e>s?1:0},u=function(t,n){var e=1,s=0,i=t[n].x-t[0].x,r=t[n].y-t[0].y,o=t[0].x-0,a=t[0].y-0,l=i*s-r*e,u=1/l,c=(i*a-r*o)*u;return 0+e*c},c=function(t,n,e,s,i){for(var r=[[]],o=0;n>=o;o++)r[0][o]=t[o];for(var a=1;n>=a;a++)for(var o=0;n-a>=o;o++)r[a]||(r[a]=[]),r[a][o]||(r[a][o]={}),r[a][o].x=(1-e)*r[a-1][o].x+e*r[a-1][o+1].x,r[a][o].y=(1-e)*r[a-1][o].y+e*r[a-1][o+1].y;if(null!=s)for(o=0;n>=o;o++)s[o]=r[o][0];if(null!=i)for(o=0;n>=o;o++)i[o]=r[n-o][o];return r[n][0]},h={},d=function(t){var n=h[t];if(!n){n=[];var e=function(){return function(n){return Math.pow(n,t)}},s=function(){return function(n){return Math.pow(1-n,t)}},i=function(t){return function(n){return t}},r=function(){return function(t){return t}},o=function(){return function(t){return 1-t}},a=function(t){return function(n){for(var e=1,s=0;s<t.length;s++)e*=t[s](n);return e}};n.push(new e);for(var l=1;t>l;l++){for(var u=[new i(t)],c=0;t-l>c;c++)u.push(new r);for(var c=0;l>c;c++)u.push(new o);n.push(new a(u))}n.push(new s),h[t]=n}return n},p=function(t,n){for(var e=d(t.length-1),s=0,i=0,r=0;r<t.length;r++)s+=t[r].x*e[r](n),i+=t[r].y*e[r](n);return{x:s,y:i}},m=function(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))},f=function(t){return t[0].x==t[1].x&&t[0].y==t[1].y},g=function(t,n,e){if(f(t))return{point:t[0],location:n};for(var s=p(t,n),i=0,r=n,o=e>0?1:-1,a=null;i<Math.abs(e);)r+=.005*o,a=p(t,r),i+=m(a,s),s=a;return{point:a,location:r}},b=function(t){if(f(t))return 0;for(var n=p(t,0),e=0,s=0,i=1,r=null;1>s;)s+=.005*i,r=p(t,s),e+=m(r,n),n=r;return e},v=function(t,n,e){return g(t,n,e).point},y=function(t,n,e){return g(t,n,e).location},P=function(t,n){var e=p(t,n),s=p(t.slice(0,t.length-1),n),i=s.y-e.y,r=s.x-e.x;return 0==i?1/0:Math.atan(i/r)},x=function(t,n,e){var s=g(t,n,e);return s.location>1&&(s.location=1),s.location<0&&(s.location=0),P(t,s.location)},C=function(t,n,e,s){s=null==s?0:s;var i=g(t,n,s),r=P(t,i.location),o=Math.atan(-1/r),a=e/2*Math.sin(o),l=e/2*Math.cos(o);return[{x:i.point.x+l,y:i.point.y+a},{x:i.point.x-l,y:i.point.y-a}]};window.jsBezier={distanceFromCurve:s,gradientAtPoint:P,gradientAtPointAlongCurveFrom:x,nearestPointOnCurve:i,pointOnCurve:p,pointAlongCurveFrom:v,perpendicularToCurveAt:C,locationAlongCurveFrom:y,getLength:b}}(),function(){var t=function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=function(t){return"[object Number]"===Object.prototype.toString.call(t)},e=function(t){return"string"==typeof t},s=function(t){return"boolean"==typeof t},i=function(t){return null==t},r=function(t){return null==t?!1:"[object Object]"===Object.prototype.toString.call(t)},o=function(t){return"[object Date]"===Object.prototype.toString.call(t)},a=function(t){return"[object Function]"===Object.prototype.toString.call(t)},l=function(t){for(var n in t)if(t.hasOwnProperty(n))return!1;return!0},u=function(n,e,s){return n=t(n)?n:[n.x,n.y],e=t(e)?e:[e.x,e.y],s(n,e)};jsPlumbUtil={isArray:t,isString:e,isBoolean:s,isNull:i,isObject:r,isDate:o,isFunction:a,isEmpty:l,isNumber:n,clone:function(n){if(e(n))return""+n;if(s(n))return!!n;if(o(n))return new Date(n.getTime());if(a(n))return n;if(t(n)){for(var i=[],l=0;l<n.length;l++)i.push(this.clone(n[l]));return i}if(r(n)){var u={};for(var c in n)u[c]=this.clone(n[c]);return u}return n},merge:function(n,i){var o=this.clone(n);for(var a in i)if(null==o[a]||e(i[a])||s(i[a]))o[a]=i[a];else if(t(i[a])){var l=[];t(o[a])&&l.push.apply(l,o[a]),l.push.apply(l,i[a]),o[a]=l}else if(r(i[a])){r(o[a])||(o[a]={});for(var u in i[a])o[a][u]=i[a][u]}return o},copyValues:function(t,n,e){for(var s=0;s<t.length;s++)e[t[s]]=n[t[s]]},functionChain:function(t,n,e){for(var s=0;s<e.length;s++){var i=e[s][0][e[s][1]].apply(e[s][0],e[s][2]);if(i===n)return i}return t},populate:function(n,s){var i=function(t){var n=t.match(/(\${.*?})/g);if(null!=n)for(var e=0;e<n.length;e++){var i=s[n[e].substring(2,n[e].length-1)];null!=i&&(t=t.replace(n[e],i))}return t},o=function(n){if(null!=n){if(e(n))return i(n);if(t(n)){for(var s=[],a=0;a<n.length;a++)s.push(o(n[a]));return s}if(r(n)){var l={};for(var u in n)l[u]=o(n[u]);return l}return n}};return o(n)},convertStyle:function(t,n){if("transparent"===t)return t;var e=t,s=function(t){return 1==t.length?"0"+t:t},i=function(t){return s(Number(t).toString(16))},r=/(rgb[a]?\()(.*)(\))/;if(t.match(r)){var o=t.match(r)[2].split(",");e="#"+i(o[0])+i(o[1])+i(o[2]),n||4!=o.length||(e+=i(o[3]))}return e},gradient:function(t,n){return u(t,n,function(t,n){return n[0]==t[0]?n[1]>t[1]?1/0:-(1/0):n[1]==t[1]?n[0]>t[0]?0:-0:(n[1]-t[1])/(n[0]-t[0])})},normal:function(t,n){return-1/this.gradient(t,n)},lineLength:function(t,n){return u(t,n,function(t,n){return Math.sqrt(Math.pow(n[1]-t[1],2)+Math.pow(n[0]-t[0],2))})},segment:function(t,n){return u(t,n,function(t,n){return n[0]>t[0]?n[1]>t[1]?2:1:n[0]==t[0]?n[1]>t[1]?2:1:n[1]>t[1]?3:4})},theta:function(t,n){return u(t,n,function(t,n){var e=jsPlumbUtil.gradient(t,n),s=Math.atan(e),i=jsPlumbUtil.segment(t,n);return(4==i||3==i)&&(s+=Math.PI),0>s&&(s+=2*Math.PI),s})},intersects:function(t,n){var e=t.x,s=t.x+t.w,i=t.y,r=t.y+t.h,o=n.x,a=n.x+n.w,l=n.y,u=n.y+n.h;return o>=e&&s>=o&&l>=i&&r>=l||a>=e&&s>=a&&l>=i&&r>=l||o>=e&&s>=o&&u>=i&&r>=u||a>=e&&s>=o&&u>=i&&r>=u||e>=o&&a>=e&&i>=l&&u>=i||s>=o&&a>=s&&i>=l&&u>=i||e>=o&&a>=e&&r>=l&&u>=r||s>=o&&a>=e&&r>=l&&u>=r},segmentMultipliers:[null,[1,-1],[1,1],[-1,1],[-1,-1]],inverseSegmentMultipliers:[null,[-1,-1],[-1,1],[1,1],[1,-1]],pointOnLine:function(t,n,e){var s=jsPlumbUtil.gradient(t,n),i=jsPlumbUtil.segment(t,n),r=e>0?jsPlumbUtil.segmentMultipliers[i]:jsPlumbUtil.inverseSegmentMultipliers[i],o=Math.atan(s),a=Math.abs(e*Math.sin(o))*r[1],l=Math.abs(e*Math.cos(o))*r[0];return{x:t.x+l,y:t.y+a}},perpendicularLineTo:function(t,n,e){var s=jsPlumbUtil.gradient(t,n),i=Math.atan(-1/s),r=e/2*Math.sin(i),o=e/2*Math.cos(i);return[{x:n.x+o,y:n.y+r},{x:n.x-o,y:n.y-r}]},findWithFunction:function(t,n){if(t)for(var e=0;e<t.length;e++)if(n(t[e]))return e;return-1},clampToGrid:function(t,n,e,s,i){var r=function(t,n){var e=t%n,s=Math.floor(t/n),i=e>=n/2?1:0;return(s+i)*n};return[s||null==e?t:r(t,e[0]),i||null==e?n:r(n,e[1])]},indexOf:function(t,n){return jsPlumbUtil.findWithFunction(t,function(t){return t==n})},removeWithFunction:function(t,n){var e=jsPlumbUtil.findWithFunction(t,n);return e>-1&&t.splice(e,1),-1!=e},remove:function(t,n){var e=jsPlumbUtil.indexOf(t,n);return e>-1&&t.splice(e,1),-1!=e},addWithFunction:function(t,n,e){-1==jsPlumbUtil.findWithFunction(t,e)&&t.push(n)},addToList:function(t,n,e,s){var i=t[n];return null==i&&(i=[],t[n]=i),i[s?"unshift":"push"](e),i},extend:function(n,e,s,i){s=s||{},i=i||{},e=t(e)?e:[e];for(var r=0;r<e.length;r++)for(var o in e[r].prototype)e[r].prototype.hasOwnProperty(o)&&(n.prototype[o]=e[r].prototype[o]);var a=function(t){return function(){for(var n=0;n<e.length;n++)e[n].prototype[t]&&e[n].prototype[t].apply(this,arguments);return s[t].apply(this,arguments)}};for(var l in s)n.prototype[l]=a(l);return n},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=16*Math.random()|0,e="x"==t?n:3&n|8;return e.toString(16)})},logEnabled:!0,log:function(){if(jsPlumbUtil.logEnabled&&"undefined"!=typeof console)try{var t=arguments[arguments.length-1];console.log(t)}catch(n){}},group:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.group(t)},groupEnd:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.groupEnd(t)},time:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.time(t)},timeEnd:function(t){jsPlumbUtil.logEnabled&&"undefined"!=typeof console&&console.timeEnd(t)},removeElement:function(t){null!=t&&null!=t.parentNode&&t.parentNode.removeChild(t)},removeElements:function(t){for(var n=0;n<t.length;n++)jsPlumbUtil.removeElement(t[n])},sizeElement:function(t,n,e,s,i){t&&(t.style.height=i+"px",t.height=i,t.style.width=s+"px",t.width=s,t.style.left=n+"px",t.style.top=e+"px")},wrap:function(t,n,e){return t=t||function(){},n=n||function(){},function(){var s=null;try{s=n.apply(this,arguments)}catch(i){jsPlumbUtil.log("jsPlumb function failed : "+i)}if(null==e||s!==e)try{s=t.apply(this,arguments)}catch(i){jsPlumbUtil.log("wrapped function failed : "+i)}return s}}},jsPlumbUtil.EventGenerator=function(){var t={},n=!1,e=["ready"];this.bind=function(n,e,s){return jsPlumbUtil.addToList(t,n,e,!0),this},this.fire=function(s,i,r){if(!n&&t[s]){var o=t[s].length,a=0,l=!1,u=null;if(!this.shouldFireEvent||this.shouldFireEvent(s,i,r))for(;!l&&o>a&&u!==!1;){if(-1!=jsPlumbUtil.findWithFunction(e,function(t){return t===s}))t[s][a](i,r);else try{u=t[s][a](i,r)}catch(c){jsPlumbUtil.log("jsPlumb: fire failed for event "+s+" : "+c)}a++,(null==t||null==t[s])&&(l=!0)}}return this},this.unbind=function(n){return n?delete t[n]:t={},this},this.getListener=function(n){return t[n]},this.setSuspendEvents=function(t){n=t},this.isSuspendEvents=function(){return n},this.cleanupListeners=function(){for(var n in t)t[n].splice(0),delete t[n]}},jsPlumbUtil.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}},Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var n=Array.prototype.slice.call(arguments,1),e=this,s=function(){},i=function(){return e.apply(this instanceof s&&t?this:t,n.concat(Array.prototype.slice.call(arguments)))};return s.prototype=this.prototype,i.prototype=new s,i})}(),function(){var t=!!document.createElement("canvas").getContext,n=!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),e=function(){if(void 0===e.vml){var t=document.body.appendChild(document.createElement("div"));t.innerHTML='<v:shape id="vml_flag1" adj="1" />';var n=t.firstChild;null!=n&&null!=n.style?(n.style.behavior="url(#default#VML)",e.vml=n?"object"==typeof n.adj:!0):e.vml=!1,t.parentNode.removeChild(t)}return e.vml},s=function(t){var n={},e=[],s={},i={},r={};this.register=function(o){var a=jsPlumb.CurrentLibrary,l=a.getElementObject(o),u=t.getId(o),c=a.getOffset(l);n[u]||(n[u]=o,e.push(o),s[u]={});var h=function(n,e){if(n)for(var o=0;o<n.childNodes.length;o++)if(3!=n.childNodes[o].nodeType&&8!=n.childNodes[o].nodeType){var l=a.getElementObject(n.childNodes[o]),d=t.getId(n.childNodes[o],null,!0);if(d&&i[d]&&i[d]>0){var p=a.getOffset(l);s[u][d]={id:d,offset:{left:p.left-c.left,top:p.top-c.top}},r[d]=u}h(n.childNodes[o])}};h(o)},this.updateOffsets=function(n){var e=jsPlumb.CurrentLibrary,i=e.getElementObject(n),o=e.getDOMElement(i),a=t.getId(o),l=s[a],u=e.getOffset(i);if(l)for(var c in l){var h=e.getElementObject(c),d=e.getOffset(h);s[a][c]={id:c,offset:{left:d.left-u.left,top:d.top-u.top}},r[c]=a}},this.endpointAdded=function(e){var o=jsPlumb.CurrentLibrary,a=document.body,l=t.getId(e),u=o.getElementObject(e),c=jsPlumb.CurrentLibrary.getOffset(u),h=e.parentNode;for(i[l]=i[l]?i[l]+1:1;null!=h&&h!=a;){var d=t.getId(h,null,!0);if(d&&n[d]){var p=o.getElementObject(h),m=o.getOffset(p);null==s[d][l]&&(s[d][l]={id:l,offset:{left:c.left-m.left,top:c.top-m.top}},r[l]=d);break}h=h.parentNode}},this.endpointDeleted=function(t){if(i[t.elementId]&&(i[t.elementId]--,i[t.elementId]<=0))for(var n in s)s[n]&&(delete s[n][t.elementId],delete r[t.elementId])},this.changeId=function(t,n){s[n]=s[t],s[t]={},r[n]=r[t],r[t]=null},this.getElementsForDraggable=function(t){return s[t]},this.elementRemoved=function(t){var n=r[t];n&&(delete s[n][t],delete r[t])},this.reset=function(){n={},e=[],s={},i={}}};window.console||(window.console={time:function(){},timeEnd:function(){},group:function(){},groupEnd:function(){},log:function(){}}),window.jsPlumbAdapter={headless:!1,getAttribute:function(t,n){return t.getAttribute(n)},setAttribute:function(t,n,e){t.setAttribute(n,e)},appendToRoot:function(t){document.body.appendChild(t)},getRenderModes:function(){return["canvas","svg","vml"]},isRenderModeAvailable:function(s){return{canvas:t,svg:n,vml:e()}[s]},getDragManager:function(t){return new s(t)},setRenderMode:function(t){var n;if(t){t=t.toLowerCase();var e=this.isRenderModeAvailable("canvas"),s=this.isRenderModeAvailable("svg"),i=this.isRenderModeAvailable("vml");"svg"===t?s?n="svg":e?n="canvas":i&&(n="vml"):"canvas"===t&&e?n="canvas":i&&(n="vml")}return n}}}(),function(){var t=jsPlumbUtil,n=function(t,n){E.CurrentLibrary.addClass(s(t),n)},e=function(t,n){E.CurrentLibrary.removeClass(s(t),n)},s=function(t){return E.CurrentLibrary.getElementObject(t)},i=function(t){return E.CurrentLibrary.getDOMElement(t)},r=function(t,n){var e=E.CurrentLibrary.getOffset(s(t));if(null!=n){var i=n.getZoom();return{left:e.left/i,top:e.top/i}}return e},o=function(t){return E.CurrentLibrary.getSize(s(t))},a=function(){return""+(new Date).getTime()},l=function(t){if(t._jsPlumb.paintStyle&&t._jsPlumb.hoverPaintStyle){var n={};E.extend(n,t._jsPlumb.paintStyle),E.extend(n,t._jsPlumb.hoverPaintStyle),delete t._jsPlumb.hoverPaintStyle,n.gradient&&t._jsPlumb.paintStyle.fillStyle&&delete n.gradient,t._jsPlumb.hoverPaintStyle=n}},u=["click","dblclick","mouseenter","mouseout","mousemove","mousedown","mouseup","contextmenu"],c={mouseout:"mouseexit"},h=function(t,n,e,s){var i=t.getAttachedElements();if(i)for(var r=0,o=i.length;o>r;r++)s&&s==i[r]||i[r].setHover(n,!0,e)},d=function(t){return null==t?null:t.split(" ")},p=function(n,e,s){if(n.getDefaultType){for(var i=n.getTypeDescriptor(),r=t.merge({},n.getDefaultType()),o=0,a=n._jsPlumb.types.length;a>o;o++)r=t.merge(r,n._jsPlumb.instance.getType(n._jsPlumb.types[o],i));e&&(r=t.populate(r,e)),n.applyType(r,s),s||n.repaint()}},m=window.jsPlumbUIComponent=function(n){jsPlumbUtil.EventGenerator.apply(this,arguments);var e=this,s=arguments,i=e.idPrefix,r=i+(new Date).getTime(),o=E.CurrentLibrary;if(this._jsPlumb={instance:n._jsPlumb,parameters:n.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:n.beforeDetach,beforeDrop:n.beforeDrop,overlayPlacements:[],hoverClass:n.hoverClass||n._jsPlumb.Defaults.HoverClass||E.Defaults.HoverClass,types:[]},this.getId=function(){return r},n.events)for(var a in n.events)e.bind(a,n.events[a]);this.clone=function(){var t={};return this.constructor.apply(t,s),t}.bind(this),this.isDetachAllowed=function(n){var e=!0;if(this._jsPlumb.beforeDetach)try{e=this._jsPlumb.beforeDetach(n)}catch(s){t.log("jsPlumb: beforeDetach callback failed",s)}return e},this.isDropAllowed=function(n,e,s,i,r){var o=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:n,targetId:e,scope:s,connection:i,dropEndpoint:r});if(this._jsPlumb.beforeDrop)try{o=this._jsPlumb.beforeDrop({sourceId:n,targetId:e,scope:s,connection:i,dropEndpoint:r})}catch(a){t.log("jsPlumb: beforeDrop callback failed",a)}return o};var l=[],h=function(t,n,e){l.push([t,n,e]),t.bind(n,e)},d=[],p=function(t,n,e){var s=c[e]||e,i=function(t){n.fire(s,n,t)};d.push([t,e,i]),o.bind(t,e,i)},m=function(t,n,e){c[n]||n;o.unbind(t,n,e)};this.bindListeners=function(t,n,e){h(t,"click",function(t,e){n.fire("click",n,e)}),h(t,"dblclick",function(t,e){n.fire("dblclick",n,e)}),h(t,"contextmenu",function(t,e){n.fire("contextmenu",n,e)}),h(t,"mouseenter",function(t,s){n.isHover()||(e(!0),n.fire("mouseenter",n,s))}),h(t,"mouseexit",function(t,s){n.isHover()&&(e(!1),n.fire("mouseexit",n,s))}),h(t,"mousedown",function(t,e){n.fire("mousedown",n,e)}),h(t,"mouseup",function(t,e){n.fire("mouseup",n,e)})},this.unbindListeners=function(){for(var t=0;t<l.length;t++){var n=l[t];n[0].unbind(n[1],n[2])}l=null},this.attachListeners=function(t,n){for(var e=0,s=u.length;s>e;e++)p(t,n,u[e])},this.detachListeners=function(){for(var t=0;t<d.length;t++)m(d[t][0],d[t][1],d[t][2]);d=null},this.reattachListenersForElement=function(t){if(arguments.length>1){for(var n=0,e=u.length;e>n;n++)m(t,u[n]);for(n=1,e=arguments.length;e>n;n++)this.attachListeners(t,arguments[n])}}};jsPlumbUtil.extend(m,jsPlumbUtil.EventGenerator,{getParameter:function(t){return this._jsPlumb.parameters[t]},setParameter:function(t,n){this._jsPlumb.parameters[t]=n},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(t){this._jsPlumb.parameters=t},addClass:function(t){null!=this.canvas&&n(this.canvas,t)},removeClass:function(t){null!=this.canvas&&e(this.canvas,t)},setType:function(t,n,e){this._jsPlumb.types=d(t)||[],p(this,n,e)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(t,n){p(this,t,n)},hasType:function(t){return-1!=jsPlumbUtil.indexOf(this._jsPlumb.types,t)},addType:function(t,n,e){var s=d(t),i=!1;if(null!=s){for(var r=0,o=s.length;o>r;r++)this.hasType(s[r])||(this._jsPlumb.types.push(s[r]),i=!0);i&&p(this,n,e)}},removeType:function(n,e){var s=d(n),i=!1,r=function(n){var e=t.indexOf(this._jsPlumb.types,n);return-1!=e?(this._jsPlumb.types.splice(e,1),!0):!1}.bind(this);if(null!=s){for(var o=0,a=s.length;a>o;o++)i=r(s[o])||i;i&&p(this,null,e)}},toggleType:function(t,n,e){var s=d(t);if(null!=s){for(var i=0,r=s.length;r>i;i++){var o=jsPlumbUtil.indexOf(this._jsPlumb.types,s[i]);-1!=o?this._jsPlumb.types.splice(o,1):this._jsPlumb.types.push(s[i])}p(this,n,e)}},applyType:function(t,n){if(this.setPaintStyle(t.paintStyle,n),this.setHoverPaintStyle(t.hoverPaintStyle,n),t.parameters)for(var e in t.parameters)this.setParameter(e,t.parameters[e])},setPaintStyle:function(t,n){this._jsPlumb.paintStyle=t,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,l(this),n||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(t,n){this._jsPlumb.hoverPaintStyle=t,l(this),n||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},cleanup:function(){this.unbindListeners(),this.detachListeners()},destroy:function(){this.cleanupListeners(),this.clone=null,this._jsPlumb=null},isHover:function(){return this._jsPlumb.hover},setHover:function(t,n,e){var s=E.CurrentLibrary;!this._jsPlumb||this._jsPlumb.instance.currentlyDragging||this._jsPlumb.instance.isHoverSuspended()||(this._jsPlumb.hover=t,null!=this.canvas&&null!=this._jsPlumb.instance.hoverClass&&s[t?"addClass":"removeClass"](this.canvas,this._jsPlumb.instance.hoverClass),null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=t?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(e=e||a(),this.repaint({timestamp:e,recalc:!1}))),this.getAttachedElements&&!n&&h(this,t,a(),this))}});var f="__label",g=function(t,n){for(var e=-1,s=0,i=t._jsPlumb.overlays.length;i>s;s++)if(n===t._jsPlumb.overlays[s].id){e=s;break}return e},b=function(t,n){var e={cssClass:n.cssClass,labelStyle:t.labelStyle,id:f,component:t,_jsPlumb:t._jsPlumb.instance},s=E.extend(e,n);return new(E.Overlays[t._jsPlumb.instance.getRenderMode()].Label)(s)},v=function(n,e){var s=null;if(t.isArray(e)){var i=e[0],r=E.extend({component:n,_jsPlumb:n._jsPlumb.instance},e[1]);3==e.length&&E.extend(r,e[2]),s=new(E.Overlays[n._jsPlumb.instance.getRenderMode()][i])(r)}else s=e.constructor==String?new(E.Overlays[n._jsPlumb.instance.getRenderMode()][e])({component:n,_jsPlumb:n._jsPlumb.instance}):e;n._jsPlumb.overlays.push(s)},y=function(t,n){var e=t.defaultOverlayKeys||[],s=n.overlays,i=function(n){return t._jsPlumb.instance.Defaults[n]||E.Defaults[n]||[]};s||(s=[]);for(var r=0,o=e.length;o>r;r++)s.unshift.apply(s,i(e[r]));return s},P=window.OverlayCapableJsPlumbUIComponent=function(t){m.apply(this,arguments),this._jsPlumb.overlays=[];var n=y(this,t);if(n)for(var e=0,s=n.length;s>e;e++)v(this,n[e]);if(t.label){var i=t.labelLocation||this.defaultLabelLocation||.5,r=t.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle||E.Defaults.LabelStyle;this._jsPlumb.overlays.push(b(this,{label:t.label,location:i,labelStyle:r}))}};jsPlumbUtil.extend(P,m,{applyType:function(t,n){if(this.removeAllOverlays(n),t.overlays)for(var e=0,s=t.overlays.length;s>e;e++)this.addOverlay(t.overlays[e],!0)},setHover:function(t,n,e){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var s=0,i=this._jsPlumb.overlays.length;i>s;s++)this._jsPlumb.overlays[s][t?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(t,n){v(this,t),n||this.repaint()},getOverlay:function(t){var n=g(this,t);return n>=0?this._jsPlumb.overlays[n]:null},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(t){var n=this.getOverlay(t);n&&n.hide()},hideOverlays:function(){for(var t=0,n=this._jsPlumb.overlays.length;n>t;t++)this._jsPlumb.overlays[t].hide()},showOverlay:function(t){var n=this.getOverlay(t);n&&n.show()},showOverlays:function(){for(var t=0,n=this._jsPlumb.overlays.length;n>t;t++)this._jsPlumb.overlays[t].show()},removeAllOverlays:function(t){for(var n=0,e=this._jsPlumb.overlays.length;e>n;n++)this._jsPlumb.overlays[n].cleanup&&this._jsPlumb.overlays[n].cleanup();this._jsPlumb.overlays.splice(0,this._jsPlumb.overlays.length),t||this.repaint()},removeOverlay:function(t){var n=g(this,t);if(-1!=n){var e=this._jsPlumb.overlays[n];e.cleanup&&e.cleanup(),this._jsPlumb.overlays.splice(n,1)}},removeOverlays:function(){for(var t=0,n=arguments.length;n>t;t++)this.removeOverlay(arguments[t])},getLabel:function(){var t=this.getOverlay(f);return null!=t?t.getLabel():null},getLabelOverlay:function(){return this.getOverlay(f)},setLabel:function(t){var n=this.getOverlay(f);if(n)t.constructor==String||t.constructor==Function?n.setLabel(t):(t.label&&n.setLabel(t.label),t.location&&n.setLocation(t.location));else{var e=t.constructor==String||t.constructor==Function?{label:t}:t;n=b(this,e),this._jsPlumb.overlays.push(n)}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(){for(var t=0;t<this._jsPlumb.overlays.length;t++)this._jsPlumb.overlays[t].cleanup(),this._jsPlumb.overlays[t].destroy();this._jsPlumb.overlays.splice(0)}});var j=0,x=function(){var t=j+1;return j++,t},C=window.jsPlumbInstance=function(l){this.Defaults={Anchor:"BottomCenter",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:8,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},l&&E.extend(this.Defaults,l),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},jsPlumbUtil.EventGenerator.apply(this);var u=this,c=x(),h=u.bind,d={},p=1,f=function(t){var n=i(t);return{el:n,id:jsPlumbUtil.isString(t)&&null==n?t:nt(n)}};this.getInstanceIndex=function(){return c},this.setZoom=function(t,n){p=t,n&&u.repaintEverything()},this.getZoom=function(){return p};for(var g in this.Defaults)d[g]=this.Defaults[g];this.bind=function(t,n){"ready"===t&&v?n():h.apply(u,[t,n])},u.importDefaults=function(t){for(var n in t)u.Defaults[n]=t[n];return u},u.restoreDefaults=function(){return u.Defaults=E.extend({},d),u};var b=null,v=!1,y=[],P={},j={},C={},S={},_={},D={},A=!1,w=[],I=!1,O=null,L=this.Defaults.Scope,M=null,U=1,T=function(){return""+U++},k=function(t,n){u.Defaults.Container?E.CurrentLibrary.appendElement(t,u.Defaults.Container):n?E.CurrentLibrary.appendElement(t,n):jsPlumbAdapter.appendToRoot(t)},F=function(t){return t._nodes?t._nodes:t},W=function(t,n,e,s){if(!jsPlumbAdapter.headless&&!I){var i=nt(t),r=u.dragManager.getElementsForDraggable(i);null==e&&(e=a());var o=$({elId:i,offset:n,recalc:!1,timestamp:e});if(r)for(var l in r)$({elId:r[l].id,offset:{left:o.o.left+r[l].offset.left,top:o.o.top+r[l].offset.top},recalc:!1,timestamp:e});if(u.anchorManager.redraw(i,n,e,null,s),r)for(var c in r)u.anchorManager.redraw(r[c].id,n,e,r[c].offset,s,!0)}},R=function(n,e){var i,r,o=null;if(t.isArray(n)){o=[];for(var a=0,l=n.length;l>a;a++)i=s(n[a]),r=u.getAttribute(i,"id"),o.push(e(i,r))}else i=s(n),r=u.getAttribute(i,"id"),o=e(i,r);return o},Y=function(t){return j[t]},X=function(s,i,r){if(!jsPlumbAdapter.headless){var o=null==i?!1:i,a=E.CurrentLibrary;if(o&&a.isDragSupported(s)&&!a.isAlreadyDraggable(s)){var l=r||u.Defaults.DragOptions||E.Defaults.DragOptions;l=E.extend({},l);var c=a.dragEvents.drag,h=a.dragEvents.stop,d=a.dragEvents.start;l[d]=t.wrap(l[d],function(){u.setHoverSuspended(!0),u.select({source:s}).addClass(u.elementDraggingClass+" "+u.sourceElementDraggingClass,!0),u.select({target:s}).addClass(u.elementDraggingClass+" "+u.targetElementDraggingClass,!0),u.setConnectionBeingDragged(!0)}),l[c]=t.wrap(l[c],function(){var t=a.getUIPosition(arguments,u.getZoom());W(s,t,null,!0),n(s,"jsPlumb_dragged")}),l[h]=t.wrap(l[h],function(){var t=a.getUIPosition(arguments,u.getZoom());W(s,t),e(s,"jsPlumb_dragged"),u.setHoverSuspended(!1),u.select({source:s}).removeClass(u.elementDraggingClass+" "+u.sourceElementDraggingClass,!0),u.select({target:s}).removeClass(u.elementDraggingClass+" "+u.targetElementDraggingClass,!0),u.setConnectionBeingDragged(!1)});var p=nt(s);D[p]=!0;var m=D[p];l.disabled=null==m?!1:!m,a.initDraggable(s,l,!1,u),u.dragManager.register(s)}}},N=function(n,e){var s=E.extend({},n);if(e&&E.extend(s,e),s.source&&(s.source.endpoint?s.sourceEndpoint=s.source:s.source=i(s.source)),s.target&&(s.target.endpoint?s.targetEndpoint=s.target:s.target=i(s.target)),n.uuids&&(s.sourceEndpoint=Y(n.uuids[0]),s.targetEndpoint=Y(n.uuids[1])),s.sourceEndpoint&&s.sourceEndpoint.isFull())return void t.log(u,"could not add connection; source endpoint is full");if(s.targetEndpoint&&s.targetEndpoint.isFull())return void t.log(u,"could not add connection; target endpoint is full");if(!s.type&&s.sourceEndpoint&&(s.type=s.sourceEndpoint.connectionType),s.sourceEndpoint&&s.sourceEndpoint.connectorOverlays){s.overlays=s.overlays||[];for(var r=0,o=s.sourceEndpoint.connectorOverlays.length;o>r;r++)s.overlays.push(s.sourceEndpoint.connectorOverlays[r])}!s["pointer-events"]&&s.sourceEndpoint&&s.sourceEndpoint.connectorPointerEvents&&(s["pointer-events"]=s.sourceEndpoint.connectorPointerEvents);var a,l,c,h;if(s.target&&!s.target.endpoint&&!s.targetEndpoint&&!s.newConnection&&(a=nt(s.target),l=vt[a],c=yt[a],l)){if(!wt[a])return;l.isTarget=!0,h=null!=c?c:u.addEndpoint(s.target,l),Pt[a]&&(yt[a]=h),s.targetEndpoint=h,h._doNotDeleteOnDetach=!1,h._deleteOnDetach=!0}if(s.source&&!s.source.endpoint&&!s.sourceEndpoint&&!s.newConnection&&(a=nt(s.source),l=Ct[a],c=Et[a],l)){if(!_t[a])return;h=null!=c?c:u.addEndpoint(s.source,l),St[a]&&(Et[a]=h),s.sourceEndpoint=h,h._doNotDeleteOnDetach=!1,h._deleteOnDetach=!0}return s},H=function(t){var n=u.Defaults.ConnectionType||u.getDefaultConnectionType(),e=u.Defaults.EndpointType||E.Endpoint,s=E.CurrentLibrary.getParent;t.container?t.parent=t.container:t.sourceEndpoint?t.parent=t.sourceEndpoint.parent:t.source.constructor==e?t.parent=t.source.parent:t.parent=s(t.source),t._jsPlumb=u,t.newConnection=H,t.newEndpoint=G,t.endpointsByUUID=j,t.endpointsByElement=P,t.finaliseConnection=B;var i=new n(t);return i.id="con_"+T(),V("click","click",i),V("dblclick","dblclick",i),V("contextmenu","contextmenu",i),i},B=function(t,n,e,s){if(n=n||{},t.suspendedEndpoint||y.push(t),(null==t.suspendedEndpoint||s)&&u.anchorManager.newConnection(t),W(t.source),!n.doNotFireConnectionEvent&&n.fireEvent!==!1){var i={connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]};u.fire("connection",i,e)}},V=function(t,n,e){e.bind(t,function(t,s){u.fire(n,e,s)})},z=function(t){if(t.container)return t.container;var n=E.CurrentLibrary.getTagName(t.source),e=E.CurrentLibrary.getParent(t.source);return n&&"td"===n.toLowerCase()?E.CurrentLibrary.getParent(e):e},G=function(t){var n=u.Defaults.EndpointType||E.Endpoint,e=E.extend({},t);e.parent=z(e),e._jsPlumb=u,e.newConnection=H,e.newEndpoint=G,e.endpointsByUUID=j,e.endpointsByElement=P,e.finaliseConnection=B,e.fireDetachEvent=et,e.floatingConnections=_,e.getParentFromParams=z,e.elementId=nt(e.source);var s=new n(e);return s.id="ep_"+T(),V("click","endpointClick",s),V("dblclick","endpointDblClick",s),V("contextmenu","contextmenu",s),jsPlumbAdapter.headless||u.dragManager.endpointAdded(e.source),s},q=function(t,n,e){var s=P[t];if(s&&s.length)for(var i=0,r=s.length;r>i;i++){for(var o=0,a=s[i].connections.length;a>o;o++){var l=n(s[i].connections[o]);if(l)return}e&&e(s[i])}},Z=function(t,n){return R(t,function(t,e){D[e]=n,E.CurrentLibrary.isDragSupported(t)&&E.CurrentLibrary.setDraggable(t,n)})},J=function(t,n,e){n="block"===n;var s=null;e&&(s=n?function(t){t.setVisible(!0,!0,!0)}:function(t){t.setVisible(!1,!0,!0)});var i=f(t);q(i.id,function(t){if(n&&e){var s=t.sourceId===i.id?1:0;t.endpoints[s].isVisible()&&t.setVisible(!0)}else t.setVisible(n)},s)},K=function(t){return R(t,function(t,n){var e=null==D[n]?!1:D[n];return e=!e,D[n]=e,E.CurrentLibrary.setDraggable(t,e),e})},Q=function(t,n){var e=null;n&&(e=function(t){var n=t.isVisible();t.setVisible(!n)}),q(t,function(t){var n=t.isVisible();t.setVisible(!n)},e)},$=function(t){var n,e=t.timestamp,i=t.recalc,a=t.offset,l=t.elId;return I&&!e&&(e=O),!i&&e&&e===S[l]?{o:t.offset||C[l],s:w[l]}:(i||!a?(n=s(l),null!=n&&(w[l]=o(n),C[l]=r(n,u),S[l]=e)):(C[l]=a,null==w[l]&&(n=s(l),null!=n&&(w[l]=o(n))),S[l]=e),C[l]&&!C[l].right&&(C[l].right=C[l].left+w[l][0],C[l].bottom=C[l].top+w[l][1],C[l].width=w[l][0],C[l].height=w[l][1],C[l].centerx=C[l].left+C[l].width/2,C[l].centery=C[l].top+C[l].height/2),{o:C[l],s:w[l]})},tt=function(t){var n=C[t];return n?{o:n,s:w[t]}:$({elId:t})},nt=function(t,n,e){if(jsPlumbUtil.isString(t))return t;if(null==t)return null;var s=jsPlumbAdapter.getAttribute(t,"id");return s&&"undefined"!==s||(2==arguments.length&&void 0!==arguments[1]?s=n:(1==arguments.length||3==arguments.length&&!arguments[2])&&(s="jsPlumb_"+c+"_"+T()),e||jsPlumbAdapter.setAttribute(t,"id",s)),s};this.setConnectionBeingDragged=function(t){
A=t},this.isConnectionBeingDragged=function(){return A},this.connectorClass="_jsPlumb_connector",this.hoverClass="_jsPlumb_hover",this.endpointClass="_jsPlumb_endpoint",this.endpointConnectedClass="_jsPlumb_endpoint_connected",this.endpointFullClass="_jsPlumb_endpoint_full",this.endpointDropAllowedClass="_jsPlumb_endpoint_drop_allowed",this.endpointDropForbiddenClass="_jsPlumb_endpoint_drop_forbidden",this.overlayClass="_jsPlumb_overlay",this.draggingClass="_jsPlumb_dragging",this.elementDraggingClass="_jsPlumb_element_dragging",this.sourceElementDraggingClass="_jsPlumb_source_element_dragging",this.targetElementDraggingClass="_jsPlumb_target_element_dragging",this.endpointAnchorClassPrefix="_jsPlumb_endpoint_anchor",this.hoverSourceClass="_jsPlumb_source_hover",this.hoverTargetClass="_jsPlumb_target_hover",this.dragSelectClass="_jsPlumb_drag_select",this.Anchors={},this.Connectors={canvas:{},svg:{},vml:{}},this.Endpoints={canvas:{},svg:{},vml:{}},this.Overlays={canvas:{},svg:{},vml:{}},this.ConnectorRenderers={},this.SVG="svg",this.CANVAS="canvas",this.VML="vml",this.addEndpoint=function(n,e,s){s=s||{};var r=E.extend({},s);E.extend(r,e),r.endpoint=r.endpoint||u.Defaults.Endpoint||E.Defaults.Endpoint,r.paintStyle=r.paintStyle||u.Defaults.EndpointStyle||E.Defaults.EndpointStyle,n=F(n);for(var o=[],a=t.isArray(n)||null!=n.length&&!t.isString(n)?n:[n],l=0,c=a.length;c>l;l++){var h=i(a[l]),d=nt(h);r.source=h,$({elId:d,timestamp:O});var p=G(r);r.parentAnchor&&(p.parentAnchor=r.parentAnchor),t.addToList(P,d,p);var m=C[d],f=w[d],g=p.anchor.compute({xy:[m.left,m.top],wh:f,element:p,timestamp:O}),b={anchorLoc:g,timestamp:O};I&&(b.recalc=!1),I||p.paint(b),o.push(p),p._doNotDeleteOnDetach=!0}return 1==o.length?o[0]:o},this.addEndpoints=function(n,e,s){for(var i=[],r=0,o=e.length;o>r;r++){var a=u.addEndpoint(n,e[r],s);t.isArray(a)?Array.prototype.push.apply(i,a):i.push(a)}return i},this.animate=function(n,e,i){i=i||{};var r=s(n),o=nt(n),a=E.CurrentLibrary.dragEvents.step,l=E.CurrentLibrary.dragEvents.complete;i[a]=t.wrap(i[a],function(){u.repaint(o)}),i[l]=t.wrap(i[l],function(){u.repaint(o)}),E.CurrentLibrary.animate(r,e,i)},this.checkCondition=function(n,e){var s=u.getListener(n),i=!0;if(s&&s.length>0)try{for(var r=0,o=s.length;o>r;r++)i=i&&s[r](e)}catch(a){t.log(u,"cannot check condition ["+n+"]"+a)}return i},this.checkASyncCondition=function(n,e,s,i){var r=u.getListener(n);if(r&&r.length>0)try{r[0](e,s,i)}catch(o){t.log(u,"cannot asynchronously check condition ["+n+"]"+o)}},this.connect=function(t,n){var e,s=N(t,n);return s&&(e=H(s),B(e,s)),e},this.deleteEndpoint=function(t,n){var e=u.setSuspendDrawing(!0),s="string"==typeof t?j[t]:t;return s&&u.deleteObject({endpoint:s}),e||u.setSuspendDrawing(!1,n),u},this.deleteEveryEndpoint=function(){var t=u.setSuspendDrawing(!0);for(var n in P){var e=P[n];if(e&&e.length)for(var s=0,i=e.length;i>s;s++)u.deleteEndpoint(e[s],!0)}return P={},j={},u.anchorManager.reset(),u.dragManager.reset(),t||u.setSuspendDrawing(!1),u};var et=function(t,n,e){var s=u.Defaults.ConnectionType||u.getDefaultConnectionType(),i=t.constructor==s,r=i?{connection:t,source:t.source,target:t.target,sourceId:t.sourceId,targetId:t.targetId,sourceEndpoint:t.endpoints[0],targetEndpoint:t.endpoints[1]}:t;n&&u.fire("connectionDetached",r,e),u.anchorManager.connectionDetached(r)};this.unregisterEndpoint=function(t){t._jsPlumb.uuid&&(j[t._jsPlumb.uuid]=null),u.anchorManager.deleteEndpoint(t);for(var n in P){var e=P[n];if(e){for(var s=[],i=0,r=e.length;r>i;i++)e[i]!=t&&s.push(e[i]);P[n]=s}P[n].length<1&&delete P[n]}},this.detach=function(){if(0!==arguments.length){var t=u.Defaults.ConnectionType||u.getDefaultConnectionType(),n=arguments[0].constructor==t,e=2==arguments.length&&n?arguments[1]||{}:arguments[0],s=e.fireEvent!==!1,r=e.forceDetach,o=n?arguments[0]:e.connection;if(o)(r||jsPlumbUtil.functionChain(!0,!1,[[o.endpoints[0],"isDetachAllowed",[o]],[o.endpoints[1],"isDetachAllowed",[o]],[o,"isDetachAllowed",[o]],[u,"checkCondition",["beforeDetach",o]]]))&&o.endpoints[0].detach(o,!1,!0,s);else{var a=E.extend({},e);if(a.uuids)Y(a.uuids[0]).detachFrom(Y(a.uuids[1]),s);else if(a.sourceEndpoint&&a.targetEndpoint)a.sourceEndpoint.detachFrom(a.targetEndpoint);else{var l=nt(i(a.source)),c=nt(i(a.target));q(l,function(t){(t.sourceId==l&&t.targetId==c||t.targetId==l&&t.sourceId==c)&&u.checkCondition("beforeDetach",t)&&t.endpoints[0].detach(t,!1,!0,s)})}}}},this.detachAllConnections=function(t,n){n=n||{},t=i(t);var e=nt(t),s=P[e];if(s&&s.length)for(var r=0,o=s.length;o>r;r++)s[r].detachAll(n.fireEvent!==!1);return u},this.detachEveryConnection=function(t){return t=t||{},u.doWhileSuspended(function(){for(var n in P){var e=P[n];if(e&&e.length)for(var s=0,i=e.length;i>s;s++)e[s].detachAll(t.fireEvent!==!1)}y.splice(0)}),u},this.deleteObject=function(t){var n={endpoints:{},connections:{},endpointCount:0,connectionCount:0},e=t.fireEvent!==!1,s=t.deleteAttachedObjects!==!1,i=function(t){if(null!=t&&null==n.connections[t.id]&&(t._jsPlumb&&t.setHover(!1),n.connections[t.id]=t,n.connectionCount++,s))for(var e=0;e<t.endpoints.length;e++)t.endpoints[e]._deleteOnDetach&&r(t.endpoints[e])},r=function(t){if(null!=t&&null==n.endpoints[t.id]&&(t._jsPlumb&&t.setHover(!1),n.endpoints[t.id]=t,n.endpointCount++,s))for(var e=0;e<t.connections.length;e++){var r=t.connections[e];i(r)}};t.connection?i(t.connection):r(t.endpoint);for(var o in n.connections){var a=n.connections[o];a.endpoints[0].detachFromConnection(a),a.endpoints[1].detachFromConnection(a),jsPlumbUtil.removeWithFunction(y,function(t){return a.id==t.id}),et(a,e,t.originalEvent),a.cleanup(),a.destroy()}for(var l in n.endpoints){var c=n.endpoints[l];u.unregisterEndpoint(c),c.cleanup(),c.destroy()}return n},this.draggable=function(t,n){var e,s,r;if("object"==typeof t&&t.length)for(e=0,s=t.length;s>e;e++)r=i(t[e]),r&&X(r,!0,n);else if(t._nodes)for(e=0,s=t._nodes.length;s>e;e++)r=i(t._nodes[e]),r&&X(r,!0,n);else r=i(t),r&&X(r,!0,n);return u},this.extend=function(t,n){return E.CurrentLibrary.extend(t,n)};var st=function(t,n,e,s){for(var i=0,r=t.length;r>i;i++)t[i][n].apply(t[i],e);return s(t)},it=function(t,n,e){for(var s=[],i=0,r=t.length;r>i;i++)s.push([t[i][n].apply(t[i],e),t[i]]);return s},rt=function(t,n,e){return function(){return st(t,n,arguments,e)}},ot=function(t,n){return function(){return it(t,n,arguments)}},at=function(t,n){var e=[];if(t)if("string"==typeof t){if("*"===t)return t;e.push(t)}else if(t=s(t),n)e=t;else for(var i=0,r=t.length;r>i;i++)e.push(f(t[i]).id);return e},lt=function(t,n,e){return"*"===t?!0:t.length>0?-1!=jsPlumbUtil.indexOf(t,n):!e};this.getConnections=function(t,n){t?t.constructor==String&&(t={scope:t}):t={};for(var e=t.scope||u.getDefaultScope(),s=at(e,!0),i=at(t.source),r=at(t.target),o=!n&&s.length>1?{}:[],a=function(t,e){if(!n&&s.length>1){var i=o[t];null==i&&(i=o[t]=[]),i.push(e)}else o.push(e)},l=0,c=y.length;c>l;l++){var h=y[l];lt(s,h.scope)&&lt(i,h.sourceId)&&lt(r,h.targetId)&&a(h.scope,h)}return o};var ut=function(t,n){return function(e){for(var s=0,i=t.length;i>s;s++)e(t[s]);return n(t)}},ct=function(t){return function(n){return t[n]}},ht=function(t,n){var e,s,i={length:t.length,each:ut(t,n),get:ct(t)},r=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],o=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"];for(e=0,s=r.length;s>e;e++)i[r[e]]=rt(t,r[e],n);for(e=0,s=o.length;s>e;e++)i[o[e]]=ot(t,o[e]);return i},dt=function(t){var n=ht(t,dt);return E.CurrentLibrary.extend(n,{setDetachable:rt(t,"setDetachable",dt),setReattach:rt(t,"setReattach",dt),setConnector:rt(t,"setConnector",dt),detach:function(){for(var n=0,e=t.length;e>n;n++)u.detach(t[n])},isDetachable:ot(t,"isDetachable"),isReattach:ot(t,"isReattach")})},pt=function(t){var n=ht(t,pt);return E.CurrentLibrary.extend(n,{setEnabled:rt(t,"setEnabled",pt),setAnchor:rt(t,"setAnchor",pt),isEnabled:ot(t,"isEnabled"),detachAll:function(){for(var n=0,e=t.length;e>n;n++)t[n].detachAll()},remove:function(){for(var n=0,e=t.length;e>n;n++)u.deleteObject({endpoint:t[n]})}})};this.select=function(t){return t=t||{},t.scope=t.scope||"*",dt(t.connections||u.getConnections(t,!0))},this.selectEndpoints=function(t){t=t||{},t.scope=t.scope||"*";var n=!t.element&&!t.source&&!t.target,e=n?"*":at(t.element),s=n?"*":at(t.source),i=n?"*":at(t.target),r=at(t.scope,!0),o=[];for(var a in P){var l=lt(e,a,!0),u=lt(s,a,!0),c="*"!=s,h=lt(i,a,!0),d="*"!=i;if(l||u||h)t:for(var p=0,m=P[a].length;m>p;p++){var f=P[a][p];if(lt(r,f.scope,!0)){var g=c&&s.length>0&&!f.isSource,b=d&&i.length>0&&!f.isTarget;if(g||b)continue t;o.push(f)}}}return pt(o)},this.getAllConnections=function(){return y},this.getDefaultScope=function(){return L},this.getEndpoint=Y,this.getEndpoints=function(t){return P[f(t).id]},this.getDefaultEndpointType=function(){return E.Endpoint},this.getDefaultConnectionType=function(){return E.Connection},this.getId=nt,this.getOffset=function(t){C[t];return $({elId:t})},this.getSelector=function(){return E.CurrentLibrary.getSelector.apply(null,arguments)},this.getSize=function(t){var n=w[t];return n||$({elId:t}),w[t]},this.appendElement=k;var mt=!1;this.isHoverSuspended=function(){return mt},this.setHoverSuspended=function(t){mt=t};var ft=function(t){return function(){return jsPlumbAdapter.isRenderModeAvailable(t)}};this.isCanvasAvailable=ft("canvas"),this.isSVGAvailable=ft("svg"),this.isVMLAvailable=ft("vml"),this.hide=function(t,n){return J(t,"none",n),u},this.idstamp=T,this.connectorsInitialized=!1;var gt=[],bt=["canvas","svg","vml"];this.registerConnectorType=function(t,n){gt.push([t,n])},this.init=function(){var t=function(t,n,e){E.Connectors[t][n]=function(){e.apply(this,arguments),E.ConnectorRenderers[t].apply(this,arguments)},jsPlumbUtil.extend(E.Connectors[t][n],[e,E.ConnectorRenderers[t]])};if(!E.connectorsInitialized){for(var n=0;n<gt.length;n++)for(var e=0;e<bt.length;e++)t(bt[e],gt[n][1],gt[n][0]);E.connectorsInitialized=!0}v||(u.anchorManager=new E.AnchorManager({jsPlumbInstance:u}),u.setRenderMode(u.Defaults.RenderMode),v=!0,u.fire("ready",u))}.bind(this),this.log=b,this.jsPlumbUIComponent=m,this.makeAnchor=function(){var n=function(t,n){if(E.Anchors[t])return new E.Anchors[t](n);if(!u.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+t+"'"}};if(0===arguments.length)return null;var e=arguments[0],s=arguments[1],i=arguments[2],r=null;if(e.compute&&e.getOrientation)return e;if("string"==typeof e)r=n(arguments[0],{elementId:s,jsPlumbInstance:u});else if(t.isArray(e))if(t.isArray(e[0])||t.isString(e[0]))if(2==e.length&&t.isString(e[0])&&t.isObject(e[1])){var o=E.extend({elementId:s,jsPlumbInstance:u},e[1]);r=n(e[0],o)}else r=new E.DynamicAnchor({anchors:e,selector:null,elementId:s,jsPlumbInstance:i});else{var a={x:e[0],y:e[1],orientation:e.length>=4?[e[2],e[3]]:[0,0],offsets:e.length>=6?[e[4],e[5]]:[0,0],elementId:s,jsPlumbInstance:i,cssClass:7==e.length?e[6]:null};r=new E.Anchor(a),r.clone=function(){return new E.Anchor(a)}}return r.id||(r.id="anchor_"+T()),r},this.makeAnchors=function(n,e,s){for(var i=[],r=0,o=n.length;o>r;r++)"string"==typeof n[r]?i.push(E.Anchors[n[r]]({elementId:e,jsPlumbInstance:s})):t.isArray(n[r])&&i.push(u.makeAnchor(n[r],e,s));return i},this.makeDynamicAnchor=function(t,n){return new E.DynamicAnchor({anchors:t,selector:n,elementId:null,jsPlumbInstance:u})};var vt={},yt={},Pt={},jt={},xt=function(t,n){t.paintStyle=t.paintStyle||u.Defaults.EndpointStyles[n]||u.Defaults.EndpointStyle||E.Defaults.EndpointStyles[n]||E.Defaults.EndpointStyle,t.hoverPaintStyle=t.hoverPaintStyle||u.Defaults.EndpointHoverStyles[n]||u.Defaults.EndpointHoverStyle||E.Defaults.EndpointHoverStyles[n]||E.Defaults.EndpointHoverStyle,t.anchor=t.anchor||u.Defaults.Anchors[n]||u.Defaults.Anchor||E.Defaults.Anchors[n]||E.Defaults.Anchor,t.endpoint=t.endpoint||u.Defaults.Endpoints[n]||u.Defaults.Endpoint||E.Defaults.Endpoints[n]||E.Defaults.Endpoint},Ct={},Et={},St={},_t={},Dt={},At={},wt={},It=function(t,n,e){for(var s=t.target||t.srcElement,i=!1,r=u.getSelector(n,e),o=0;o<r.length;o++)if(r[o]==s){i=!0;break}return i};this.makeTarget=function(n,e,i){var a=E.extend({_jsPlumb:u},i);E.extend(a,e),xt(a,1);var l=E.CurrentLibrary,c=a.scope||u.Defaults.Scope,h=!(a.deleteEndpointsOnDetach===!1),d=a.maxConnections||-1,p=a.onMaxConnections;_doOne=function(n){var e=f(n),i=e.id,g=new m(a),b=E.extend({},a.dropOptions||{});vt[i]=a,Pt[i]=a.uniqueEndpoint,jt[i]=d,wt[i]=!0;var v=function(){u.currentlyDragging=!1;var t=E.CurrentLibrary.getDropEvent(arguments),n=u.select({target:i}).length,c=s(l.getDragObject(arguments)),d=u.getAttribute(c,"dragId"),m=u.getAttribute(c,"originalScope"),f=_[d],b=f.endpoints[0].isFloating()?0:1,v=f.endpoints[0];a.endpoint?E.extend({},a.endpoint):{};if(!wt[i]||jt[i]>0&&n>=jt[i])return p&&p({element:e.el,connection:f},t),!1;v.anchor.locked=!1,m&&l.setDragScope(c,m);var y=g.isDropAllowed(0===b?i:f.sourceId,0===b?f.targetId:i,f.scope,f,null);if(f.suspendedEndpoint&&(f[b?"targetId":"sourceId"]=f.suspendedEndpoint.elementId,f[b?"target":"source"]=f.suspendedEndpoint.element,f.endpoints[b]=f.suspendedEndpoint),y){var P=l.getElementObject(e.el),j=yt[i]||u.addEndpoint(P,a);if(a.uniqueEndpoint&&(yt[i]=j),j._doNotDeleteOnDetach=!1,j._deleteOnDetach=!0,null!=j.anchor.positionFinder){var x=l.getUIPosition(arguments,u.getZoom()),C=r(P,u),S=o(P),D=j.anchor.positionFinder(x,C,S,j.anchor.constructorParams);j.anchor.x=D[0],j.anchor.y=D[1]}f[b?"target":"source"]=j.element,f[b?"targetId":"sourceId"]=j.elementId,f.endpoints[b].detachFromConnection(f),f.endpoints[b]._deleteOnDetach&&(f.endpoints[b].deleteAfterDragStop=!0),j.addConnection(f),f.endpoints[b]=j,f.deleteEndpointsOnDetach=h,1==b?u.anchorManager.updateOtherEndpoint(f.sourceId,f.suspendedElementId,f.targetId,f):u.anchorManager.sourceChanged(f.suspendedEndpoint.elementId,f.sourceId,f),B(f,null,t)}else f.suspendedEndpoint&&(f.isReattach()?(f.setHover(!1),f.floatingAnchorIndex=null,f.suspendedEndpoint.addConnection(f),u.repaint(v.elementId)):v.detach(f,!1,!0,!0,t))},y=l.dragEvents.drop;b.scope=b.scope||c,b[y]=t.wrap(b[y],v),l.initDroppable(s(e.el),b,!0)},n=F(n);for(var g=n.length&&n.constructor!=String?n:[n],b=0,v=g.length;v>b;b++)_doOne(g[b]);return u},this.unmakeTarget=function(t,n){var e=f(t);return E.CurrentLibrary.destroyDroppable(e.el),n||(delete vt[e.id],delete Pt[e.id],delete jt[e.id],delete wt[e.id]),u},this.makeSource=function(n,e,r){var o=E.extend({},r);E.extend(o,e),xt(o,0);var a=E.CurrentLibrary,l=o.maxConnections||-1,c=o.onMaxConnections,h=function(n){var e=n.id,r=s(n.el),h=function(){return null==o.parent?null:"parent"===o.parent?n.el.parentNode:i(o.parent)},d=null!=o.parent?u.getId(h()):e;Ct[d]=o,St[d]=o.uniqueEndpoint,_t[d]=!0;var p=a.dragEvents.stop,m=a.dragEvents.drag,f=E.extend({},o.dragOptions||{}),g=f.drag,b=f.stop,v=null,P=!1;At[d]=l,f.scope=f.scope||o.scope,f[m]=t.wrap(f[m],function(){g&&g.apply(this,arguments),P=!1}),f[p]=t.wrap(f[p],function(){if(b&&b.apply(this,arguments),u.currentlyDragging=!1,null!=v._jsPlumb){a.unbind(v.canvas,"mousedown");var t=o.anchor||u.Defaults.Anchor,n=(v.anchor,v.connections[0]);if(v.setAnchor(u.makeAnchor(t,e,u),!0),o.parent){var s=h();if(s){var i=(v.elementId,o.container||u.Defaults.Container||E.Defaults.Container);v.setElement(s,i),v.endpointWillMoveAfterConnection=!1,n.previousConnection=null,jsPlumbUtil.removeWithFunction(y,function(t){return t.id===n.id}),u.anchorManager.connectionDetached({sourceId:n.sourceId,targetId:n.targetId,connection:n}),B(n)}}v.repaint(),u.repaint(v.elementId),u.repaint(n.targetId)}});var j=function(t){if(_t[d]){if(o.filter){var n=a.getOriginalEvent(t),s=jsPlumbUtil.isString(o.filter)?It(n,r,o.filter):o.filter(n,r);if(s===!1)return}var i=u.select({source:d}).length;if(At[d]>=0&&i>=At[d])return c&&c({element:r,maxConnections:l},t),!1;var p=$({elId:e}).o,m=u.getZoom(),g=((t.pageX||t.page.x)/m-p.left)/p.width,b=((t.pageY||t.page.y)/m-p.top)/p.height,y=g,j=b;if(o.parent){var x=h(),C=nt(x);p=$({elId:C}).o,y=((t.pageX||t.page.x)-p.left)/p.width,j=((t.pageY||t.page.y)-p.top)/p.height}var S={};if(E.extend(S,o),S.isSource=!0,S.anchor=[g,b,0,0],S.parentAnchor=[y,j,0,0],S.dragOptions=f,o.parent){var _=S.container||u.Defaults.Container||E.Defaults.Container;_?S.container=_:S.container=E.CurrentLibrary.getParent(h())}v=u.addEndpoint(e,S),P=!0,v.endpointWillMoveAfterConnection=null!=o.parent,v.endpointWillMoveTo=o.parent?h():null,v._doNotDeleteOnDetach=!1,v._deleteOnDetach=!0;var D=function(){P&&(P=!1,u.deleteEndpoint(v))};u.registerListener(v.canvas,"mouseup",D),u.registerListener(r,"mouseup",D),a.trigger(v.canvas,"mousedown",t)}};u.registerListener(r,"mousedown",j),Dt[e]=j,o.filter&&jsPlumbUtil.isString(o.filter)&&a.setDragFilter(r,o.filter)};n=F(n);for(var d=n.length&&n.constructor!=String?n:[n],p=0,m=d.length;m>p;p++)h(f(d[p]));return u},this.unmakeSource=function(t,n){var e=f(t),s=Dt[e.id];return s&&u.unregisterListener(e.el,"mousedown",s),n||(delete Ct[e.id],delete St[e.id],delete _t[e.id],delete Dt[e.id],delete At[e.id]),u},this.unmakeEverySource=function(){for(var t in _t)u.unmakeSource(t,!0);Ct={},St={},_t={},Dt={}},this.unmakeEveryTarget=function(){for(var t in wt)u.unmakeTarget(t,!0);return vt={},Pt={},jt={},wt={},u};var Ot=function(n,e,s,i){var r="source"==n?_t:wt;if(e=F(e),t.isString(e))r[e]=i?!r[e]:s;else if(e.length)for(var o=0,a=e.length;a>o;o++){var l=f(e[o]);r[l.id]=i?!r[l.id]:s}return u};this.toggleSourceEnabled=function(t){return Ot("source",t,null,!0),u.isSourceEnabled(t)},this.setSourceEnabled=function(t,n){return Ot("source",t,n)},this.isSource=function(t){return null!=_t[f(t).id]},this.isSourceEnabled=function(t){return _t[f(t).id]===!0},this.toggleTargetEnabled=function(t){return Ot("target",t,null,!0),u.isTargetEnabled(t)},this.isTarget=function(t){return null!=wt[f(t).id]},this.isTargetEnabled=function(t){return wt[f(t).id]===!0},this.setTargetEnabled=function(t,n){return Ot("target",t,n)},this.ready=function(t){u.bind("ready",t)},this.repaint=function(t,n,e){if("object"==typeof t&&t.length)for(var s=0,i=t.length;i>s;s++)W(t[s],n,e);else W(t,n,e);return u},this.repaintEverything=function(){var t=a();for(var n in P)W(n,null,t);return u},this.removeAllEndpoints=function(t,n){var e=function(t){var s,i,r=f(t),o=P[r.id];if(o)for(s=0,i=o.length;i>s;s++)u.deleteEndpoint(o[s]);if(delete P[r.id],n&&r.el&&3!=r.el.nodeType&&8!=r.el.nodeType)for(s=0,i=r.el.childNodes.length;i>s;s++)e(r.el.childNodes[s])};return e(t),u},this.remove=function(t,n){var e=f(t);u.doWhileSuspended(function(){u.removeAllEndpoints(e.id,!0),u.dragManager.elementRemoved(e.id),delete _[e.id],u.anchorManager.clearFor(e.id),u.anchorManager.removeFloatingConnection(e.id)},n===!1),e.el&&E.CurrentLibrary.removeElement(e.el)};var Lt={},Mt=function(){for(var t in Lt)for(var n=0,e=Lt[t].length;e>n;n++){var s=Lt[t][n];E.CurrentLibrary.unbind(s.el,s.event,s.listener)}Lt={}};this.registerListener=function(t,n,e){E.CurrentLibrary.bind(t,n,e),jsPlumbUtil.addToList(Lt,n,{el:t,event:n,listener:e})},this.unregisterListener=function(t,n,e){E.CurrentLibrary.unbind(t,n,e),jsPlumbUtil.removeWithFunction(Lt,function(t){return t.type==n&&t.listener==e})},this.reset=function(){u.deleteEveryEndpoint(),u.unbind(),vt={},yt={},Pt={},jt={},Ct={},Et={},St={},At={},y.splice(0),Mt(),u.anchorManager.reset(),jsPlumbAdapter.headless||u.dragManager.reset()},this.setDefaultScope=function(t){return L=t,u},this.setDraggable=Z,this.setId=function(t,n,e){var s;jsPlumbUtil.isString(t)?s=t:(t=i(t),s=u.getId(t));var r=u.getConnections({source:s,scope:"*"},!0),o=u.getConnections({target:s,scope:"*"},!0);n=""+n,e?t=i(n):(t=i(s),jsPlumbAdapter.setAttribute(t,"id",n)),P[n]=P[s]||[];for(var a=0,l=P[n].length;l>a;a++)P[n][a].setElementId(n),P[n][a].setReferenceElement(t);delete P[s],u.anchorManager.changeId(s,n),jsPlumbAdapter.headless||u.dragManager.changeId(s,n);var c=function(e,s,i){for(var r=0,o=e.length;o>r;r++)e[r].endpoints[s].setElementId(n),e[r].endpoints[s].setReferenceElement(t),e[r][i+"Id"]=n,e[r][i]=t};c(r,0,"source"),c(o,1,"target"),u.repaint(n)},this.setDebugLog=function(t){b=t},this.setSuspendDrawing=function(t,n){var e=I;return I=t,O=t?(new Date).getTime():null,n&&u.repaintEverything(),e},this.isSuspendDrawing=function(){return I},this.getSuspendedAt=function(){return O},this.doWhileSuspended=function(n,e){var s=u.isSuspendDrawing();s||u.setSuspendDrawing(!0);try{n()}catch(i){t.log("Function run while suspended failed",i)}s||u.setSuspendDrawing(!1,!e)},this.updateOffset=$,this.getOffset=function(t){return C[t]},this.getSize=function(t){return w[t]},this.getCachedData=tt,this.timestamp=a,this.setRenderMode=function(t){M=jsPlumbAdapter.setRenderMode(t);var n,e;if(M==E.CANVAS){var s=function(t){E.CurrentLibrary.bind(document,t,function(s){if(!u.currentlyDragging&&M==E.CANVAS){for(n=0,e=y.length;e>n;n++){var i=y[n].getConnector()[t](s);if(i)return}for(var r in P){var o=P[r];for(n=0,e=o.length;e>n;n++)if(o[n].endpoint[t]&&o[n].endpoint[t](s))return}}})};s("click"),s("dblclick"),s("mousemove"),s("mousedown"),s("mouseup"),s("contextmenu")}return M},this.getRenderMode=function(){return M},this.show=function(t,n){return J(t,"block",n),u},this.getTestHarness=function(){return{endpointsByElement:P,endpointCount:function(t){var n=P[t];return n?n.length:0},connectionCount:function(t){t=t||L;var n=u.getConnections({scope:t});return n?n.length:0},getId:nt,makeAnchor:self.makeAnchor,makeDynamicAnchor:self.makeDynamicAnchor}},this.toggleVisible=Q,this.toggleDraggable=K,this.addListener=this.bind,this.adjustForParentOffsetAndScroll=function(t,n){var e=null,s=t;if("svg"===n.tagName.toLowerCase()&&n.parentNode?e=n.parentNode:n.offsetParent&&(e=n.offsetParent),null!=e){var i="body"===e.tagName.toLowerCase()?{left:0,top:0}:r(e,u),o="body"===e.tagName.toLowerCase()?{left:0,top:0}:{left:e.scrollLeft,top:e.scrollTop};s[0]=t[0]-i.left+o.left,s[1]=t[1]-i.top+o.top}return s},jsPlumbAdapter.headless||(u.dragManager=jsPlumbAdapter.getDragManager(u),u.recalculateOffsets=u.dragManager.updateOffsets)};jsPlumbUtil.extend(C,jsPlumbUtil.EventGenerator,{setAttribute:function(t,n,e){jsPlumbAdapter.setAttribute(t,n,e)},getAttribute:function(t,n){return jsPlumbAdapter.getAttribute(E.CurrentLibrary.getDOMElement(t),n)},registerConnectionType:function(t,n){this._connectionTypes[t]=E.extend({},n)},registerConnectionTypes:function(t){for(var n in t)this._connectionTypes[n]=E.extend({},t[n])},registerEndpointType:function(t,n){this._endpointTypes[t]=E.extend({},n)},registerEndpointTypes:function(t){for(var n in t)this._endpointTypes[n]=E.extend({},t[n])},getType:function(t,n){return"connection"===n?this._connectionTypes[t]:this._endpointTypes[t]},setIdChanged:function(t,n){this.setId(t,n,!0)}});var E=new C;"undefined"!=typeof window&&(window.jsPlumb=E),E.getInstance=function(t){var n=new C(t);return n.init(),n},"function"==typeof define&&(define("jsplumb",[],function(){return E}),define("jsplumbinstance",[],function(){return E.getInstance()})),"undefined"!=typeof exports&&(exports.jsPlumb=E)}(),function(){var t=function(t,n){var e=!1;return{drag:function(){if(e)return e=!1,!0;var s=jsPlumb.CurrentLibrary.getUIPosition(arguments,n.getZoom());t.element&&(jsPlumb.CurrentLibrary.setOffset(t.element,s),n.repaint(t.element,s))},stopDrag:function(){e=!0}}},n=function(t,n,e){var s=document.createElement("div");s.style.position="absolute";jsPlumb.CurrentLibrary.getElementObject(s);jsPlumb.CurrentLibrary.appendElement(s,n);var i=e.getId(s);e.updateOffset({elId:i}),t.id=i,t.element=s},e=function(t,n,e,s,i,r,o){var a=new jsPlumb.FloatingAnchor({reference:n,referenceCanvas:s,jsPlumbInstance:r});return o({paintStyle:t,endpoint:e,anchor:a,source:i,scope:"__floating"})},s=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],i=function(t,n){var e=0;if(null!=n)for(var s=0;s<t.connections.length;s++)if(t.connections[s].sourceId==n||t.connections[s].targetId==n){e=s;break}return t.connections[e]},r=function(t,n){return jsPlumbUtil.findWithFunction(n.connections,function(n){return n.id==t.id})};jsPlumb.Endpoint=function(o){var a=o._jsPlumb,l=jsPlumb.CurrentLibrary,u=(jsPlumbAdapter.getAttribute,l.getElementObject),c=l.getDOMElement,h=jsPlumbUtil,d=o.newConnection,p=o.newEndpoint,m=o.finaliseConnection,f=o.fireDetachEvent,g=o.floatingConnections;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],this.parent=o.parent,OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.getDefaultType=function(){return{parameters:{},scope:null,maxConnections:this._jsPlumb.instance.Defaults.MaxConnections,paintStyle:this._jsPlumb.instance.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,endpoint:this._jsPlumb.instance.Defaults.Endpoint||jsPlumb.Defaults.Endpoint,hoverPaintStyle:this._jsPlumb.instance.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,overlays:this._jsPlumb.instance.Defaults.EndpointOverlays||jsPlumb.Defaults.EndpointOverlays,connectorStyle:o.connectorStyle,connectorHoverStyle:o.connectorHoverStyle,connectorClass:o.connectorClass,connectorHoverClass:o.connectorHoverClass,connectorOverlays:o.connectorOverlays,connector:o.connector,connectorTooltip:o.connectorTooltip}},this._jsPlumb.enabled=!(o.enabled===!1),this._jsPlumb.visible=!0,this.element=c(o.source),this._jsPlumb.uuid=o.uuid,this._jsPlumb.floatingEndpoint=null;var b=null;this._jsPlumb.uuid&&(o.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=o.elementId,this._jsPlumb.connectionCost=o.connectionCost,this._jsPlumb.connectionsDirected=o.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var v=function(){l.removeClass(this.element,a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.removeClass(a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this._jsPlumb.currentAnchorClass=this.anchor.getCssClass(),this.addClass(a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),l.addClass(this.element,a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass)}.bind(this);this.setAnchor=function(t,n){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=this._jsPlumb.instance.makeAnchor(t,this.elementId,a),v(),this.anchor.bind("anchorChanged",function(t){this.fire("anchorChanged",{endpoint:this,anchor:t}),v()}.bind(this)),n||this._jsPlumb.instance.repaint(this.elementId),this};var y=o.anchor?o.anchor:o.anchors?o.anchors:a.Defaults.Anchor||"Top";this.setAnchor(y,!0);var P=function(t){this.connections.length>0?this.connections[0].setHover(t,!1):this.setHover(t)}.bind(this);if(o._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.setEndpoint=function(t){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy());var n=function(t,n){var e=a.getRenderMode();if(jsPlumb.Endpoints[e][t])return new jsPlumb.Endpoints[e][t](n);if(!a.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+t+"'"}},e={_jsPlumb:this._jsPlumb.instance,cssClass:o.cssClass,parent:o.parent,container:o.container,tooltip:o.tooltip,connectorTooltip:o.connectorTooltip,endpoint:this};h.isString(t)?this.endpoint=n(t,e):h.isArray(t)?(e=h.merge(t[1],e),this.endpoint=n(t[0],e)):this.endpoint=t.clone();jsPlumb.extend({},e);this.endpoint.clone=function(){return h.isString(t)?n(t,e):h.isArray(t)?(e=h.merge(t[1],e),n(t[0],e)):void 0}.bind(this),this.type=this.endpoint.type,this.bindListeners(this.endpoint,this,P)},this.setEndpoint(o.endpoint||a.Defaults.Endpoint||jsPlumb.Defaults.Endpoint||"Dot"),this.setPaintStyle(o.paintStyle||o.style||a.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle,!0),this.setHoverPaintStyle(o.hoverPaintStyle||a.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle(),h.copyValues(s,o,this),this.isSource=o.isSource||!1,this.isTarget=o.isTarget||!1,this._jsPlumb.maxConnections=o.maxConnections||a.Defaults.MaxConnections,this.canvas=this.endpoint.canvas,this.addClass(a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),l.addClass(this.element,a.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.connections=o.connections||[],this.connectorPointerEvents=o["connector-pointer-events"],this.scope=o.scope||a.getDefaultScope(),this.timestamp=null,this.reattachConnections=o.reattach||a.Defaults.ReattachConnections,this.connectionsDetachable=a.Defaults.ConnectionsDetachable,(o.connectionsDetachable===!1||o.detachable===!1)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=o.dragAllowedWhenFull||!0,o.onMaxConnections&&this.bind("maxConnections",o.onMaxConnections),this.addConnection=function(t){this.connections.push(t),this[(this.connections.length>0?"add":"remove")+"Class"](a.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](a.endpointFullClass)},this.detachFromConnection=function(t,n){n=null==n?r(t,this):n,n>=0&&(this.connections.splice(n,1),this[(this.connections.length>0?"add":"remove")+"Class"](a.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](a.endpointFullClass))},this.detach=function(t,n,e,s,i,o,l){var u=null==l?r(t,this):l,c=!1;return s=s!==!1,u>=0&&(e||t._forceDetach||t.isDetachable()&&t.isDetachAllowed(t)&&this.isDetachAllowed(t))&&(a.deleteObject({connection:t,fireEvent:!n&&s,originalEvent:i}),c=!0),c},this.detachAll=function(t,n){for(;this.connections.length>0;)this.detach(this.connections[0],!1,!0,t!==!1,n,this,0);return this},this.detachFrom=function(t,n,e){for(var s=[],i=0;i<this.connections.length;i++)(this.connections[i].endpoints[1]==t||this.connections[i].endpoints[0]==t)&&s.push(this.connections[i]);for(var r=0;r<s.length;r++)this.detach(s[r],!1,!0,n,e);return this},this.getElement=function(){return this.element},this.setElement=function(t){var n=this._jsPlumb.instance.getId(t),e=this.elementId;return h.removeWithFunction(o.endpointsByElement[this.elementId],function(t){return t.id==this.id}.bind(this)),this.element=c(t),this.elementId=a.getId(this.element),a.anchorManager.rehomeEndpoint(this,e,this.element),a.dragManager.endpointAdded(this.element),h.addToList(o.endpointsByElement,n,this),this},this.makeInPlaceCopy=function(){var t=this.anchor.getCurrentLocation({element:this}),n=this.anchor.getOrientation(this),e=this.anchor.getCssClass(),s={bind:function(){},compute:function(){return[t[0],t[1]]},getCurrentLocation:function(){return[t[0],t[1]]},getOrientation:function(){return n},getCssClass:function(){return e}};return p({anchor:s,source:this.element,paintStyle:this.getPaintStyle(),endpoint:o.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope})},this.isFloating=function(){return null!=this.anchor&&this.anchor.isFloating},this.connectorSelector=function(){var t=this.connections[0];return this.isTarget&&t?t:this.connections.length<this._jsPlumb.maxConnections||-1==this._jsPlumb.maxConnections?null:t},this.setStyle=this.setPaintStyle,this.paint=function(t){t=t||{};var n=t.timestamp,e=!(t.recalc===!1);if(!n||this.timestamp!==n){var s=a.updateOffset({elId:this.elementId,timestamp:n}),r=t.offset?t.offset.o:s.o;if(null!=r){var o=t.anchorPoint,l=t.connectorPaintStyle;if(null==o){var u=t.dimensions||s.s,c={xy:[r.left,r.top],wh:u,element:this,timestamp:n};if(e&&this.anchor.isDynamic&&this.connections.length>0){var h=i(this,t.elementWithPrecedence),d=h.endpoints[0]==this?1:0,p=0===d?h.sourceId:h.targetId,m=a.getCachedData(p),f=m.o,g=m.s;c.txy=[f.left,f.top],c.twh=g,c.tElement=h.endpoints[d]}o=this.anchor.compute(c)}this.endpoint.compute(o,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,l||this.paintStyleInUse),
this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=n;for(var b=0;b<this._jsPlumb.overlays.length;b++){var v=this._jsPlumb.overlays[b];v.isVisible()&&(this._jsPlumb.overlayPlacements[b]=v.draw(this.endpoint,this._jsPlumb.paintStyleInUse),v.paint(this._jsPlumb.overlayPlacements[b]))}}}},this.repaint=this.paint,l.isDragSupported(this.element)&&(this.isSource||this.isTarget)){var j={id:null,element:null},x=null,C=!1,E=null,S=t(j,a),_=function(){x=this.connectorSelector();var t=!0;if(this.isEnabled()||(t=!1),null!=x||this.isSource||(t=!1),this.isSource&&this.isFull()&&!this.dragAllowedWhenFull&&(t=!1),null==x||x.isDetachable()||(t=!1),t===!1)return l.stopDrag&&l.stopDrag(),S.stopDrag(),!1;for(var s=0;s<this.connections.length;s++)this.connections[s].setHover(!1);this.addClass("endpointDrag"),a.setConnectionBeingDragged(!0),x&&!this.isFull()&&this.isSource&&(x=null),a.updateOffset({elId:this.elementId}),b=this.makeInPlaceCopy(),b.referenceEndpoint=this,b.paint(),n(j,this.parent,a);var i=u(b.canvas),r=jsPlumb.CurrentLibrary.getOffset(i,a),c=a.adjustForParentOffsetAndScroll([r.left,r.top],b.canvas),m=u(this.canvas);if(l.setOffset(j.element,{left:c[0],top:c[1]}),this.parentAnchor&&(this.anchor=a.makeAnchor(this.parentAnchor,this.elementId,a)),a.setAttribute(this.canvas,"dragId",j.id),a.setAttribute(this.canvas,"elId",this.elementId),this._jsPlumb.floatingEndpoint=e(this.getPaintStyle(),this.anchor,this.endpoint,this.canvas,j.element,a,p),this.canvas.style.visibility="hidden",null==x)this.anchor.locked=!0,this.setHover(!1,!1),x=d({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.endpointWillMoveTo||this.element,target:j.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:o.connectorStyle,hoverPaintStyle:o.connectorHoverStyle,connector:o.connector,overlays:o.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass}),x.addClass(a.draggingClass),this._jsPlumb.floatingEndpoint.addClass(a.draggingClass),a.fire("connectionDrag",x);else{C=!0,x.setHover(!1),M(i,!1,!0);var f=x.endpoints[0].id==this.id?0:1;x.floatingAnchorIndex=f,this.detachFromConnection(x);var v=jsPlumb.CurrentLibrary.getDragScope(m);a.setAttribute(this.canvas,"originalScope",v);var y=l.getDropScope(m);l.setDragScope(m,y),a.fire("connectionDrag",x),0===f?(E=[x.source,x.sourceId,m,v],x.source=j.element,x.sourceId=j.id):(E=[x.target,x.targetId,m,v],x.target=j.element,x.targetId=j.id),x.endpoints[0===f?1:0].anchor.locked=!0,x.suspendedEndpoint=x.endpoints[f],x.suspendedElement=x.endpoints[f].getElement(),x.suspendedElementId=x.endpoints[f].elementId,x.suspendedElementType=0===f?"source":"target",x.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=x.suspendedEndpoint,x.endpoints[f]=this._jsPlumb.floatingEndpoint,x.addClass(a.draggingClass),this._jsPlumb.floatingEndpoint.addClass(a.draggingClass)}g[j.id]=x,a.anchorManager.addFloatingConnection(j.id,x),h.addToList(o.endpointsByElement,j.id,this._jsPlumb.floatingEndpoint),a.currentlyDragging=!0}.bind(this),D=o.dragOptions||{},A=jsPlumb.extend({},l.defaultDragOptions),w=l.dragEvents.start,I=l.dragEvents.stop,O=l.dragEvents.drag;D=jsPlumb.extend(A,D),D.scope=D.scope||this.scope,D[w]=h.wrap(D[w],_,!1),D[O]=h.wrap(D[O],S.drag),D[I]=h.wrap(D[I],function(){a.setConnectionBeingDragged(!1);var t=l.getDropEvent(arguments),n=null==x.floatingAnchorIndex?1:x.floatingAnchorIndex;x.endpoints[0===n?1:0].anchor.locked=!1,x.removeClass(a.draggingClass),x.endpoints[n]==this._jsPlumb.floatingEndpoint&&C&&x.suspendedEndpoint&&(0===n?(x.source=E[0],x.sourceId=E[1]):(x.target=E[0],x.targetId=E[1]),l.setDragScope(E[2],E[3]),x.endpoints[n]=x.suspendedEndpoint,(x.isReattach()||x._forceReattach||x._forceDetach||!x.endpoints[0===n?1:0].detach(x,!1,!1,!0,t))&&(x.setHover(!1),x.floatingAnchorIndex=null,x._forceDetach=null,x._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(x),x.suspendedEndpoint.addConnection(x),a.repaint(E[1]))),a.remove(j.element,!1),a.remove(b.canvas,!1),this.deleteAfterDragStop?a.deleteObject({endpoint:this}):this._jsPlumb&&(this._jsPlumb.floatingEndpoint=null,this.canvas.style.visibility="visible",this.anchor.locked=!1,this.paint({recalc:!1})),a.fire("connectionDragStop",x),a.currentlyDragging=!1,x=null}.bind(this));var L=u(this.canvas);l.initDraggable(L,D,!0,a)}var M=function(t,n,e,s){if((this.isTarget||n)&&l.isDropSupported(this.element)){var i=o.dropOptions||a.Defaults.DropOptions||jsPlumb.Defaults.DropOptions;i=jsPlumb.extend({},i),i.scope=i.scope||this.scope;var r=l.dragEvents.drop,c=l.dragEvents.over,d=l.dragEvents.out,p=function(){this.removeClass(a.endpointDropAllowedClass),this.removeClass(a.endpointDropForbiddenClass);var t=l.getDropEvent(arguments),n=u(l.getDragObject(arguments)),e=a.getAttribute(n,"dragId"),i=(a.getAttribute(n,"elId"),a.getAttribute(n,"originalScope")),r=g[e],o=r.suspendedEndpoint&&(r.suspendedEndpoint.id==this.id||this.referenceEndpoint&&r.suspendedEndpoint.id==this.referenceEndpoint.id);if(o)return void(r._forceReattach=!0);if(null!=r){var c=null==r.floatingAnchorIndex?1:r.floatingAnchorIndex;i&&jsPlumb.CurrentLibrary.setDragScope(n,i);var h=null!=s?s.isEnabled():!0;if(this.isFull()&&this.fire("maxConnections",{endpoint:this,connection:r,maxConnections:this._jsPlumb.maxConnections},t),!this.isFull()&&(0!==c||this.isSource)&&(1!=c||this.isTarget)&&h){var d=!0;r.suspendedEndpoint&&r.suspendedEndpoint.id!=this.id&&(0===c?(r.source=r.suspendedEndpoint.element,r.sourceId=r.suspendedEndpoint.elementId):(r.target=r.suspendedEndpoint.element,r.targetId=r.suspendedEndpoint.elementId),r.isDetachAllowed(r)&&r.endpoints[c].isDetachAllowed(r)&&r.suspendedEndpoint.isDetachAllowed(r)&&a.checkCondition("beforeDetach",r)||(d=!1)),0===c?(r.source=this.element,r.sourceId=this.elementId):(r.target=this.element,r.targetId=this.elementId);var p=function(){r.floatingAnchorIndex=null},b=function(){r.endpoints[c].detachFromConnection(r),r.suspendedEndpoint&&r.suspendedEndpoint.detachFromConnection(r),r.endpoints[c]=this,this.addConnection(r);var n=this.getParameters();for(var e in n)r.setParameter(e,n[e]);if(r.suspendedEndpoint){var s=r.suspendedEndpoint.getElement(),i=r.suspendedEndpoint.elementId;f({source:0===c?s:r.source,target:1==c?s:r.target,sourceId:0===c?i:r.sourceId,targetId:1==c?i:r.targetId,sourceEndpoint:0===c?r.suspendedEndpoint:r.endpoints[0],targetEndpoint:1==c?r.suspendedEndpoint:r.endpoints[1],connection:r},!0,t)}else n.draggable&&jsPlumb.CurrentLibrary.initDraggable(this.element,D,!0,a);1==c?a.anchorManager.updateOtherEndpoint(r.sourceId,r.suspendedElementId,r.targetId,r):a.anchorManager.sourceChanged(r.suspendedEndpoint.elementId,r.sourceId,r),m(r,null,t,!0),p()}.bind(this),v=function(){r.suspendedEndpoint&&(r.endpoints[c]=r.suspendedEndpoint,r.setHover(!1),r._forceDetach=!0,0===c?(r.source=r.suspendedEndpoint.element,r.sourceId=r.suspendedEndpoint.elementId):(r.target=r.suspendedEndpoint.element,r.targetId=r.suspendedEndpoint.elementId),r.suspendedEndpoint.addConnection(r),r.endpoints[0].repaint(),r.repaint(),a.repaint(r.sourceId),r._forceDetach=!1),p()};d=d&&this.isDropAllowed(r.sourceId,r.targetId,r.scope,r,this),d?b():v()}a.currentlyDragging=!1}}.bind(this);i[r]=h.wrap(i[r],p),i[c]=h.wrap(i[c],function(){var t=l.getDragObject(arguments),n=a.getAttribute(t,"dragId"),e=g[n];if(null!=e){var s=null==e.floatingAnchorIndex?1:e.floatingAnchorIndex,i=this.isTarget&&0!==e.floatingAnchorIndex||e.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==e.suspendedEndpoint.id;if(i){var r=a.checkCondition("checkDropAllowed",{sourceEndpoint:e.endpoints[s],targetEndpoint:this,connection:e});this[(r?"add":"remove")+"Class"](a.endpointDropAllowedClass),this[(r?"remove":"add")+"Class"](a.endpointDropForbiddenClass),e.endpoints[s].anchor.over(this.anchor,this)}}}.bind(this)),i[d]=h.wrap(i[d],function(){var t=l.getDragObject(arguments),n=a.getAttribute(t,"dragId"),e=g[n];if(null!=e){var s=null==e.floatingAnchorIndex?1:e.floatingAnchorIndex,i=this.isTarget&&0!==e.floatingAnchorIndex||e.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==e.suspendedEndpoint.id;i&&(this.removeClass(a.endpointDropAllowedClass),this.removeClass(a.endpointDropForbiddenClass),e.endpoints[s].anchor.out())}}.bind(this)),l.initDroppable(t,i,!0,e)}}.bind(this);return M(u(this.canvas),!0,!(o._transient||this.anchor.isFloating),this),o.type&&this.addType(o.type,o.data,a.isSuspendDrawing()),this},jsPlumbUtil.extend(jsPlumb.Endpoint,OverlayCapableJsPlumbUIComponent,{getTypeDescriptor:function(){return"endpoint"},isVisible:function(){return this._jsPlumb.visible},setVisible:function(t,n,e){if(this._jsPlumb.visible=t,this.canvas&&(this.canvas.style.display=t?"block":"none"),this[t?"showOverlays":"hideOverlays"](),!n)for(var s=0;s<this.connections.length;s++)if(this.connections[s].setVisible(t),!e){var i=this===this.connections[s].endpoints[0]?1:0;1==this.connections[s].endpoints[i].connections.length&&this.connections[s].endpoints[i].setVisible(t,!0,!0)}},getAttachedElements:function(){return this.connections},applyType:function(t,n){null!=t.maxConnections&&(this._jsPlumb.maxConnections=t.maxConnections),t.scope&&(this.scope=t.scope),jsPlumbUtil.copyValues(s,t,this)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(t){this._jsPlumb.enabled=t},cleanup:function(){jsPlumb.CurrentLibrary.removeClass(this.element,this._jsPlumb.instance.endpointAnchorClassPrefix+"_"+this._jsPlumb.currentAnchorClass),this.anchor=null,this.endpoint.cleanup(),this.endpoint.destroy(),this.endpoint=null;var t=jsPlumb.CurrentLibrary.getElementObject(this.canvas);jsPlumb.CurrentLibrary.destroyDraggable(t),jsPlumb.CurrentLibrary.destroyDroppable(t)},setHover:function(t){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(t)},isFull:function(){return!(this.isFloating()||this._jsPlumb.maxConnections<1||this.connections.length<this._jsPlumb.maxConnections)},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(t){this._jsPlumb.connectionCost=t},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(t){this._jsPlumb.connectionsDirected=t},setElementId:function(t){this.elementId=t,this.anchor.elementId=t},setReferenceElement:function(t){this.element=jsPlumb.CurrentLibrary.getDOMElement(t)},setDragAllowedWhenFull:function(t){this.dragAllowedWhenFull=t},equals:function(t){return this.anchor.equals(t.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(t){return this.anchor.compute(t)}})}(),function(){var t=function(t,n,e,s){if(!t.Defaults.DoNotThrowErrors&&null==jsPlumb.Connectors[n][e])throw{msg:"jsPlumb: unknown connector type '"+e+"'"};return new jsPlumb.Connectors[n][e](s)},n=function(t,n,e){return t?e.makeAnchor(t,n,e):null},e=function(t,e,s,i,r,o,a,l,u,c){var h;if(i)s.endpoints[r]=i,i.addConnection(s);else{o.endpoints||(o.endpoints=[null,null]);var d=o.endpoints[r]||o.endpoint||t.Defaults.Endpoints[r]||jsPlumb.Defaults.Endpoints[r]||t.Defaults.Endpoint||jsPlumb.Defaults.Endpoint;o.endpointStyles||(o.endpointStyles=[null,null]),o.endpointHoverStyles||(o.endpointHoverStyles=[null,null]);var p=o.endpointStyles[r]||o.endpointStyle||t.Defaults.EndpointStyles[r]||jsPlumb.Defaults.EndpointStyles[r]||t.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle;null==p.fillStyle&&null!=u&&(p.fillStyle=u.strokeStyle),null==p.outlineColor&&null!=u&&(p.outlineColor=u.outlineColor),null==p.outlineWidth&&null!=u&&(p.outlineWidth=u.outlineWidth);var m=o.endpointHoverStyles[r]||o.endpointHoverStyle||t.Defaults.EndpointHoverStyles[r]||jsPlumb.Defaults.EndpointHoverStyles[r]||t.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle;null!=c&&(null==m&&(m={}),null==m.fillStyle&&(m.fillStyle=c.strokeStyle));var f=o.anchors?o.anchors[r]:o.anchor?o.anchor:n(t.Defaults.Anchors[r],l,t)||n(jsPlumb.Defaults.Anchors[r],l,t)||n(t.Defaults.Anchor,l,t)||n(jsPlumb.Defaults.Anchor,l,t),g=o.uuids?o.uuids[r]:null;h=e({paintStyle:p,hoverPaintStyle:m,endpoint:d,connections:[s],uuid:g,anchor:f,source:a,scope:o.scope,container:o.container,reattach:o.reattach||t.Defaults.ReattachConnections,detachable:o.detachable||t.Defaults.ConnectionsDetachable}),s.endpoints[r]=h,o.drawEndpoints===!1&&h.setVisible(!1,!0,!0)}return h};jsPlumb.Connection=function(t){var n=(t.newConnection,t.newEndpoint),s=jsPlumb.CurrentLibrary,i=(s.getAttribute,s.getElementObject,s.getDOMElement),r=jsPlumbUtil;s.getOffset;this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.parent=t.parent,this.previousConnection=t.previousConnection,this.source=i(t.source),this.target=i(t.target),t.sourceEndpoint&&(this.source=t.sourceEndpoint.endpointWillMoveTo||t.sourceEndpoint.getElement()),t.targetEndpoint&&(this.target=t.targetEndpoint.getElement()),OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=t.scope,this.endpoints=[],this.endpointStyles=[];var o=this._jsPlumb.instance;this._jsPlumb.visible=!0,this._jsPlumb.editable=t.editable===!0,this._jsPlumb.params={parent:t.parent,cssClass:t.cssClass,container:t.container,"pointer-events":t["pointer-events"],editorParams:t.editorParams},this._jsPlumb.lastPaintedAt=null,this.getDefaultType=function(){return{parameters:{},scope:null,detachable:this._jsPlumb.instance.Defaults.ConnectionsDetachable,rettach:this._jsPlumb.instance.Defaults.ReattachConnections,paintStyle:this._jsPlumb.instance.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,connector:this._jsPlumb.instance.Defaults.Connector||jsPlumb.Defaults.Connector,hoverPaintStyle:this._jsPlumb.instance.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,overlays:this._jsPlumb.instance.Defaults.ConnectorOverlays||jsPlumb.Defaults.ConnectorOverlays}};var a=e(o,n,this,t.sourceEndpoint,0,t,this.source,this.sourceId,t.paintStyle,t.hoverPaintStyle);a&&r.addToList(t.endpointsByElement,this.sourceId,a);var l=e(o,n,this,t.targetEndpoint,1,t,this.target,this.targetId,t.paintStyle,t.hoverPaintStyle);l&&r.addToList(t.endpointsByElement,this.targetId,l),this.scope||(this.scope=this.endpoints[0].scope),null!=t.deleteEndpointsOnDetach?(this.endpoints[0]._deleteOnDetach=t.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=t.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0)),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||t.connector||o.Defaults.Connector||jsPlumb.Defaults.Connector,!0),t.path&&this.connector.setPath(t.path),this.setPaintStyle(this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||t.paintStyle||o.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,!0),this.setHoverPaintStyle(this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||t.hoverPaintStyle||o.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle,!0),this._jsPlumb.paintStyleInUse=this.getPaintStyle();var u=o.getSuspendedAt();if(o.updateOffset({elId:this.sourceId,timestamp:u}),o.updateOffset({elId:this.targetId,timestamp:u}),!o.isSuspendDrawing()){var c=o.getCachedData(this.sourceId),h=c.o,d=c.s,p=o.getCachedData(this.targetId),m=p.o,f=p.s,g=u||o.timestamp(),b=this.endpoints[0].anchor.compute({xy:[h.left,h.top],wh:d,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[m.left,m.top],twh:f,tElement:this.endpoints[1],timestamp:g});this.endpoints[0].paint({anchorLoc:b,timestamp:g}),b=this.endpoints[1].anchor.compute({xy:[m.left,m.top],wh:f,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[h.left,h.top],twh:d,tElement:this.endpoints[0],timestamp:g}),this.endpoints[1].paint({anchorLoc:b,timestamp:g})}this._jsPlumb.detachable=o.Defaults.ConnectionsDetachable,t.detachable===!1&&(this._jsPlumb.detachable=!1),this.endpoints[0].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1),this.endpoints[1].connectionsDetachable===!1&&(this._jsPlumb.detachable=!1),this._jsPlumb.reattach=t.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||o.Defaults.ReattachConnections,this._jsPlumb.cost=t.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=t.directed,null==t.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var v=jsPlumb.extend({},this.endpoints[1].getParameters());jsPlumb.extend(v,this.endpoints[0].getParameters()),jsPlumb.extend(v,this.getParameters()),this.setParameters(v);var y=t.type||this.endpoints[0].connectionType||this.endpoints[1].connectionType;y&&this.addType(y,t.data,!0)},jsPlumbUtil.extend(jsPlumb.Connection,OverlayCapableJsPlumbUIComponent,{applyType:function(t,n){null!=t.detachable&&this.setDetachable(t.detachable),null!=t.reattach&&this.setReattach(t.reattach),t.scope&&(this.scope=t.scope),this.setConnector(t.connector,n)},getTypeDescriptor:function(){return"connection"},getAttachedElements:function(){return this.endpoints},addClass:function(t,n){n&&(this.endpoints[0].addClass(t),this.endpoints[1].addClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(t)),this.connector&&this.connector.addClass(t)},removeClass:function(t,n){n&&(this.endpoints[0].removeClass(t),this.endpoints[1].removeClass(t),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(t)),this.connector&&this.connector.removeClass(t)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(t){this._jsPlumb.visible=t,this[t?"showOverlays":"hideOverlays"](),this.connector&&this.connector.canvas&&(this.connector.canvas.style.display=t?"block":"none"),this.repaint()},setEditable:function(t){return this.connector&&this.connector.isEditable()&&(this._jsPlumb.editable=t),this._jsPlumb.editable},isEditable:function(){return this._jsPlumb.editable},editStarted:function(){this.setSuspendEvents(!0),this.fire("editStarted",{path:this.connector.getPath()}),this._jsPlumb.instance.setHoverSuspended(!0)},editCompleted:function(){this.fire("editCompleted",{path:this.connector.getPath()}),this.setSuspendEvents(!1),this.setHover(!1),this._jsPlumb.instance.setHoverSuspended(!1)},editCanceled:function(){this.fire("editCanceled",{path:this.connector.getPath()}),this.setHover(!1),this._jsPlumb.instance.setHoverSuspended(!1)},cleanup:function(){this.endpoints=null,this.source=null,this.target=null,null!=this.connector&&(this.connector.cleanup(),this.connector.destroy()),this.connector=null},isDetachable:function(){return this._jsPlumb.detachable===!0},setDetachable:function(t){this._jsPlumb.detachable=t===!0},isReattach:function(){return this._jsPlumb.reattach===!0},setReattach:function(t){this._jsPlumb.reattach=t===!0},setHover:function(t){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(t),jsPlumb.CurrentLibrary[t?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),jsPlumb.CurrentLibrary[t?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getCost:function(){return this._jsPlumb.cost},setCost:function(t){this._jsPlumb.cost=t},isDirected:function(){return this._jsPlumb.directed===!0},moveParent:function(t){var n=jsPlumb.CurrentLibrary;n.getParent(this.connector.canvas);this.connector.bgCanvas&&(n.removeElement(this.connector.bgCanvas),n.appendElement(this.connector.bgCanvas,t)),n.removeElement(this.connector.canvas),n.appendElement(this.connector.canvas,t);for(var e=0;e<this._jsPlumb.overlays.length;e++)this._jsPlumb.overlays[e].isAppendedAtTopLevel&&(n.removeElement(this._jsPlumb.overlays[e].canvas),n.appendElement(this._jsPlumb.overlays[e].canvas,t),this._jsPlumb.overlays[e].reattachListeners&&this._jsPlumb.overlays[e].reattachListeners(this.connector));this.connector.reattachListeners&&this.connector.reattachListeners()},getConnector:function(){return this.connector},setConnector:function(n,e){var s=jsPlumbUtil;null!=this.connector&&(this.connector.cleanup(),this.connector.destroy());var i={_jsPlumb:this._jsPlumb.instance,parent:this._jsPlumb.params.parent,cssClass:this._jsPlumb.params.cssClass,container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"]},r=this._jsPlumb.instance.getRenderMode();s.isString(n)?this.connector=t(this._jsPlumb.instance,r,n,i):s.isArray(n)&&(1==n.length?this.connector=t(this._jsPlumb.instance,r,n[0],i):this.connector=t(this._jsPlumb.instance,r,n[0],s.merge(n[1],i))),this.bindListeners(this.connector,this,function(t){this.setHover(t,!1)}.bind(this)),this.canvas=this.connector.canvas,this._jsPlumb.editable&&null!=jsPlumb.ConnectorEditors&&jsPlumb.ConnectorEditors[this.connector.type]&&this.connector.isEditable()?new jsPlumb.ConnectorEditors[this.connector.type]({connector:this.connector,connection:this,params:this._jsPlumb.params.editorParams||{}}):editable=!1,e||this.repaint()},paint:function(t){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){t=t||{};var n=(t.elId,t.ui),e=t.recalc,s=t.timestamp,i=!1,r=i?this.sourceId:this.targetId,o=i?this.targetId:this.sourceId,a=i?0:1,l=i?1:0;if(null==s||s!=this._jsPlumb.lastPaintedAt){var u=this._jsPlumb.instance.updateOffset({elId:o,offset:n,recalc:e,timestamp:s}).o,c=this._jsPlumb.instance.updateOffset({elId:r,timestamp:s}).o,h=this.endpoints[l],d=this.endpoints[a];t.clearEdits&&(h.anchor.clearUserDefinedLocation(),d.anchor.clearUserDefinedLocation(),this.connector.setEdited(!1));var p=h.anchor.getCurrentLocation({xy:[u.left,u.top],wh:[u.width,u.height],element:h,timestamp:s}),m=d.anchor.getCurrentLocation({xy:[c.left,c.top],wh:[c.width,c.height],element:d,timestamp:s});this.connector.resetBounds(),this.connector.compute({sourcePos:p,targetPos:m,sourceEndpoint:this.endpoints[l],targetEndpoint:this.endpoints[a],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:u,targetInfo:c,clearEdits:t.clearEdits===!0});for(var f={minX:1/0,minY:1/0,maxX:-(1/0),maxY:-(1/0)},g=0;g<this._jsPlumb.overlays.length;g++){var b=this._jsPlumb.overlays[g];b.isVisible()&&(this._jsPlumb.overlayPlacements[g]=b.draw(this.connector,this._jsPlumb.paintStyleInUse),f.minX=Math.min(f.minX,this._jsPlumb.overlayPlacements[g].minX),f.maxX=Math.max(f.maxX,this._jsPlumb.overlayPlacements[g].maxX),f.minY=Math.min(f.minY,this._jsPlumb.overlayPlacements[g].minY),f.maxY=Math.max(f.maxY,this._jsPlumb.overlayPlacements[g].maxY))}var v=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,y=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),P={xmin:Math.min(this.connector.bounds.minX-(v+y),f.minX),ymin:Math.min(this.connector.bounds.minY-(v+y),f.minY),xmax:Math.max(this.connector.bounds.maxX+(v+y),f.maxX),ymax:Math.max(this.connector.bounds.maxY+(v+y),f.maxY)};this.connector.paint(this._jsPlumb.paintStyleInUse,null,P);for(var j=0;j<this._jsPlumb.overlays.length;j++){var x=this._jsPlumb.overlays[j];x.isVisible()&&x.paint(this._jsPlumb.overlayPlacements[j],P)}}this._jsPlumb.lastPaintedAt=s}},repaint:function(t){t=t||{},this.paint({elId:this.sourceId,recalc:!(t.recalc===!1),timestamp:t.timestamp,clearEdits:t.clearEdits})}})}(),function(){jsPlumb.AnchorManager=function(t){var n={},e={},s={},i={},r={},o={HORIZONTAL:"horizontal",VERTICAL:"vertical",DIAGONAL:"diagonal",IDENTITY:"identity"},a={},l=this,u={},c=t.jsPlumbInstance,h=jsPlumb.CurrentLibrary,d={},p=function(t,n,e,s,i,r){if(t===n)return{orientation:o.IDENTITY,a:["top","top"]};var a=Math.atan2(s.centery-e.centery,s.centerx-e.centerx),l=Math.atan2(e.centery-s.centery,e.centerx-s.centerx),u=e.left<=s.left&&e.right>=s.left||e.left<=s.right&&e.right>=s.right||e.left<=s.left&&e.right>=s.right||s.left<=e.left&&s.right>=e.right,c=e.top<=s.top&&e.bottom>=s.top||e.top<=s.bottom&&e.bottom>=s.bottom||e.top<=s.top&&e.bottom>=s.bottom||s.top<=e.top&&s.bottom>=e.bottom,h=function(t){return[i.isContinuous?i.verifyEdge(t[0]):t[0],r.isContinuous?r.verifyEdge(t[1]):t[1]]},d={orientation:o.DIAGONAL,theta:a,theta2:l};return u||c?u?(d.orientation=o.HORIZONTAL,d.a=e.top<s.top?["bottom","top"]:["top","bottom"]):(d.orientation=o.VERTICAL,d.a=e.left<s.left?["right","left"]:["left","right"]):s.left>e.left&&s.top>e.top?d.a=["right","top"]:s.left>e.left&&e.top>s.top?d.a=["top","left"]:s.left<e.left&&s.top<e.top?d.a=["top","right"]:s.left<e.left&&s.top>e.top&&(d.a=["left","top"]),d.a=h(d.a),d},m=function(t,n,e,s,i,r,o){for(var a=[],l=n[i?0:1]/(s.length+1),u=0;u<s.length;u++){var c=(u+1)*l,h=r*n[i?1:0];o&&(c=n[i?0:1]-c);var d=i?c:h,p=e[0]+d,m=d/n[0],f=i?h:c,g=e[1]+f,b=f/n[1];a.push([p,g,m,b,s[u][1],s[u][2]])}return a},f=function(t){return function(n,e){var s=!0;return s=t?n[0][0]<e[0][0]:n[0][0]>e[0][0],s===!1?-1:1}},g=function(t,n){var e=t[0][0]<0?-Math.PI-t[0][0]:Math.PI-t[0][0],s=n[0][0]<0?-Math.PI-n[0][0]:Math.PI-n[0][0];return e>s?1:t[0][1]>n[0][1]?1:-1},b={top:function(t,n){return t[0]>n[0]?1:-1},right:f(!0),bottom:f(!0),left:g},v=function(t,n){return t.sort(n)},y=function(t,n){var e=c.getCachedData(t),i=e.s,o=e.o,a=function(n,e,i,o,a,l,u){if(o.length>0)for(var h=v(o,b[n]),d="right"===n||"top"===n,p=m(n,e,i,h,a,l,d),f=function(t,n){var e=c.adjustForParentOffsetAndScroll([n[0],n[1]],t.canvas);s[t.id]=[e[0],e[1],n[2],n[3]],r[t.id]=u},g=0;g<p.length;g++){var y=p[g][4],P=y.endpoints[0].elementId===t,j=y.endpoints[1].elementId===t;P?f(y.endpoints[0],p[g]):j&&f(y.endpoints[1],p[g])}};a("bottom",i,[o.left,o.top],n.bottom,!0,1,[0,1]),a("top",i,[o.left,o.top],n.top,!0,0,[0,-1]),a("left",i,[o.left,o.top],n.left,!1,0,[-1,0]),a("right",i,[o.left,o.top],n.right,!1,1,[1,0])};this.reset=function(){n={},a={},u={}},this.addFloatingConnection=function(t,n){d[t]=n},this.removeFloatingConnection=function(t){delete d[t]},this.newConnection=function(t){var n=t.sourceId,e=t.targetId,s=t.endpoints,i=!0,r=function(t,r,o,l,u){n==e&&o.isContinuous&&(h.removeElement(s[1].canvas),i=!1),jsPlumbUtil.addToList(a,l,[u,r,o.constructor==jsPlumb.DynamicAnchor])};r(0,s[0],s[0].anchor,e,t),i&&r(1,s[1],s[1].anchor,n,t)};var P=function(t){!function(t,n){if(t){var e=function(t){return t[4]==n};jsPlumbUtil.removeWithFunction(t.top,e),jsPlumbUtil.removeWithFunction(t.left,e),jsPlumbUtil.removeWithFunction(t.bottom,e),jsPlumbUtil.removeWithFunction(t.right,e)}}(u[t.elementId],t.id)};this.connectionDetached=function(t){var n=t.connection||t,e=t.sourceId,s=t.targetId,i=n.endpoints,r=function(t,n,e,s,i){null!=e&&e.constructor==jsPlumb.FloatingAnchor||jsPlumbUtil.removeWithFunction(a[s],function(t){return t[0].id==i.id})};r(1,i[1],i[1].anchor,e,n),r(0,i[0],i[0].anchor,s,n),P(n.endpoints[0]),P(n.endpoints[1]),l.redraw(n.sourceId),l.redraw(n.targetId)},this.add=function(t,e){jsPlumbUtil.addToList(n,e,t)},this.changeId=function(t,e){a[e]=a[t],n[e]=n[t],delete a[t],delete n[t]},this.getConnectionsFor=function(t){return a[t]||[]},this.getEndpointsFor=function(t){return n[t]||[]},this.deleteEndpoint=function(t){jsPlumbUtil.removeWithFunction(n[t.elementId],function(n){return n.id==t.id}),P(t)},this.clearFor=function(t){delete n[t],n[t]=[]};var j=function(n,e,s,i,r,o,a,l,u,c,h,d){var p=-1,m=-1,f=i.endpoints[a],g=f.id,b=[1,0][a],v=[[e,s],i,r,o,g],y=n[u],P=f._continuousAnchorEdge?n[f._continuousAnchorEdge]:null;if(P){var j=jsPlumbUtil.findWithFunction(P,function(t){return t[4]==g});if(-1!=j){P.splice(j,1);for(var x=0;x<P.length;x++)jsPlumbUtil.addWithFunction(h,P[x][1],function(t){return t.id==P[x][1].id}),jsPlumbUtil.addWithFunction(d,P[x][1].endpoints[a],function(t){return t.id==P[x][1].endpoints[a].id}),jsPlumbUtil.addWithFunction(d,P[x][1].endpoints[b],function(t){return t.id==P[x][1].endpoints[b].id})}}for(x=0;x<y.length;x++)1==t.idx&&y[x][3]===o&&-1==m&&(m=x),jsPlumbUtil.addWithFunction(h,y[x][1],function(t){return t.id==y[x][1].id}),jsPlumbUtil.addWithFunction(d,y[x][1].endpoints[a],function(t){return t.id==y[x][1].endpoints[a].id}),jsPlumbUtil.addWithFunction(d,y[x][1].endpoints[b],function(t){return t.id==y[x][1].endpoints[b].id});if(-1!=p)y[p]=v;else{var C=l?-1!=m?m:0:y.length;y.splice(C,0,v)}f._continuousAnchorEdge=u};this.updateOtherEndpoint=function(t,n,e,s){var i=jsPlumbUtil.findWithFunction(a[t],function(t){return t[0].id===s.id}),r=jsPlumbUtil.findWithFunction(a[n],function(t){return t[0].id===s.id});-1!=i&&(a[t][i][0]=s,a[t][i][1]=s.endpoints[1],a[t][i][2]=s.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor),r>-1&&(a[n].splice(r,1),jsPlumbUtil.addToList(a,e,[s,s.endpoints[0],s.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor]))},this.sourceChanged=function(t,n,e){jsPlumbUtil.removeWithFunction(a[t],function(t){return t[0].id===e.id});var s=jsPlumbUtil.findWithFunction(a[e.targetId],function(t){return t[0].id===e.id});s>-1&&(a[e.targetId][s][0]=e,a[e.targetId][s][1]=e.endpoints[0],a[e.targetId][s][2]=e.endpoints[0].anchor.constructor==jsPlumb.DynamicAnchor),jsPlumbUtil.addToList(a,n,[e,e.endpoints[1],e.endpoints[1].anchor.constructor==jsPlumb.DynamicAnchor])},this.rehomeEndpoint=function(t,e,s){var i=n[e]||[],r=c.getId(s);if(r!==e){var o=jsPlumbUtil.indexOf(i,t);if(o>-1){var a=i.splice(o,1)[0];l.add(a,r)}}for(var u=0;u<t.connections.length;u++)t.connections[u].sourceId==e?(t.connections[u].sourceId=t.elementId,t.connections[u].source=t.element,l.sourceChanged(e,t.elementId,t.connections[u])):t.connections[u].targetId==e&&(t.connections[u].targetId=t.elementId,t.connections[u].target=t.element,l.updateOtherEndpoint(t.connections[u].sourceId,e,t.elementId,t.connections[u]))},this.redraw=function(t,e,s,i,r,o){if(!c.isSuspendDrawing()){var l=n[t]||[],h=a[t]||[],m=[],f=[],g=[];s=s||c.timestamp(),i=i||{left:0,top:0},e&&(e={left:e.left+i.left,top:e.top+i.top});for(var b=c.updateOffset({elId:t,offset:e,recalc:!1,timestamp:s}),v={},P=0;P<h.length;P++){var x=h[P][0],C=x.sourceId,E=x.targetId,S=x.endpoints[0].anchor.isContinuous,_=x.endpoints[1].anchor.isContinuous;if(S||_){var D=C+"_"+E,A=v[D],w=x.sourceId==t?1:0;S&&!u[C]&&(u[C]={top:[],right:[],bottom:[],left:[]}),_&&!u[E]&&(u[E]={top:[],right:[],bottom:[],left:[]}),t!=E&&c.updateOffset({elId:E,timestamp:s}),t!=C&&c.updateOffset({elId:C,timestamp:s});var I=c.getCachedData(E),O=c.getCachedData(C);E==C&&(S||_)?j(u[C],-Math.PI/2,0,x,!1,E,0,!1,"top",C,m,f):(A||(A=p(C,E,O.o,I.o,x.endpoints[0].anchor,x.endpoints[1].anchor),v[D]=A),S&&j(u[C],A.theta,0,x,!1,E,0,!1,A.a[0],C,m,f),_&&j(u[E],A.theta2,-1,x,!0,C,1,!0,A.a[1],E,m,f)),S&&jsPlumbUtil.addWithFunction(g,C,function(t){return t===C}),_&&jsPlumbUtil.addWithFunction(g,E,function(t){return t===E}),jsPlumbUtil.addWithFunction(m,x,function(t){return t.id==x.id}),(S&&0===w||_&&1===w)&&jsPlumbUtil.addWithFunction(f,x.endpoints[w],function(t){return t.id==x.endpoints[w].id})}}for(P=0;P<l.length;P++)0===l[P].connections.length&&l[P].anchor.isContinuous&&(u[t]||(u[t]={top:[],right:[],bottom:[],left:[]}),j(u[t],-Math.PI/2,0,{endpoints:[l[P],l[P]],paint:function(){}},!1,t,0,!1,"top",t,m,f),jsPlumbUtil.addWithFunction(g,t,function(n){return n===t}));for(P=0;P<g.length;P++)y(g[P],u[g[P]]);for(P=0;P<l.length;P++)l[P].paint({timestamp:s,offset:b,dimensions:b.s,recalc:o!==!0});for(P=0;P<f.length;P++){var L=c.getCachedData(f[P].elementId);f[P].paint({timestamp:s,offset:L,dimensions:L.s})}for(P=0;P<h.length;P++){var M=h[P][1];if(M.anchor.constructor==jsPlumb.DynamicAnchor){M.paint({elementWithPrecedence:t,timestamp:s}),jsPlumbUtil.addWithFunction(m,h[P][0],function(t){return t.id==h[P][0].id});for(var U=0;U<M.connections.length;U++)M.connections[U]!==h[P][0]&&jsPlumbUtil.addWithFunction(m,M.connections[U],function(t){return t.id==M.connections[U].id})}else M.anchor.constructor==jsPlumb.Anchor&&jsPlumbUtil.addWithFunction(m,h[P][0],function(t){return t.id==h[P][0].id})}var T=d[t];for(T&&T.paint({timestamp:s,recalc:!1,elId:t}),P=0;P<m.length;P++)m[P].paint({elId:t,timestamp:s,recalc:!1,clearEdits:r
})}};var x=function(t){jsPlumbUtil.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var n=t.faces||["top","right","bottom","left"],e=!(t.clockwise===!1),o={},a={top:"bottom",right:"left",left:"right",bottom:"top"},l={top:"right",right:"bottom",left:"top",bottom:"left"},u={top:"left",right:"top",left:"bottom",bottom:"right"},c=e?l:u,h=e?u:l,d=t.cssClass||"",p=0;p<n.length;p++)o[n[p]]=!0;this.verifyEdge=function(t){return o[t]?t:o[a[t]]?a[t]:o[c[t]]?c[t]:o[h[t]]?h[t]:t},this.compute=function(t){return i[t.element.id]||s[t.element.id]||[0,0]},this.getCurrentLocation=function(t){return i[t.element.id]||s[t.element.id]||[0,0]},this.getOrientation=function(t){return r[t.id]||[0,0]},this.clearUserDefinedLocation=function(){delete i[t.elementId]},this.setUserDefinedLocation=function(n){i[t.elementId]=n},this.getCssClass=function(){return d},this.setCssClass=function(t){d=t}};c.continuousAnchorFactory={get:function(t){var n=e[t.elementId];return n||(n=new x(t),e[t.elementId]=n),n},clear:function(t){delete e[t]}}},jsPlumb.Anchor=function(t){this.x=t.x||0,this.y=t.y||0,this.elementId=t.elementId,this.cssClass=t.cssClass||"",this.userDefinedLocation=null,this.orientation=t.orientation||[0,0],jsPlumbUtil.EventGenerator.apply(this);var n=t.jsPlumbInstance;this.lastReturnValue=null,this.offsets=t.offsets||[0,0],this.timestamp=null,this.compute=function(t){var e=t.xy,s=t.wh,i=t.element,r=t.timestamp;return t.clearUserDefinedLocation&&(this.userDefinedLocation=null),r&&r===self.timestamp?this.lastReturnValue:(null!=this.userDefinedLocation?this.lastReturnValue=this.userDefinedLocation:(this.lastReturnValue=[e[0]+this.x*s[0]+this.offsets[0],e[1]+this.y*s[1]+this.offsets[1]],this.lastReturnValue=n.adjustForParentOffsetAndScroll(this.lastReturnValue,i.canvas)),this.timestamp=r,this.lastReturnValue)},this.getCurrentLocation=function(t){return null==this.lastReturnValue||null!=t.timestamp&&this.timestamp!=t.timestamp?this.compute(t):this.lastReturnValue}},jsPlumbUtil.extend(jsPlumb.Anchor,jsPlumbUtil.EventGenerator,{equals:function(t){if(!t)return!1;var n=t.getOrientation(),e=this.getOrientation();return this.x==t.x&&this.y==t.y&&this.offsets[0]==t.offsets[0]&&this.offsets[1]==t.offsets[1]&&e[0]==n[0]&&e[1]==n[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(t){this.userDefinedLocation=t},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(t){return this.orientation},getCssClass:function(){return this.cssClass}}),jsPlumb.FloatingAnchor=function(t){jsPlumb.Anchor.apply(this,arguments);var n=t.reference,e=jsPlumb.CurrentLibrary,s=t.jsPlumbInstance,i=t.referenceCanvas,r=e.getSize(e.getElementObject(i)),o=0,a=0,l=null,u=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(t){var n=t.xy,e=t.element,i=[n[0]+r[0]/2,n[1]+r[1]/2];return i=s.adjustForParentOffsetAndScroll(i,e.canvas),u=i,i},this.getOrientation=function(t){if(l)return l;var e=n.getOrientation(t);return[Math.abs(e[0])*o*-1,Math.abs(e[1])*a*-1]},this.over=function(t,n){l=t.getOrientation(n)},this.out=function(){l=null},this.getCurrentLocation=function(t){return null==u?this.compute(t):u}},jsPlumbUtil.extend(jsPlumb.FloatingAnchor,jsPlumb.Anchor);var t=function(t,n,e){return t.constructor==jsPlumb.Anchor?t:n.makeAnchor(t,e,n)};jsPlumb.DynamicAnchor=function(n){jsPlumb.Anchor.apply(this,arguments),this.isSelective=!0,this.isDynamic=!0,this.anchors=[],this.elementId=n.elementId,this.jsPlumbInstance=n.jsPlumbInstance;for(var e=0;e<n.anchors.length;e++)this.anchors[e]=t(n.anchors[e],this.jsPlumbInstance,this.elementId);this.addAnchor=function(n){this.anchors.push(t(n,this.jsPlumbInstance,this.elementId))},this.getAnchors=function(){return this.anchors},this.locked=!1;var s=this.anchors.length>0?this.anchors[0]:null,i=(this.anchors.length>0?0:-1,s),r=this,o=function(t,n,e,s,i){var r=s[0]+t.x*i[0],o=s[1]+t.y*i[1],a=s[0]+i[0]/2,l=s[1]+i[1]/2;return Math.sqrt(Math.pow(n-r,2)+Math.pow(e-o,2))+Math.sqrt(Math.pow(a-r,2)+Math.pow(l-o,2))},a=n.selector||function(t,n,e,s,i){for(var r=e[0]+s[0]/2,a=e[1]+s[1]/2,l=-1,u=1/0,c=0;c<i.length;c++){var h=o(i[c],r,a,t,n);u>h&&(l=c+0,u=h)}return i[l]};this.compute=function(t){var n=t.xy,e=t.wh,o=t.timestamp,l=t.txy,u=t.twh;t.clearUserDefinedLocation&&(userDefinedLocation=null),this.timestamp=o;var c=r.getUserDefinedLocation();return null!=c?c:this.locked||null==l||null==u?s.compute(t):(t.timestamp=null,s=a(n,e,l,u,this.anchors),this.x=s.x,this.y=s.y,s!=i&&this.fire("anchorChanged",s),i=s,s.compute(t))},this.getCurrentLocation=function(t){return this.getUserDefinedLocation()||(null!=s?s.getCurrentLocation(t):null)},this.getOrientation=function(t){return null!=s?s.getOrientation(t):[0,0]},this.over=function(t,n){null!=s&&s.over(t,n)},this.out=function(){null!=s&&s.out()},this.getCssClass=function(){return s&&s.getCssClass()||""}},jsPlumbUtil.extend(jsPlumb.DynamicAnchor,jsPlumb.Anchor);var n=function(t,n,e,s,i,r){jsPlumb.Anchors[i]=function(o){var a=o.jsPlumbInstance.makeAnchor([t,n,e,s,0,0],o.elementId,o.jsPlumbInstance);return a.type=i,r&&r(a,o),a}};n(.5,0,0,-1,"TopCenter"),n(.5,1,0,1,"BottomCenter"),n(0,.5,-1,0,"LeftMiddle"),n(1,.5,1,0,"RightMiddle"),n(.5,0,0,-1,"Top"),n(.5,1,0,1,"Bottom"),n(0,.5,-1,0,"Left"),n(1,.5,1,0,"Right"),n(.5,.5,0,0,"Center"),n(1,0,0,-1,"TopRight"),n(1,1,0,1,"BottomRight"),n(0,0,0,-1,"TopLeft"),n(0,1,0,1,"BottomLeft"),jsPlumb.Defaults.DynamicAnchors=function(t){return t.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],t.elementId,t.jsPlumbInstance)},jsPlumb.Anchors.AutoDefault=function(t){var n=t.jsPlumbInstance.makeDynamicAnchor(jsPlumb.Defaults.DynamicAnchors(t));return n.type="AutoDefault",n};var e=function(t,n){jsPlumb.Anchors[t]=function(e){var s=e.jsPlumbInstance.makeAnchor(["Continuous",{faces:n}],e.elementId,e.jsPlumbInstance);return s.type=t,s}};jsPlumb.Anchors.Continuous=function(t){return t.jsPlumbInstance.continuousAnchorFactory.get(t)},e("ContinuousLeft",["left"]),e("ContinuousTop",["top"]),e("ContinuousBottom",["bottom"]),e("ContinuousRight",["right"]),jsPlumb.Anchors.Assign=n(0,0,0,0,"Assign",function(t,n){var e=n.position||"Fixed";t.positionFinder=e.constructor==String?n.jsPlumbInstance.AnchorPositionFinders[e]:e,t.constructorParams=n}),jsPlumb.AnchorPositionFinders={Fixed:function(t,n,e,s){return[(t.left-n.left)/e[0],(t.top-n.top)/e[1]]},Grid:function(t,n,e,s){var i=t.left-n.left,r=t.top-n.top,o=e[0]/s.grid[0],a=e[1]/s.grid[1],l=Math.floor(i/o),u=Math.floor(r/a);return[(l*o+o/2)/e[0],(u*a+a/2)/e[1]]}},jsPlumb.Anchors.Perimeter=function(t){t=t||{};var n=t.anchorCount||60,e=t.shape;if(!e)throw new Error("no shape supplied to Perimeter Anchor type");var s=function(){for(var t=.5,e=2*Math.PI/n,s=0,i=[],r=0;n>r;r++){var o=t+t*Math.sin(s),a=t+t*Math.cos(s);i.push([o,a,0,0]),s+=e}return i},i=function(t){for(var e=n/t.length,s=[],i=function(t,i,r,o,a){e=n*a;for(var l=(r-t)/e,u=(o-i)/e,c=0;e>c;c++)s.push([t+l*c,i+u*c,0,0])},r=0;r<t.length;r++)i.apply(null,t[r]);return s},r=function(t){for(var n=[],e=0;e<t.length;e++)n.push([t[e][0],t[e][1],t[e][2],t[e][3],1/t.length]);return i(n)},o=function(){return r([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},a={Circle:s,Ellipse:s,Diamond:function(){return r([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:o,Square:o,Triangle:function(){return r([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(t){for(var n=t.points,e=[],s=0,r=0;r<n.length-1;r++){var o=Math.sqrt(Math.pow(n[r][2]-n[r][0])+Math.pow(n[r][3]-n[r][1]));s+=o,e.push([n[r][0],n[r][1],n[r+1][0],n[r+1][1],o])}for(var a=0;a<e.length;a++)e[a][4]=e[a][4]/s;return i(e)}},l=function(t,n){for(var e=[],s=n/180*Math.PI,i=0;i<t.length;i++){var r=t[i][0]-.5,o=t[i][1]-.5;e.push([.5+(r*Math.cos(s)-o*Math.sin(s)),.5+(r*Math.sin(s)+o*Math.cos(s)),t[i][2],t[i][3]])}return e};if(!a[e])throw new Error("Shape ["+e+"] is unknown by Perimeter Anchor type");var u=a[e](t);t.rotation&&(u=l(u,t.rotation));var c=t.jsPlumbInstance.makeDynamicAnchor(u);return c.type="Perimeter",c}}(),function(){jsPlumb.DOMElementComponent=jsPlumbUtil.extend(jsPlumb.jsPlumbUIComponent,function(t){this.mousemove=this.dblclick=this.click=this.mousedown=this.mouseup=function(t){}}),jsPlumb.Segments={AbstractSegment:function(t){this.params=t,this.findClosestPointOnPath=function(t,n){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(t.x1,t.x2),minY:Math.min(t.y1,t.y2),maxX:Math.max(t.x1,t.x2),maxY:Math.max(t.y1,t.y2)}}},Straight:function(t){var n,e,s,i,r,o,a,l=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),function(){n=Math.sqrt(Math.pow(r-i,2)+Math.pow(a-o,2)),e=jsPlumbUtil.gradient({x:i,y:o},{x:r,y:a}),s=-1/e});this.type="Straight",this.getLength=function(){return n},this.getGradient=function(){return e},this.getCoordinates=function(){return{x1:i,y1:o,x2:r,y2:a}},this.setCoordinates=function(t){i=t.x1,o=t.y1,r=t.x2,a=t.y2,l()},this.setCoordinates({x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),this.getBounds=function(){return{minX:Math.min(i,r),minY:Math.min(o,a),maxX:Math.max(i,r),maxY:Math.max(o,a)}},this.pointOnPath=function(t,e){if(0!==t||e){if(1!=t||e){var s=e?t>0?t:n+t:t*n;return jsPlumbUtil.pointOnLine({x:i,y:o},{x:r,y:a},s)}return{x:r,y:a}}return{x:i,y:o}},this.gradientAtPoint=function(t){return e},this.pointAlongPathFrom=function(t,n,e){var s=this.pointOnPath(t,e),l=0>=n?{x:i,y:o}:{x:r,y:a};return 0>=n&&Math.abs(n)>1&&(n*=-1),jsPlumbUtil.pointOnLine(s,l,n)},this.findClosestPointOnPath=function(t,r){if(0===e)return{x:t,y:o,d:Math.abs(r-o)};if(e==1/0||e==-(1/0))return{x:i,y:r,d:Math.abs(t-1)};var a=o-e*i,l=r-s*t,u=(l-a)/(e-s),c=e*u+a,h=jsPlumbUtil.lineLength([t,r],[u,c]),d=jsPlumbUtil.lineLength([u,c],[i,o]);return{d:h,x:u,y:c,l:d/n}}},Arc:function(t){var n=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),function(n,e){return jsPlumbUtil.theta([t.cx,t.cy],[n,e])}),e=function(t,n){if(t.anticlockwise){var e=t.startAngle<t.endAngle?t.startAngle+s:t.startAngle,i=Math.abs(e-t.endAngle);return e-i*n}var r=t.endAngle<t.startAngle?t.endAngle+s:t.endAngle,o=Math.abs(r-t.startAngle);return t.startAngle+o*n},s=2*Math.PI;this.radius=t.r,this.anticlockwise=t.ac,this.type="Arc",t.startAngle&&t.endAngle?(this.startAngle=t.startAngle,this.endAngle=t.endAngle,this.x1=t.cx+this.radius*Math.cos(t.startAngle),this.y1=t.cy+this.radius*Math.sin(t.startAngle),this.x2=t.cx+this.radius*Math.cos(t.endAngle),this.y2=t.cy+this.radius*Math.sin(t.endAngle)):(this.startAngle=n(t.x1,t.y1),this.endAngle=n(t.x2,t.y2),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2),this.endAngle<0&&(this.endAngle+=s),this.startAngle<0&&(this.startAngle+=s),this.segment=jsPlumbUtil.segment([this.x1,this.y1],[this.x2,this.y2]);var i=this.endAngle<this.startAngle?this.endAngle+s:this.endAngle;this.sweep=Math.abs(i-this.startAngle),this.anticlockwise&&(this.sweep=s-this.sweep);var r=2*Math.PI*this.radius,o=this.sweep/s,a=r*o;this.getLength=function(){return a},this.getBounds=function(){return{minX:t.cx-t.r,maxX:t.cx+t.r,minY:t.cy-t.r,maxY:t.cy+t.r}};var l=1e-10,u=function(t){var n=Math.floor(t),e=Math.ceil(t);return l>t-n?n:l>e-t?e:t};this.pointOnPath=function(n,s){if(0===n)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1==n)return{x:this.x2,y:this.y2,theta:this.endAngle};s&&(n/=a);var i=e(this,n),r=t.cx+t.r*Math.cos(i),o=t.cy+t.r*Math.sin(i);return{x:u(r),y:u(o),theta:i}},this.gradientAtPoint=function(n,e){var s=this.pointOnPath(n,e),i=jsPlumbUtil.normal([t.cx,t.cy],[s.x,s.y]);return this.anticlockwise||i!=1/0&&i!=-(1/0)||(i*=-1),i},this.pointAlongPathFrom=function(n,e,s){var i=this.pointOnPath(n,s),o=e/r*2*Math.PI,a=this.anticlockwise?-1:1,l=i.theta+a*o,u=t.cx+this.radius*Math.cos(l),c=t.cy+this.radius*Math.sin(l);return{x:u,y:c}}},Bezier:function(t){var n=(jsPlumb.Segments.AbstractSegment.apply(this,arguments),[{x:t.x1,y:t.y1},{x:t.cp1x,y:t.cp1y},{x:t.cp2x,y:t.cp2y},{x:t.x2,y:t.y2}]),e={minX:Math.min(t.x1,t.x2,t.cp1x,t.cp2x),minY:Math.min(t.y1,t.y2,t.cp1y,t.cp2y),maxX:Math.max(t.x1,t.x2,t.cp1x,t.cp2x),maxY:Math.max(t.y1,t.y2,t.cp1y,t.cp2y)};this.type="Bezier";var s=function(t,n,e){return e&&(n=jsBezier.locationAlongCurveFrom(t,n>0?0:1,n)),n};this.pointOnPath=function(t,e){return t=s(n,t,e),jsBezier.pointOnCurve(n,t)},this.gradientAtPoint=function(t,e){return t=s(n,t,e),jsBezier.gradientAtPoint(n,t)},this.pointAlongPathFrom=function(t,e,i){return t=s(n,t,i),jsBezier.pointAlongCurveFrom(n,t,e)},this.getLength=function(){return jsBezier.getLength(n)},this.getBounds=function(){return e}}};var t=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-(1/0),maxY:-(1/0)}},this.resetBounds()};jsPlumb.Connectors.AbstractConnector=function(n){t.apply(this,arguments);var e=[],s=0,i=[],r=[],o=n.stub||0,a=jsPlumbUtil.isArray(o)?o[0]:o,l=jsPlumbUtil.isArray(o)?o[1]:o,u=n.gap||0,c=jsPlumbUtil.isArray(u)?u[0]:u,h=jsPlumbUtil.isArray(u)?u[1]:u,d=null,p=!1,m=null;this.isEditable=function(){return!1},this.setEdited=function(t){p=t},this.getPath=function(){},this.setPath=function(t){},this.findSegmentForPoint=function(t,n){for(var s={d:1/0,s:null,x:null,y:null,l:null},i=0;i<e.length;i++){var r=e[i].findClosestPointOnPath(t,n);r.d<s.d&&(s.d=r.d,s.l=r.l,s.x=r.x,s.y=r.y,s.s=e[i])}return s};var f=function(){for(var t=0,n=0;n<e.length;n++){var o=e[n].getLength();r[n]=o/s,i[n]=[t,t+=o/s]}},g=function(t,n){n&&(t=t>0?t/s:(s+t)/s);for(var o=i.length-1,a=1,l=0;l<i.length;l++)if(i[l][1]>=t){o=l,a=1==t?1:0===t?0:(t-i[l][0])/r[l];break}return{segment:e[o],proportion:a,index:o}},b=function(t,n,i){if(i.x1!=i.x2||i.y1!=i.y2){var r=new jsPlumb.Segments[n](i);e.push(r),s+=r.getLength(),t.updateBounds(r)}},v=function(){s=0,e.splice(0,e.length),i.splice(0,i.length),r.splice(0,r.length)};this.setSegments=function(t){d=[],s=0;for(var n=0;n<t.length;n++)d.push(t[n]),s+=t[n].getLength()};var y=function(t){this.lineWidth=t.lineWidth;var n=jsPlumbUtil.segment(t.sourcePos,t.targetPos),e=t.targetPos[0]<t.sourcePos[0],s=t.targetPos[1]<t.sourcePos[1],i=t.lineWidth||1,r=t.sourceEndpoint.anchor.orientation||t.sourceEndpoint.anchor.getOrientation(t.sourceEndpoint),o=t.targetEndpoint.anchor.orientation||t.targetEndpoint.anchor.getOrientation(t.targetEndpoint),u=e?t.targetPos[0]:t.sourcePos[0],d=s?t.targetPos[1]:t.sourcePos[1],p=Math.abs(t.targetPos[0]-t.sourcePos[0]),m=Math.abs(t.targetPos[1]-t.sourcePos[1]);if(0===r[0]&&0===r[1]||0===o[0]&&0===o[1]){var f=p>m?0:1,g=[1,0][f];r=[],o=[],r[f]=t.sourcePos[f]>t.targetPos[f]?-1:1,o[f]=t.sourcePos[f]>t.targetPos[f]?1:-1,r[g]=0,o[g]=0}var b=e?p+c*r[0]:c*r[0],v=s?m+c*r[1]:c*r[1],y=e?h*o[0]:p+h*o[0],P=s?h*o[1]:m+h*o[1],j=r[0]*o[0]+r[1]*o[1],x={sx:b,sy:v,tx:y,ty:P,lw:i,xSpan:Math.abs(y-b),ySpan:Math.abs(P-v),mx:(b+y)/2,my:(v+P)/2,so:r,to:o,x:u,y:d,w:p,h:m,segment:n,startStubX:b+r[0]*a,startStubY:v+r[1]*a,endStubX:y+o[0]*l,endStubY:P+o[1]*l,isXGreaterThanStubTimes2:Math.abs(b-y)>a+l,isYGreaterThanStubTimes2:Math.abs(v-P)>a+l,opposite:-1==j,perpendicular:0===j,orthogonal:1==j,sourceAxis:0===r[0]?"y":"x",points:[u,d,p,m,b,v,y,P]};return x.anchorOrientation=x.opposite?"opposite":x.orthogonal?"orthogonal":"perpendicular",x};this.getSegments=function(){return e},this.updateBounds=function(t){var n=t.getBounds();this.bounds.minX=Math.min(this.bounds.minX,n.minX),this.bounds.maxX=Math.max(this.bounds.maxX,n.maxX),this.bounds.minY=Math.min(this.bounds.minY,n.minY),this.bounds.maxY=Math.max(this.bounds.maxY,n.maxY)};return this.pointOnPath=function(t,n){var e=g(t,n);return e.segment&&e.segment.pointOnPath(e.proportion,n)||[0,0]},this.gradientAtPoint=function(t){var n=g(t,absolute);return n.segment&&n.segment.gradientAtPoint(n.proportion,absolute)||0},this.pointAlongPathFrom=function(t,n,e){var s=g(t,e);return s.segment&&s.segment.pointAlongPathFrom(s.proportion,n,!1)||[0,0]},this.compute=function(t){p||(m=y(t)),v(),this._compute(m,t),this.x=m.points[0],this.y=m.points[1],this.w=m.points[2],this.h=m.points[3],this.segment=m.segment,f()},{addSegment:b,prepareCompute:y,sourceStub:a,targetStub:l,maxStub:Math.max(a,l),sourceGap:c,targetGap:h,maxGap:Math.max(c,h)}},jsPlumbUtil.extend(jsPlumb.Connectors.AbstractConnector,t);var n=function(){this.type="Straight";var t=jsPlumb.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(n,e){t.addSegment(this,"Straight",{x1:n.sx,y1:n.sy,x2:n.startStubX,y2:n.startStubY}),t.addSegment(this,"Straight",{x1:n.startStubX,y1:n.startStubY,x2:n.endStubX,y2:n.endStubY}),t.addSegment(this,"Straight",{x1:n.endStubX,y1:n.endStubY,x2:n.tx,y2:n.ty})}};jsPlumbUtil.extend(jsPlumb.Connectors.Straight,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(n,"Straight");var e=function(t){t=t||{};var n=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),e=(t.stub||50,t.curviness||150),s=10;this.type="Bezier",this.getCurviness=function(){return e},this._findControlPoint=function(t,n,i,r,o){var a=r.anchor.getOrientation(r),l=o.anchor.getOrientation(o),u=a[0]!=l[0]||a[1]==l[1],c=[];return u?(0===l[0]?c.push(i[0]<n[0]?t[0]+s:t[0]-s):c.push(t[0]+e*l[0]),0===l[1]?c.push(i[1]<n[1]?t[1]+s:t[1]-s):c.push(t[1]+e*a[1])):(0===a[0]?c.push(n[0]<i[0]?t[0]+s:t[0]-s):c.push(t[0]-e*a[0]),0===a[1]?c.push(n[1]<i[1]?t[1]+s:t[1]-s):c.push(t[1]+e*l[1])),c},this._compute=function(t,e){var s=e.sourcePos,i=e.targetPos,r=Math.abs(s[0]-i[0]),o=Math.abs(s[1]-i[1]),a=s[0]<i[0]?r:0,l=s[1]<i[1]?o:0,u=s[0]<i[0]?0:r,c=s[1]<i[1]?0:o,h=this._findControlPoint([a,l],s,i,e.sourceEndpoint,e.targetEndpoint),d=this._findControlPoint([u,c],i,s,e.targetEndpoint,e.sourceEndpoint);n.addSegment(this,"Bezier",{x1:a,y1:l,x2:u,y2:c,cp1x:h[0],cp1y:h[1],cp2x:d[0],cp2y:d[1]})}};jsPlumbUtil.extend(e,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(e,"Bezier"),jsPlumb.Endpoints.AbstractEndpoint=function(n){t.apply(this,arguments);var e=this.compute=function(t,n,e,s){var i=this._compute.apply(this,arguments);return this.x=i[0],this.y=i[1],this.w=i[2],this.h=i[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,i};return{compute:e,cssClass:n.cssClass}},jsPlumbUtil.extend(jsPlumb.Endpoints.AbstractEndpoint,t),jsPlumb.Endpoints.Dot=function(t){this.type="Dot";jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{},this.radius=t.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(t,n,e,s){this.radius=e.radius||this.radius;var i=t[0]-this.radius,r=t[1]-this.radius,o=2*this.radius,a=2*this.radius;if(e.strokeStyle){var l=e.lineWidth||1;i-=l,r-=l,o+=2*l,a+=2*l}return[i,r,o,a,this.radius]}},jsPlumbUtil.extend(jsPlumb.Endpoints.Dot,jsPlumb.Endpoints.AbstractEndpoint),jsPlumb.Endpoints.Rectangle=function(t){this.type="Rectangle";jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{},this.width=t.width||20,this.height=t.height||20,this._compute=function(t,n,e,s){var i=e.width||this.width,r=e.height||this.height,o=t[0]-i/2,a=t[1]-r/2;return[o,a,i,r]}},jsPlumbUtil.extend(jsPlumb.Endpoints.Rectangle,jsPlumb.Endpoints.AbstractEndpoint);var s=function(t){jsPlumb.DOMElementComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};jsPlumbUtil.extend(s,jsPlumb.DOMElementComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(t){this._jsPlumb.displayElements.push(t)}}),jsPlumb.Endpoints.Image=function(t){this.type="Image",s.apply(this,arguments),jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);var n=t.onload,e=t.src||t.url,i=t.parent,r=t.cssClass?" "+t.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=t.width,this._jsPlumb.heightToUse=t.height,this._jsPlumb.endpoint=t.endpoint,this._jsPlumb.img.onload=function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,n&&n(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(t,e){var s=t.constructor==String?t:t.src;n=e,this._jsPlumb.img.src=s,null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(e,n),this._compute=function(t,n,e,s){return this.anchorPoint=t,this._jsPlumb.ready?[t[0]-this._jsPlumb.widthToUse/2,t[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=document.createElement("img"),this.canvas.style.margin=0,this.canvas.style.padding=0,this.canvas.style.outline=0,this.canvas.style.position="absolute",this.canvas.className=this._jsPlumb.instance.endpointClass+r,this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas,i),this.attachListeners(this.canvas,this),this.actuallyPaint=function(t,n,e){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var s=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,i=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;jsPlumbUtil.sizeElement(this.canvas,s,i,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(t,n){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(t,n):window.setTimeout(function(){this.paint(t,n)}.bind(this),200))}},jsPlumbUtil.extend(jsPlumb.Endpoints.Image,[s,jsPlumb.Endpoints.AbstractEndpoint],{cleanup:function(){this._jsPlumb.deleted=!0,jsPlumbUtil.removeElement(this.canvas),this.canvas=null}}),jsPlumb.Endpoints.Blank=function(t){jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);this.type="Blank",s.apply(this,arguments),this._compute=function(t,n,e,s){return[t[0],t[1],10,0]},this.canvas=document.createElement("div"),this.canvas.style.display="block",this.canvas.style.width="1px",this.canvas.style.height="1px",this.canvas.style.background="transparent",this.canvas.style.position="absolute",this.canvas.className=this._jsPlumb.endpointClass,jsPlumb.appendElement(this.canvas,t.parent),this.paint=function(t,n){jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},jsPlumbUtil.extend(jsPlumb.Endpoints.Blank,[jsPlumb.Endpoints.AbstractEndpoint,s],{cleanup:function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)}}),jsPlumb.Endpoints.Triangle=function(t){this.type="Triangle";jsPlumb.Endpoints.AbstractEndpoint.apply(this,arguments);t=t||{},t.width=t.width||55,t.height=t.height||55,this.width=t.width,this.height=t.height,this._compute=function(t,n,e,s){var i=e.width||self.width,r=e.height||self.height,o=t[0]-i/2,a=t[1]-r/2;return[o,a,i,r]}};var i=jsPlumb.Overlays.AbstractOverlay=function(t){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=t.component,this.loc=null==t.location?.5:t.location,this.endpointLoc=null==t.endpointLocation?[.5,.5]:t.endpointLocation};i.prototype={cleanup:function(){this.component=null,this.canvas=null,this.endpointLoc=null},setVisible:function(t){this.visible=t,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(t){this.loc+=t,this.component.repaint()},setLocation:function(t){this.loc=t,this.component.repaint()},getLocation:function(){return this.loc}},jsPlumb.Overlays.Arrow=function(t){this.type="Arrow",i.apply(this,arguments),this.isAppendedAtTopLevel=!1,t=t||{};var n=jsPlumbUtil;this.length=t.length||20,this.width=t.width||20,this.id=t.id;var e=(t.direction||1)<0?-1:1,s=t.paintStyle||{lineWidth:1},r=t.foldback||.623;this.computeMaxSize=function(){return 1.5*self.width},this.draw=function(t,i){var o,a,l,u,c;if(t.pointAlongPathFrom){if(n.isString(this.loc)||this.loc>1||this.loc<0){var h=parseInt(this.loc,10);o=t.pointAlongPathFrom(h,e*this.length/2,!0),a=t.pointOnPath(h,!0),l=n.pointOnLine(o,a,this.length)}else if(1==this.loc){if(o=t.pointOnPath(this.loc),a=t.pointAlongPathFrom(this.loc,-this.length),l=n.pointOnLine(o,a,this.length),-1==e){var d=l;l=o,o=d}}else if(0===this.loc){if(l=t.pointOnPath(this.loc),a=t.pointAlongPathFrom(this.loc,this.length),o=n.pointOnLine(l,a,this.length),-1==e){var p=l;l=o,o=p}}else o=t.pointAlongPathFrom(this.loc,e*this.length/2),a=t.pointOnPath(this.loc),l=n.pointOnLine(o,a,this.length);u=n.perpendicularLineTo(o,l,this.width),c=n.pointOnLine(o,l,r*this.length);var m={hxy:o,tail:u,cxy:c},f=s.strokeStyle||i.strokeStyle,g=s.fillStyle||i.strokeStyle,b=s.lineWidth||i.lineWidth,v={component:t,d:m,lineWidth:b,strokeStyle:f,fillStyle:g,minX:Math.min(o.x,u[0].x,u[1].x),maxX:Math.max(o.x,u[0].x,u[1].x),minY:Math.min(o.y,u[0].y,u[1].y),maxY:Math.max(o.y,u[0].y,u[1].y)};return v}return{component:t,minX:0,maxX:0,minY:0,maxY:0}}},jsPlumbUtil.extend(jsPlumb.Overlays.Arrow,i),jsPlumb.Overlays.PlainArrow=function(t){t=t||{};var n=jsPlumb.extend(t,{foldback:1});jsPlumb.Overlays.Arrow.call(this,n),this.type="PlainArrow"},jsPlumbUtil.extend(jsPlumb.Overlays.PlainArrow,jsPlumb.Overlays.Arrow),jsPlumb.Overlays.Diamond=function(t){t=t||{};var n=t.length||40,e=jsPlumb.extend(t,{length:n/2,foldback:2});jsPlumb.Overlays.Arrow.call(this,e),this.type="Diamond"},jsPlumbUtil.extend(jsPlumb.Overlays.Diamond,jsPlumb.Overlays.Arrow);var r=function(t){return null==t._jsPlumb.cachedDimensions&&(t._jsPlumb.cachedDimensions=t.getDimensions()),t._jsPlumb.cachedDimensions},o=function(t){jsPlumb.DOMElementComponent.apply(this,arguments),i.apply(this,arguments);var n=jsPlumb.CurrentLibrary;this.id=t.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=t.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=t.create,this.getElement=function(){if(null==this._jsPlumb.div){var e=this._jsPlumb.div=n.getDOMElement(this._jsPlumb.create(this._jsPlumb.component));e.style.position="absolute";var s=t._jsPlumb.overlayClass+" "+(this.cssClass?this.cssClass:t.cssClass?t.cssClass:"");e.className=s,this._jsPlumb.instance.appendElement(e,this._jsPlumb.component.parent),this._jsPlumb.instance.getId(e),this.attachListeners(e,this),this.canvas=e}return this._jsPlumb.div},this.draw=function(t,n){var e=r(this);if(null!=e&&2==e.length){var s={x:0,y:0};if(t.pointOnPath){var i=this.loc,o=!1;(jsPlumbUtil.isString(this.loc)||this.loc<0||this.loc>1)&&(i=parseInt(this.loc,10),o=!0),s=t.pointOnPath(i,o)}else{var a=this.loc.constructor==Array?this.loc:this.endpointLoc;s={x:a[0]*t.w,y:a[1]*t.h}}var l=s.x-e[0]/2,u=s.y-e[1]/2;return{component:t,d:{minx:l,miny:u,td:e,cxy:s},minX:l,maxX:l+e[0],minY:u,maxY:u+e[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};jsPlumbUtil.extend(o,[jsPlumb.DOMElementComponent,i],{getDimensions:function(){return jsPlumb.CurrentLibrary.getSize(jsPlumb.CurrentLibrary.getElementObject(this.getElement()))},setVisible:function(t){this._jsPlumb.div.style.display=t?"block":"none"},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(){null!=this._jsPlumb.div&&jsPlumb.CurrentLibrary.removeElement(this._jsPlumb.div)},computeMaxSize:function(){var t=r(this);return Math.max(t[0],t[1])},reattachListeners:function(t){this._jsPlumb.div&&this.reattachListenersForElement(this._jsPlumb.div,this,t)},paint:function(t,n){this._jsPlumb.initialised||(this.getElement(),t.component.appendDisplayElement(this._jsPlumb.div),this.attachListeners(this._jsPlumb.div,t.component),this._jsPlumb.initialised=!0),this._jsPlumb.div.style.left=t.component.x+t.d.minx+"px",this._jsPlumb.div.style.top=t.component.y+t.d.miny+"px"}}),jsPlumb.Overlays.Custom=function(t){this.type="Custom",o.apply(this,arguments)},jsPlumbUtil.extend(jsPlumb.Overlays.Custom,o),jsPlumb.Overlays.GuideLines=function(){var t=this;t.length=50,t.lineWidth=5,this.type="GuideLines",i.apply(this,arguments),jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.draw=function(n,e){var s=n.pointAlongPathFrom(t.loc,t.length/2),i=n.pointOnPath(t.loc),r=jsPlumbUtil.pointOnLine(s,i,t.length),o=jsPlumbUtil.perpendicularLineTo(s,r,40),a=jsPlumbUtil.perpendicularLineTo(r,s,20);return{connector:n,head:s,tail:r,headLine:a,tailLine:o,minX:Math.min(s.x,r.x,a[0].x,a[1].x),minY:Math.min(s.y,r.y,a[0].y,a[1].y),maxX:Math.max(s.x,r.x,a[0].x,a[1].x),maxY:Math.max(s.y,r.y,a[0].y,a[1].y)}}},jsPlumb.Overlays.Label=function(t){this.labelStyle=t.labelStyle||jsPlumb.Defaults.LabelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;var n=jsPlumb.extend({create:function(){return document.createElement("div")}},t);jsPlumb.Overlays.Custom.call(this,n),this.type="Label",this.label=t.label||"",this.labelText=null},jsPlumbUtil.extend(jsPlumb.Overlays.Label,jsPlumb.Overlays.Custom,{cleanup:function(){this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null},getLabel:function(){return this.label},setLabel:function(t){this.label=t,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),o.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var t=this.label(this);this.getElement().innerHTML=t.replace(/\r\n/g,"<br/>")}else null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))}})}(),function(){var t=function(t){this.type="Flowchart",t=t||{},t.stub=null==t.stub?30:t.stub;var n,e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),s=null==t.midpoint?.5:t.midpoint,i=[],r=(t.grid,t.alwaysRespectStubs),o=null,a=null,l=null,u=null!=t.cornerRadius?t.cornerRadius:0,c=function(t){return 0>t?-1:0===t?0:1},h=function(t,n,e,s){if(a!=n||l!=e){var i=null==a?s.sx:a,r=null==l?s.sy:l,o=i==n?"v":"h",u=c(n-i),h=c(e-r);a=n,l=e,t.push([i,r,n,e,o,u,h])}},d=function(t){return Math.sqrt(Math.pow(t[0]-t[2],2)+Math.pow(t[1]-t[3],2))},p=function(t){var n=[];return n.push.apply(n,t),n},m=function(t,n,s){for(var i,r,o=0;o<n.length-1;o++){if(i=i||p(n[o]),r=p(n[o+1]),u>0&&i[4]!=r[4]){var a=Math.min(u,d(i),d(r));i[2]-=i[5]*a,i[3]-=i[6]*a,r[0]+=r[5]*a,r[1]+=r[6]*a;var l=i[6]==r[5]&&1==r[5]||i[6]==r[5]&&0===r[5]&&i[5]!=r[6]||i[6]==r[5]&&-1==r[5],c=r[1]>i[3]?1:-1,h=r[0]>i[2]?1:-1,m=c==h,f=m&&l||!m&&!l?r[0]:i[2],g=m&&l||!m&&!l?i[3]:r[1];e.addSegment(t,"Straight",{x1:i[0],y1:i[1],x2:i[2],y2:i[3]}),e.addSegment(t,"Arc",{r:a,x1:i[2],y1:i[3],x2:r[0],y2:r[1],cx:f,cy:g,ac:l})}else{var b=i[2]==i[0]?0:i[2]>i[0]?s.lw/2:-(s.lw/2),v=i[3]==i[1]?0:i[3]>i[1]?s.lw/2:-(s.lw/2);e.addSegment(t,"Straight",{x1:i[0]-b,y1:i[1]-v,x2:i[2]+b,y2:i[3]+v})}i=r}e.addSegment(t,"Straight",{x1:r[0],y1:r[1],x2:r[2],y2:r[3]})};this.setSegments=function(t){o=t},this.isEditable=function(){return!0},this.getOriginalSegments=function(){return o||i},this._compute=function(t,u){if(u.clearEdits&&(o=null),null!=o)return void m(this,o,t);i=[],a=null,l=null,n=null;var c=t.startStubX+(t.endStubX-t.startStubX)*s,d=t.startStubY+(t.endStubY-t.startStubY)*s,p={x:[0,1],y:[1,0]},f=function(n){return[t.startStubX,t.startStubY,t.endStubX,t.endStubY]},g={perpendicular:f,orthogonal:f,opposite:function(n){var e=t,s="x"==n?0:1,i={x:function(){return 1==e.so[s]&&(e.startStubX>e.endStubX&&e.tx>e.startStubX||e.sx>e.endStubX&&e.tx>e.sx)||-1==e.so[s]&&(e.startStubX<e.endStubX&&e.tx<e.startStubX||e.sx<e.endStubX&&e.tx<e.sx)},y:function(){return 1==e.so[s]&&(e.startStubY>e.endStubY&&e.ty>e.startStubY||e.sy>e.endStubY&&e.ty>e.sy)||-1==e.so[s]&&(e.startStubY<e.endStubY&&e.ty<e.startStubY||e.sy<e.endStubY&&e.ty<e.sy)}};return!r&&i[n]()?{x:[(t.sx+t.tx)/2,t.startStubY,(t.sx+t.tx)/2,t.endStubY],y:[t.startStubX,(t.sy+t.ty)/2,t.endStubX,(t.sy+t.ty)/2]}[n]:[t.startStubX,t.startStubY,t.endStubX,t.endStubY]}},b={perpendicular:function(n,e,s,i,r){var o=t,a={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]},l={x:[[o.startStubX,o.endStubX],null,[o.endStubX,o.startStubX]],
y:[[o.startStubY,o.endStubY],null,[o.endStubY,o.startStubY]]},u={x:[[c,o.startStubY],[c,o.endStubY]],y:[[o.startStubX,d],[o.endStubX,d]]},h={x:[[o.endStubX,o.startStubY]],y:[[o.startStubX,o.endStubY]]},m={x:[[o.startStubX,o.endStubY],[o.endStubX,o.endStubY]],y:[[o.endStubX,o.startStubY],[o.endStubX,o.endStubY]]},f={x:[[o.startStubX,d],[o.endStubX,d],[o.endStubX,o.endStubY]],y:[[c,o.startStubY],[c,o.endStubY],[o.endStubX,o.endStubY]]},g={x:[o.startStubY,o.endStubY],y:[o.startStubX,o.endStubX]},b=p[n][0],v=p[n][1],y=o.so[b]+1,P=o.to[v]+1,j=-1==o.to[v]&&g[n][1]<g[n][0]||1==o.to[v]&&g[n][1]>g[n][0],x=l[n][y][0],C=l[n][y][1],E=a[n][y][P];return o.segment==E[3]||o.segment==E[2]&&j?u[n]:o.segment==E[2]&&x>C?h[n]:o.segment==E[2]&&C>=x||o.segment==E[1]&&!j?f[n]:o.segment==E[0]||o.segment==E[1]&&j?m[n]:void 0},orthogonal:function(n,e,s,i,r){var o=t,a={x:-1==o.so[0]?Math.min(e,i):Math.max(e,i),y:-1==o.so[1]?Math.min(e,i):Math.max(e,i)}[n];return{x:[[a,s],[a,r],[i,r]],y:[[s,a],[r,a],[r,i]]}[n]},opposite:function(n,s,i,r,o){var a=t,l={x:"y",y:"x"}[n],h={x:"height",y:"width"}[n],p=a["is"+n.toUpperCase()+"GreaterThanStubTimes2"];if(u.sourceEndpoint.elementId==u.targetEndpoint.elementId){var m=i+(1-u.sourceEndpoint.anchor[l])*u.sourceInfo[h]+e.maxStub;return{x:[[s,m],[r,m]],y:[[m,s],[m,r]]}[n]}return!p||1==a.so[y]&&s>r||-1==a.so[y]&&r>s?{x:[[s,d],[r,d]],y:[[c,s],[c,r]]}[n]:1==a.so[y]&&r>s||-1==a.so[y]&&s>r?{x:[[c,a.sy],[c,a.ty]],y:[[a.sx,d],[a.tx,d]]}[n]:void 0}},v=g[t.anchorOrientation](t.sourceAxis),y="x"==t.sourceAxis?0:1,P="x"==t.sourceAxis?1:0,j=v[y],x=v[P],C=v[y+2],E=v[P+2];h(i,v[0],v[1],t);var S=b[t.anchorOrientation](t.sourceAxis,j,x,C,E);if(S)for(var _=0;_<S.length;_++)h(i,S[_][0],S[_][1],t);h(i,v[2],v[3],t),h(i,t.tx,t.ty,t),m(this,i,t)},this.getPath=function(){for(var t=null,n=null,e=[],s=o||i,r=0;r<s.length;r++){var a=s[r],l=a[4],u="v"==l?3:2;null!=t&&n===l?t[u]=a[u]:(a[0]!=a[2]||a[1]!=a[3])&&(e.push({start:[a[0],a[1]],end:[a[2],a[3]]}),t=a,n=a[4])}return e},this.setPath=function(t){o=[];for(var n=0;n<t.length;n++){var e=t[n].start[0],s=t[n].start[1],i=t[n].end[0],r=t[n].end[1],a=e==i?"v":"h",l=c(i-e),u=c(r-s);o.push([e,s,i,r,a,l,u])}}};jsPlumbUtil.extend(t,jsPlumb.Connectors.AbstractConnector),jsPlumb.registerConnectorType(t,"Flowchart")}(),function(){var t=function(t,n,e,s){return e>=t&&n>=s?1:e>=t&&s>=n?2:t>=e&&s>=n?3:4},n=function(t,n,e,s,i,r,o,a,l){return l>=a?[t,n]:1===e?s[3]<=0&&i[3]>=1?[t+(s[2]<.5?-1*r:r),n]:s[2]>=1&&i[2]<=0?[t,n+(s[3]<.5?-1*o:o)]:[t+-1*r,n+-1*o]:2===e?s[3]>=1&&i[3]<=0?[t+(s[2]<.5?-1*r:r),n]:s[2]>=1&&i[2]<=0?[t,n+(s[3]<.5?-1*o:o)]:[t+1*r,n+-1*o]:3===e?s[3]>=1&&i[3]<=0?[t+(s[2]<.5?-1*r:r),n]:s[2]<=0&&i[2]>=1?[t,n+(s[3]<.5?-1*o:o)]:[t+-1*r,n+-1*o]:4===e?s[3]<=0&&i[3]>=1?[t+(s[2]<.5?-1*r:r),n]:s[2]<=0&&i[2]>=1?[t,n+(s[3]<.5?-1*o:o)]:[t+1*r,n+-1*o]:void 0},e=function(e){e=e||{},this.type="StateMachine";var s=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),i=e.curviness||10,r=e.margin||5,o=e.proximityLimit||80,a=e.orientation&&"clockwise"===e.orientation,l=e.loopbackRadius||25,u=e.showLoopback!==!1;this._compute=function(e,c){var h=Math.abs(c.sourcePos[0]-c.targetPos[0]),d=Math.abs(c.sourcePos[1]-c.targetPos[1]);Math.min(c.sourcePos[0],c.targetPos[0]),Math.min(c.sourcePos[1],c.targetPos[1]);if(u&&c.sourceEndpoint.elementId===c.targetEndpoint.elementId){var p=c.sourcePos[0],m=(c.sourcePos[0],c.sourcePos[1]-r),f=(c.sourcePos[1]-r,p),g=m-l,b=2*l,v=2*l,y=f-l,P=g-l;e.points[0]=y,e.points[1]=P,e.points[2]=b,e.points[3]=v,s.addSegment(this,"Arc",{x1:p-y+4,y1:m-P,startAngle:0,endAngle:2*Math.PI,r:l,ac:!a,x2:p-y-4,y2:m-P,cx:f-y,cy:g-P})}else{var j=c.sourcePos[0]<c.targetPos[0]?0:h,x=c.sourcePos[1]<c.targetPos[1]?0:d,C=c.sourcePos[0]<c.targetPos[0]?h:0,E=c.sourcePos[1]<c.targetPos[1]?d:0;0===c.sourcePos[2]&&(j-=r),1===c.sourcePos[2]&&(j+=r),0===c.sourcePos[3]&&(x-=r),1===c.sourcePos[3]&&(x+=r),0===c.targetPos[2]&&(C-=r),1===c.targetPos[2]&&(C+=r),0===c.targetPos[3]&&(E-=r),1===c.targetPos[3]&&(E+=r);var S=(j+C)/2,_=(x+E)/2,D=-1*S/_,A=Math.atan(D),w=(D==1/0||D==-(1/0)?0:Math.abs(i/2*Math.sin(A)),D==1/0||D==-(1/0)?0:Math.abs(i/2*Math.cos(A)),t(j,x,C,E)),I=Math.sqrt(Math.pow(C-j,2)+Math.pow(E-x,2)),O=n(S,_,w,c.sourcePos,c.targetPos,i,i,I,o);s.addSegment(this,"Bezier",{x1:C,y1:E,x2:j,y2:x,cp1x:O[0],cp1y:O[1],cp2x:O[0],cp2y:O[1]})}}};jsPlumb.registerConnectorType(e,"StateMachine")}(),function(){var t=function(t){t=t||{};var n=this,e=jsPlumb.Connectors.AbstractConnector.apply(this,arguments),s=(t.stub||50,t.curviness||150),i=10;this.type="Bezier",this.getCurviness=function(){return s},this._findControlPoint=function(t,n,e,r,o){var a=r.anchor.getOrientation(r),l=o.anchor.getOrientation(o),u=a[0]!=l[0]||a[1]==l[1],c=[];return u?(0===l[0]?c.push(e[0]<n[0]?t[0]+i:t[0]-i):c.push(t[0]+s*l[0]),0===l[1]?c.push(e[1]<n[1]?t[1]+i:t[1]-i):c.push(t[1]+s*a[1])):(0===a[0]?c.push(n[0]<e[0]?t[0]+i:t[0]-i):c.push(t[0]-s*a[0]),0===a[1]?c.push(n[1]<e[1]?t[1]+i:t[1]-i):c.push(t[1]+s*l[1])),c},this._compute=function(t,s){var i=s.sourcePos,r=s.targetPos,o=Math.abs(i[0]-r[0]),a=Math.abs(i[1]-r[1]),l=i[0]<r[0]?o:0,u=i[1]<r[1]?a:0,c=i[0]<r[0]?0:o,h=i[1]<r[1]?0:a,d=n._findControlPoint([l,u],i,r,s.sourceEndpoint,s.targetEndpoint),p=n._findControlPoint([c,h],r,i,s.targetEndpoint,s.sourceEndpoint);e.addSegment(this,"Bezier",{x1:l,y1:u,x2:c,y2:h,cp1x:d[0],cp1y:d[1],cp2x:p[0],cp2y:p[1]})}};jsPlumb.registerConnectorType(t,"Bezier")}(),function(){var t=null,n=function(t,n){return jsPlumb.CurrentLibrary.hasClass(e(t),n)},e=function(t){return jsPlumb.CurrentLibrary.getElementObject(t)},s=function(t){return jsPlumb.CurrentLibrary.getOffset(e(t))},i=function(t){return jsPlumb.CurrentLibrary.getPageXY(t)},r=function(t){return jsPlumb.CurrentLibrary.getClientXY(t)},o=window.CanvasMouseAdapter=function(){var o=this;o.overlayPlacements=[],jsPlumb.jsPlumbUIComponent.apply(this,arguments),jsPlumbUtil.EventGenerator.apply(this,arguments),this._over=function(t){var n=s(e(o.canvas)),r=i(t),a=r[0]-n.left,l=r[1]-n.top;if(a>0&&l>0&&a<o.canvas.width&&l<o.canvas.height){for(var u=0;u<o.overlayPlacements.length;u++){var c=o.overlayPlacements[u];if(c&&c[0]<=a&&c[1]>=a&&c[2]<=l&&c[3]>=l)return!0}var h=o.canvas.getContext("2d").getImageData(parseInt(a,10),parseInt(l,10),1,1);return 0!==h.data[0]||0!==h.data[1]||0!==h.data[2]||0!==h.data[3]}return!1};var a=!1,l=!1,u=null,c=!1,h=function(t,e){return null!==t&&n(t,e)};this.mousemove=function(n){var e=(i(n),r(n)),s=document.elementFromPoint(e[0],e[1]),l=h(s,"_jsPlumb_overlay"),u=null===t&&(h(s,"_jsPlumb_endpoint")||h(s,"_jsPlumb_connector"));return!a&&u&&o._over(n)?(a=!0,o.fire("mouseenter",o,n),!0):(!a||o._over(n)&&u||l||(a=!1,o.fire("mouseexit",o,n)),void o.fire("mousemove",o,n))},this.click=function(t){a&&o._over(t)&&!c&&o.fire("click",o,t),c=!1},this.dblclick=function(t){a&&o._over(t)&&!c&&o.fire("dblclick",o,t),c=!1},this.mousedown=function(t){o._over(t)&&!l&&(l=!0,u=s(e(o.canvas)),o.fire("mousedown",o,t))},this.mouseup=function(t){l=!1,o.fire("mouseup",o,t)},this.contextmenu=function(t){a&&o._over(t)&&!c&&o.fire("contextmenu",o,t),c=!1}};jsPlumbUtil.extend(o,[jsPlumb.jsPlumbUIComponent,jsPlumbUtil.EventGenerator]);var a=function(t){var n=document.createElement("canvas");return t._jsPlumb.instance.appendElement(n,t.parent),n.style.position="absolute",t["class"]&&(n.className=t["class"]),t._jsPlumb.instance.getId(n,t.uuid),t.tooltip&&n.setAttribute("title",t.tooltip),n},l=window.CanvasComponent=function(t){o.apply(this,arguments);var n=[];this.getDisplayElements=function(){return n},this.appendDisplayElement=function(t){n.push(t)}};jsPlumbUtil.extend(l,o);var u=[null,[1,-1],[1,1],[-1,1],[-1,-1]],c=function(t,n,e){if(n.gradient){for(var s=e(),i=0;i<n.gradient.stops.length;i++)s.addColorStop(n.gradient.stops[i][0],n.gradient.stops[i][1]);t.strokeStyle=s}},h=function(t,n,e,s,i){({Straight:function(t,n,e,s,i){var r=t.params;if(n.save(),c(n,e,function(){return n.createLinearGradient(r.x1,r.y1,r.x2,r.y2)}),n.beginPath(),n.translate(s,i),e.dashstyle&&2===e.dashstyle.split(" ").length){var o=e.dashstyle.split(" ");2!==o.length&&(o=[2,2]);for(var a=[o[0]*e.lineWidth,o[1]*e.lineWidth],l=(r.x2-r.x1)/(r.y2-r.y1),h=jsPlumbUtil.segment([r.x1,r.y1],[r.x2,r.y2]),d=u[h],p=Math.atan(l),m=Math.sqrt(Math.pow(r.x2-r.x1,2)+Math.pow(r.y2-r.y1,2)),f=Math.floor(m/(a[0]+a[1])),g=[r.x1,r.y1],b=0;f>b;b++){n.moveTo(g[0],g[1]);var v=g[0]+Math.abs(Math.sin(p)*a[0])*d[0],y=g[1]+Math.abs(Math.cos(p)*a[0])*d[1],P=g[0]+Math.abs(Math.sin(p)*(a[0]+a[1]))*d[0],j=g[1]+Math.abs(Math.cos(p)*(a[0]+a[1]))*d[1];n.lineTo(v,y),g=[P,j]}n.moveTo(g[0],g[1]),n.lineTo(r.x2,r.y2)}else n.moveTo(r.x1,r.y1),n.lineTo(r.x2,r.y2);n.stroke(),n.restore()},Bezier:function(t,n,e,s,i){var r=t.params;n.save(),c(n,e,function(){return n.createLinearGradient(r.x2+s,r.y2+i,r.x1+s,r.y1+i)}),n.beginPath(),n.translate(s,i),n.moveTo(r.x1,r.y1),n.bezierCurveTo(r.cp1x,r.cp1y,r.cp2x,r.cp2y,r.x2,r.y2),n.stroke(),n.restore()},Arc:function(t,n,e,s,i){var r=t.params;n.save(),n.beginPath(),n.translate(s,i),n.arc(r.cx,r.cy,r.r,t.startAngle,t.endAngle,r.ac),n.stroke(),n.restore()}})[t.type](t,n,e,s,i)},d=jsPlumb.ConnectorRenderers.canvas=function(t){l.apply(this,arguments);var n=function(t,n,e){this.ctx.save(),jsPlumb.extend(this.ctx,t);for(var s=this.getSegments(),i=0;i<s.length;i++)h(s[i],this.ctx,t,n,e);this.ctx.restore()}.bind(this),e=this._jsPlumb.instance.connectorClass+" "+(t.cssClass||"");this.canvas=a({"class":e,_jsPlumb:this._jsPlumb,parent:t.parent}),this.ctx=this.canvas.getContext("2d"),this.appendDisplayElement(this.canvas),this.paint=function(t,e,s){if(null!=t){var i=[this.x,this.y],r=[this.w,this.h],o=0,a=0;if(null!=s&&(s.xmin<0&&(i[0]+=s.xmin,o=-s.xmin),s.ymin<0&&(i[1]+=s.ymin,a=-s.ymin),r[0]=s.xmax+(s.xmin<0?-s.xmin:0),r[1]=s.ymax+(s.ymin<0?-s.ymin:0)),this.translateX=o,this.translateY=a,jsPlumbUtil.sizeElement(this.canvas,i[0],i[1],r[0],r[1]),null!=t.outlineColor){var l=t.outlineWidth||1,u=t.lineWidth+2*l,c={strokeStyle:t.outlineColor,lineWidth:u};n(c,o,a)}n(t,o,a)}}};jsPlumbUtil.extend(d,l);var p=function(t){l.apply(this,arguments);var n=this._jsPlumb.instance.endpointClass+" "+(t.cssClass||""),e={"class":n,_jsPlumb:this._jsPlumb,parent:t.parent,tooltip:self.tooltip};this.canvas=a(e),this.ctx=this.canvas.getContext("2d"),this.appendDisplayElement(this.canvas),this.paint=function(t,n,e){if(jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h),null!=t.outlineColor){var s=t.outlineWidth||1,i=t.lineWidth+2*s;({strokeStyle:t.outlineColor,lineWidth:i})}this._paint.apply(this,arguments)}};jsPlumbUtil.extend(p,l),jsPlumb.Endpoints.canvas.Dot=function(t){jsPlumb.Endpoints.Dot.apply(this,arguments),p.apply(this,arguments);var n=this,e=function(t){try{return parseInt(t,10)}catch(n){if("%"==t.substring(t.length-1))return parseInt(t.substring(0,t-1),10)}},s=function(t){var s=n.defaultOffset,i=n.defaultInnerRadius;return t.offset&&(s=e(t.offset)),t.innerRadius&&(i=e(t.innerRadius)),[s,i]};this._paint=function(e){if(null!=e){var i=n.canvas.getContext("2d"),r=t.endpoint.anchor.getOrientation(t.endpoint);if(jsPlumb.extend(i,e),e.gradient){for(var o=s(e.gradient),a=1==r[1]?-1*o[0]:o[0],l=1==r[0]?-1*o[0]:o[0],u=i.createRadialGradient(n.radius,n.radius,n.radius,n.radius+l,n.radius+a,o[1]),c=0;c<e.gradient.stops.length;c++)u.addColorStop(e.gradient.stops[c][0],e.gradient.stops[c][1]);i.fillStyle=u}i.beginPath(),i.arc(n.radius,n.radius,n.radius,0,2*Math.PI,!0),i.closePath(),(e.fillStyle||e.gradient)&&i.fill(),e.strokeStyle&&i.stroke()}}},jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Dot,[jsPlumb.Endpoints.Dot,p]),jsPlumb.Endpoints.canvas.Rectangle=function(t){var n=this;jsPlumb.Endpoints.Rectangle.apply(this,arguments),p.apply(this,arguments),this._paint=function(e){var s=n.canvas.getContext("2d"),i=t.endpoint.anchor.getOrientation(t.endpoint);if(jsPlumb.extend(s,e),e.gradient){for(var r=1==i[1]?n.h:0===i[1]?n.h/2:0,o=-1==i[1]?n.h:0===i[1]?n.h/2:0,a=1==i[0]?n.w:0===i[0]?n.w/2:0,l=-1==i[0]?n.w:0===i[0]?n.w/2:0,u=s.createLinearGradient(a,r,l,o),c=0;c<e.gradient.stops.length;c++)u.addColorStop(e.gradient.stops[c][0],e.gradient.stops[c][1]);s.fillStyle=u}s.beginPath(),s.rect(0,0,n.w,n.h),s.closePath(),(e.fillStyle||e.gradient)&&s.fill(),e.strokeStyle&&s.stroke()}},jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Rectangle,[jsPlumb.Endpoints.Rectangle,p]),jsPlumb.Endpoints.canvas.Triangle=function(t){var n=this;jsPlumb.Endpoints.Triangle.apply(this,arguments),p.apply(this,arguments),this._paint=function(e){var s=n.canvas.getContext("2d"),i=0,r=0,o=0,a=t.endpoint.anchor.getOrientation(t.endpoint);1==a[0]&&(i=n.width,r=n.height,o=180),-1==a[1]&&(i=n.width,o=90),1==a[1]&&(r=n.height,o=-90),s.fillStyle=e.fillStyle,s.translate(i,r),s.rotate(o*Math.PI/180),s.beginPath(),s.moveTo(0,0),s.lineTo(n.width/2,n.height/2),s.lineTo(0,n.height),s.closePath(),(e.fillStyle||e.gradient)&&s.fill(),e.strokeStyle&&s.stroke()}},jsPlumbUtil.extend(jsPlumb.Endpoints.canvas.Triangle,[jsPlumb.Endpoints.Triangle,p]),jsPlumb.Endpoints.canvas.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.canvas.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.canvas.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.canvas.Custom=jsPlumb.Overlays.Custom;var m=function(){jsPlumb.jsPlumbUIComponent.apply(this,arguments)};jsPlumbUtil.extend(m,jsPlumb.jsPlumbUIComponent);var f=function(t,n){t.apply(this,n),m.apply(this,n),this.paint=function(t,n){var e=t.component.ctx,s=t.d;s&&(e.save(),e.lineWidth=t.lineWidth,e.beginPath(),e.translate(t.component.translateX,t.component.translateY),e.moveTo(s.hxy.x,s.hxy.y),e.lineTo(s.tail[0].x,s.tail[0].y),e.lineTo(s.cxy.x,s.cxy.y),e.lineTo(s.tail[1].x,s.tail[1].y),e.lineTo(s.hxy.x,s.hxy.y),e.closePath(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.stroke()),t.fillStyle&&(e.fillStyle=t.fillStyle,e.fill()),e.restore())}};jsPlumb.Overlays.canvas.Arrow=function(){f.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.canvas.Arrow,[jsPlumb.Overlays.Arrow,m]),jsPlumb.Overlays.canvas.PlainArrow=function(){f.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.canvas.PlainArrow,[jsPlumb.Overlays.PlainArrow,m]),jsPlumb.Overlays.canvas.Diamond=function(){f.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.canvas.Diamond,[jsPlumb.Overlays.Diamond,m])}(),function(){var t={joinstyle:"stroke-linejoin","stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},n="stroke-dasharray",e="dashstyle",s="linearGradient",i="radialGradient",r="fill",o="stop",a="stroke",l="stroke-width",u="style",c="none",h="jsplumb_gradient_",d="lineWidth",p={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml"},m=function(t,n){for(var e in n)t.setAttribute(e,""+n[e])},f=function(t,n){var e=document.createElementNS(p.svg,t);return n=n||{},n.version="1.1",n.xmlns=p.xhtml,m(e,n),e},g=function(t){return"position:absolute;left:"+t[0]+"px;top:"+t[1]+"px"},b=function(t){for(var n=0;n<t.childNodes.length;n++)(t.childNodes[n].tagName==s||t.childNodes[n].tagName==i)&&t.removeChild(t.childNodes[n])},v=function(t,n,e,l,c){var d=h+c._jsPlumb.instance.idstamp();b(t);var p;p=e.gradient.offset?f(i,{id:d}):f(s,{id:d,gradientUnits:"userSpaceOnUse"}),t.appendChild(p);for(var m=0;m<e.gradient.stops.length;m++){var g=1==c.segment||2==c.segment?m:e.gradient.stops.length-1-m,v=jsPlumbUtil.convertStyle(e.gradient.stops[g][1],!0),y=f(o,{offset:Math.floor(100*e.gradient.stops[m][0])+"%","stop-color":v});p.appendChild(y)}var P=e.strokeStyle?a:r;n.setAttribute(u,P+":url(#"+d+")")},y=function(s,i,o,h,p){if(o.gradient?v(s,i,o,h,p):(b(s),i.setAttribute(u,"")),i.setAttribute(r,o.fillStyle?jsPlumbUtil.convertStyle(o.fillStyle,!0):c),i.setAttribute(a,o.strokeStyle?jsPlumbUtil.convertStyle(o.strokeStyle,!0):c),o.lineWidth&&i.setAttribute(l,o.lineWidth),o[e]&&o[d]&&!o[n]){var m=-1==o[e].indexOf(",")?" ":",",f=o[e].split(m),g="";f.forEach(function(t){g+=Math.floor(t*o.lineWidth)+m}),i.setAttribute(n,g)}else o[n]&&i.setAttribute(n,o[n]);for(var y in t)o[y]&&i.setAttribute(t[y],o[y])},P=function(t,n,e){for(var s=e.split(" "),i=t.className,r=i.baseVal.split(" "),o=0;o<s.length;o++)if(n)-1==r.indexOf(s[o])&&r.push(s[o]);else{var a=r.indexOf(s[o]);-1!=a&&r.splice(a,1)}t.className.baseVal=r.join(" ")},j=function(t,n){P(t,!0,n)},x=function(t,n){P(t,!1,n)},C=function(t,n,e){t.childNodes.length>e?t.insertBefore(n,t.childNodes[e]):t.appendChild(n)};jsPlumbUtil.svg={addClass:j,removeClass:x,node:f,attr:m,pos:g};var E=function(t){var n=t.pointerEventsSpec||"all",e={};jsPlumb.jsPlumbUIComponent.apply(this,t.originalArgs),this.canvas=null,this.path=null,this.svg=null;var s=t.cssClass+" "+(t.originalArgs[0].cssClass||""),i={style:"",width:0,height:0,"pointer-events":n,position:"absolute"};this.svg=f("svg",i),t.useDivWrapper?(this.canvas=document.createElement("div"),this.canvas.style.position="absolute",jsPlumbUtil.sizeElement(this.canvas,0,0,1,1),this.canvas.className=s):(m(this.svg,{"class":s}),this.canvas=this.svg),t._jsPlumb.appendElement(this.canvas,t.originalArgs[0].parent),t.useDivWrapper&&this.canvas.appendChild(this.svg);var r=[this.canvas];return this.getDisplayElements=function(){return r},this.appendDisplayElement=function(t){r.push(t)},this.paint=function(n,s,i){if(null!=n){var r,o=[this.x,this.y],a=[this.w,this.h];null!=i&&(i.xmin<0&&(o[0]+=i.xmin),i.ymin<0&&(o[1]+=i.ymin),a[0]=i.xmax+(i.xmin<0?-i.xmin:0),a[1]=i.ymax+(i.ymin<0?-i.ymin:0)),t.useDivWrapper?(jsPlumbUtil.sizeElement(this.canvas,o[0],o[1],a[0],a[1]),o[0]=0,o[1]=0,r=g([0,0])):r=g([o[0],o[1]]),e.paint.apply(this,arguments),m(this.svg,{style:r,width:a[0],height:a[1]})}},{renderer:e}};jsPlumbUtil.extend(E,jsPlumb.jsPlumbUIComponent,{cleanup:function(){jsPlumbUtil.removeElement(this.canvas),this.svg=null,this.canvas=null,this.path=null}});jsPlumb.ConnectorRenderers.svg=function(t){var n=this,e=E.apply(this,[{cssClass:t._jsPlumb.connectorClass,originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:t._jsPlumb}]);e.renderer.paint=function(e,s,i){var r=n.getSegments(),o="",a=[0,0];i.xmin<0&&(a[0]=-i.xmin),i.ymin<0&&(a[1]=-i.ymin);for(var l=0;l<r.length;l++)o+=jsPlumb.Segments.svg.SegmentRenderer.getPath(r[l]),o+=" ";var u={d:o,transform:"translate("+a[0]+","+a[1]+")","pointer-events":t["pointer-events"]||"visibleStroke"},c=null,h=[n.x,n.y,n.w,n.h];if(e.outlineColor){var d=e.outlineWidth||1,p=e.lineWidth+2*d;c=jsPlumb.CurrentLibrary.extend({},e),c.strokeStyle=jsPlumbUtil.convertStyle(e.outlineColor),c.lineWidth=p,null==n.bgPath?(n.bgPath=f("path",u),C(n.svg,n.bgPath,0),n.attachListeners(n.bgPath,n)):m(n.bgPath,u),y(n.svg,n.bgPath,c,h,n)}null==n.path?(n.path=f("path",u),C(n.svg,n.path,e.outlineColor?1:0),n.attachListeners(n.path,n)):m(n.path,u),y(n.svg,n.path,e,h,n)},this.reattachListeners=function(){this.bgPath&&this.reattachListenersForElement(this.bgPath,this),this.path&&this.reattachListenersForElement(this.path,this)}};jsPlumbUtil.extend(jsPlumb.ConnectorRenderers.svg,E),jsPlumb.Segments.svg={SegmentRenderer:{getPath:function(t){return{Straight:function(){var n=t.getCoordinates();return"M "+n.x1+" "+n.y1+" L "+n.x2+" "+n.y2},Bezier:function(){var n=t.params;return"M "+n.x1+" "+n.y1+" C "+n.cp1x+" "+n.cp1y+" "+n.cp2x+" "+n.cp2y+" "+n.x2+" "+n.y2},Arc:function(){var n=t.params,e=t.sweep>Math.PI?1:0,s=t.anticlockwise?0:1;return"M"+t.x1+" "+t.y1+" A "+t.radius+" "+n.r+" 0 "+e+","+s+" "+t.x2+" "+t.y2}}[t.type]()}}};var S=window.SvgEndpoint=function(t){var n=E.apply(this,[{cssClass:t._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:t._jsPlumb}]);n.renderer.paint=function(t){var n=jsPlumb.extend({},t);n.outlineColor&&(n.strokeWidth=n.outlineWidth,n.strokeStyle=jsPlumbUtil.convertStyle(n.outlineColor,!0)),null==this.node?(this.node=this.makeNode(n),this.svg.appendChild(this.node),this.attachListeners(this.node,this)):null!=this.updateNode&&this.updateNode(this.node),y(this.svg,this.node,n,[this.x,this.y,this.w,this.h],this),g(this.node,[this.x,this.y])}.bind(this)};jsPlumbUtil.extend(S,E,{reattachListeners:function(){this.node&&this.reattachListenersForElement(this.node,this)}}),jsPlumb.Endpoints.svg.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),S.apply(this,arguments),this.makeNode=function(t){return f("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(t){m(t,{cx:this.w/2,cy:this.h/2,r:this.radius})}},jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Dot,[jsPlumb.Endpoints.Dot,S]),jsPlumb.Endpoints.svg.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),S.apply(this,arguments),this.makeNode=function(t){return f("rect",{width:this.w,height:this.h})},this.updateNode=function(t){m(t,{width:this.w,height:this.h})}},jsPlumbUtil.extend(jsPlumb.Endpoints.svg.Rectangle,[jsPlumb.Endpoints.Rectangle,S]),jsPlumb.Endpoints.svg.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.svg.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.svg.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.svg.Custom=jsPlumb.Overlays.Custom;var _=function(t,n){t.apply(this,n),jsPlumb.jsPlumbUIComponent.apply(this,n),this.isAppendedAtTopLevel=!1;this.path=null,this.paint=function(t,s){if(t.component.svg&&s){null==this.path&&(this.path=f("path",{"pointer-events":"all"}),t.component.svg.appendChild(this.path),this.attachListeners(this.path,t.component),this.attachListeners(this.path,this));var i=n&&1==n.length?n[0].cssClass||"":"",r=[0,0];s.xmin<0&&(r[0]=-s.xmin),s.ymin<0&&(r[1]=-s.ymin),m(this.path,{d:e(t.d),"class":i,stroke:t.strokeStyle?t.strokeStyle:null,fill:t.fillStyle?t.fillStyle:null,transform:"translate("+r[0]+","+r[1]+")"})}};var e=function(t){return"M"+t.hxy.x+","+t.hxy.y+" L"+t.tail[0].x+","+t.tail[0].y+" L"+t.cxy.x+","+t.cxy.y+" L"+t.tail[1].x+","+t.tail[1].y+" L"+t.hxy.x+","+t.hxy.y};this.reattachListeners=function(){this.path&&this.reattachListenersForElement(this.path,this)}};jsPlumbUtil.extend(_,jsPlumb.jsPlumbUIComponent,{cleanup:function(){null!=this.path&&jsPlumb.CurrentLibrary.removeElement(this.path)}}),jsPlumb.Overlays.svg.Arrow=function(){_.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.Arrow,[jsPlumb.Overlays.Arrow,_]),jsPlumb.Overlays.svg.PlainArrow=function(){_.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.PlainArrow,[jsPlumb.Overlays.PlainArrow,_]),jsPlumb.Overlays.svg.Diamond=function(){_.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.svg.Diamond,[jsPlumb.Overlays.Diamond,_]),jsPlumb.Overlays.svg.GuideLines=function(){var t,n,e=null,s=this;jsPlumb.Overlays.GuideLines.apply(this,arguments),this.paint=function(r,o){null==e&&(e=f("path"),r.connector.svg.appendChild(e),s.attachListeners(e,r.connector),s.attachListeners(e,s),t=f("path"),r.connector.svg.appendChild(t),s.attachListeners(t,r.connector),s.attachListeners(t,s),n=f("path"),r.connector.svg.appendChild(n),s.attachListeners(n,r.connector),s.attachListeners(n,s));var a=[0,0];o.xmin<0&&(a[0]=-o.xmin),o.ymin<0&&(a[1]=-o.ymin),m(e,{d:i(r.head,r.tail),stroke:"red",fill:null,transform:"translate("+a[0]+","+a[1]+")"}),m(t,{d:i(r.tailLine[0],r.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+a[0]+","+a[1]+")"}),m(n,{d:i(r.headLine[0],r.headLine[1]),stroke:"green",fill:null,transform:"translate("+a[0]+","+a[1]+")"})};var i=function(t,n){return"M "+t.x+","+t.y+" L"+n.x+","+n.y}},jsPlumbUtil.extend(jsPlumb.Overlays.svg.GuideLines,jsPlumb.Overlays.GuideLines)}(),function(){var t={"stroke-linejoin":"joinstyle",joinstyle:"joinstyle",endcap:"endcap",miterlimit:"miterlimit"},n=null;if(document.createStyleSheet&&document.namespaces){var e=[".jsplumb_vml","jsplumb\\:textbox","jsplumb\\:oval","jsplumb\\:rect","jsplumb\\:stroke","jsplumb\\:shape","jsplumb\\:group"],s="behavior:url(#default#VML);position:absolute;";n=document.createStyleSheet();for(var i=0;i<e.length;i++)n.addRule(e[i],s);document.namespaces.add("jsplumb","urn:schemas-microsoft-com:vml")}jsPlumb.vml={};var r=1e3,o=function(t,n){for(var e in n)t[e]=n[e]},a=function(t,n,e,s,i,r){e=e||{};var a=document.createElement("jsplumb:"+t);return r?i.appendElement(a,s):jsPlumb.CurrentLibrary.appendElement(a,s),a.className=(e["class"]?e["class"]+" ":"")+"jsplumb_vml",l(a,n),o(a,e),a},l=function(t,n,e){t.style.left=n[0]+"px",t.style.top=n[1]+"px",t.style.width=n[2]+"px",t.style.height=n[3]+"px",t.style.position="absolute",e&&(t.style.zIndex=e)},u=jsPlumb.vml.convertValue=function(t){return Math.floor(t*r)},c=function(t,n,e,s){"transparent"===n?s.setOpacity(e,"0.0"):s.setOpacity(e,"1.0")},h=function(t,n,e,s){var i={};if(n.strokeStyle){i.stroked="true";var r=jsPlumbUtil.convertStyle(n.strokeStyle,!0);i.strokecolor=r,c(i,r,"stroke",e),i.strokeweight=n.lineWidth+"px"}else i.stroked="false";if(n.fillStyle){i.filled="true";var l=jsPlumbUtil.convertStyle(n.fillStyle,!0);i.fillcolor=l,c(i,l,"fill",e)}else i.filled="false";if(n.dashstyle)null==e.strokeNode?e.strokeNode=a("stroke",[0,0,0,0],{dashstyle:n.dashstyle},t,s):e.strokeNode.dashstyle=n.dashstyle;else if(n["stroke-dasharray"]&&n.lineWidth){for(var u=-1==n["stroke-dasharray"].indexOf(",")?" ":",",h=n["stroke-dasharray"].split(u),d="",p=0;p<h.length;p++)d+=Math.floor(h[p]/n.lineWidth)+u;null==e.strokeNode?e.strokeNode=a("stroke",[0,0,0,0],{dashstyle:d},t,s):e.strokeNode.dashstyle=d}o(t,i)},d=function(){var t=this;jsPlumb.jsPlumbUIComponent.apply(this,arguments),this.opacityNodes={stroke:null,fill:null},this.initOpacityNodes=function(n){t.opacityNodes.stroke=a("stroke",[0,0,1,1],{opacity:"0.0"},n,t._jsPlumb.instance),t.opacityNodes.fill=a("fill",[0,0,1,1],{opacity:"0.0"},n,t._jsPlumb.instance)},this.setOpacity=function(n,e){var s=t.opacityNodes[n];s&&(s.opacity=""+e)};var n=[];this.getDisplayElements=function(){return n},this.appendDisplayElement=function(e,s){s||t.canvas.parentNode.appendChild(e),n.push(e)}};jsPlumbUtil.extend(d,jsPlumb.jsPlumbUIComponent,{cleanup:function(){this.bgCanvas&&jsPlumbUtil.removeElement(this.bgCanvas),jsPlumbUtil.removeElement(this.canvas)}});var p=jsPlumb.ConnectorRenderers.vml=function(n){this.strokeNode=null,this.canvas=null,d.apply(this,arguments);var e=this._jsPlumb.instance.connectorClass+(n.cssClass?" "+n.cssClass:"");this.paint=function(s){if(null!==s){this.w=Math.max(this.w,1),this.h=Math.max(this.h,1);for(var i=this.getSegments(),u={path:""},c=[this.x,this.y,this.w,this.h],d=0;d<i.length;d++)u.path+=jsPlumb.Segments.vml.SegmentRenderer.getPath(i[d]),u.path+=" ";if(s.outlineColor){var p=s.outlineWidth||1,m=s.lineWidth+2*p,f={strokeStyle:jsPlumbUtil.convertStyle(s.outlineColor),lineWidth:m};for(var g in t)f[g]=s[g];null==this.bgCanvas?(u["class"]=e,u.coordsize=c[2]*r+","+c[3]*r,this.bgCanvas=a("shape",c,u,n.parent,this._jsPlumb.instance,!0),l(this.bgCanvas,c),this.appendDisplayElement(this.bgCanvas,!0),this.attachListeners(this.bgCanvas,this),this.initOpacityNodes(this.bgCanvas,["stroke"])):(u.coordsize=c[2]*r+","+c[3]*r,l(this.bgCanvas,c),o(this.bgCanvas,u)),h(this.bgCanvas,f,this)}null==this.canvas?(u["class"]=e,u.coordsize=c[2]*r+","+c[3]*r,this.canvas=a("shape",c,u,n.parent,this._jsPlumb.instance,!0),this.appendDisplayElement(this.canvas,!0),this.attachListeners(this.canvas,this),this.initOpacityNodes(this.canvas,["stroke"])):(u.coordsize=c[2]*r+","+c[3]*r,l(this.canvas,c),o(this.canvas,u)),h(this.canvas,s,this,this._jsPlumb.instance)}}};jsPlumbUtil.extend(p,d,{reattachListeners:function(){this.canvas&&this.reattachListenersForElement(this.canvas,this)}});var m=window.VmlEndpoint=function(t){d.apply(this,arguments),this._jsPlumb.vml=null,this.canvas=document.createElement("div"),this.canvas.style.position="absolute",this._jsPlumb.clazz=this._jsPlumb.instance.endpointClass+(t.cssClass?" "+t.cssClass:""),t._jsPlumb.appendElement(this.canvas,t.parent),this.paint=function(t,n){var e={},s=this._jsPlumb.vml;jsPlumbUtil.sizeElement(this.canvas,this.x,this.y,this.w,this.h),null==this._jsPlumb.vml?(e["class"]=this._jsPlumb.clazz,s=this._jsPlumb.vml=this.getVml([0,0,this.w,this.h],e,n,this.canvas,this._jsPlumb.instance),this.attachListeners(s,this),this.appendDisplayElement(s,!0),this.appendDisplayElement(this.canvas,!0),this.initOpacityNodes(s,["fill"])):(l(s,[0,0,this.w,this.h]),o(s,e)),h(s,t,this)}};jsPlumbUtil.extend(m,d,{reattachListeners:function(){this._jsPlumb.vml&&this.reattachListenersForElement(this._jsPlumb.vml,this)}}),jsPlumb.Segments.vml={SegmentRenderer:{getPath:function(t){return{Straight:function(t){var n=t.params;return"m"+u(n.x1)+","+u(n.y1)+" l"+u(n.x2)+","+u(n.y2)+" e"},Bezier:function(t){var n=t.params;return"m"+u(n.x1)+","+u(n.y1)+" c"+u(n.cp1x)+","+u(n.cp1y)+","+u(n.cp2x)+","+u(n.cp2y)+","+u(n.x2)+","+u(n.y2)+" e"},Arc:function(t){var n=t.params,e=Math.min(n.x1,n.x2),s=(Math.max(n.x1,n.x2),Math.min(n.y1,n.y2)),i=(Math.max(n.y1,n.y2),t.anticlockwise?1:0),r=t.anticlockwise?"at ":"wa ",o=function(){var r=[null,[function(){return[e,s]},function(){return[e-n.r,s-n.r]}],[function(){return[e-n.r,s]},function(){return[e,s-n.r]}],[function(){return[e-n.r,s-n.r]},function(){return[e,s]}],[function(){return[e,s-n.r]},function(){return[e-n.r,s]}]][t.segment][i]();return u(r[0])+","+u(r[1])+","+u(r[0]+2*n.r)+","+u(r[1]+2*n.r)};return r+o()+","+u(n.x1)+","+u(n.y1)+","+u(n.x2)+","+u(n.y2)+" e"}}[t.type](t)}}},jsPlumb.Endpoints.vml.Dot=function(){jsPlumb.Endpoints.Dot.apply(this,arguments),m.apply(this,arguments),this.getVml=function(t,n,e,s,i){return a("oval",t,n,s,i)}},jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Dot,m),jsPlumb.Endpoints.vml.Rectangle=function(){jsPlumb.Endpoints.Rectangle.apply(this,arguments),m.apply(this,arguments),this.getVml=function(t,n,e,s,i){return a("rect",t,n,s,i)}},jsPlumbUtil.extend(jsPlumb.Endpoints.vml.Rectangle,m),jsPlumb.Endpoints.vml.Image=jsPlumb.Endpoints.Image,jsPlumb.Endpoints.vml.Blank=jsPlumb.Endpoints.Blank,jsPlumb.Overlays.vml.Label=jsPlumb.Overlays.Label,jsPlumb.Overlays.vml.Custom=jsPlumb.Overlays.Custom;var f=function(t,n){t.apply(this,n),d.apply(this,n);var e=this;e.canvas=null,e.isAppendedAtTopLevel=!0;var s=function(t){return"m "+u(t.hxy.x)+","+u(t.hxy.y)+" l "+u(t.tail[0].x)+","+u(t.tail[0].y)+" "+u(t.cxy.x)+","+u(t.cxy.y)+" "+u(t.tail[1].x)+","+u(t.tail[1].y)+" x e"};this.paint=function(t,i){var u={},c=t.d,h=t.component;t.strokeStyle&&(u.stroked="true",u.strokecolor=jsPlumbUtil.convertStyle(t.strokeStyle,!0)),t.lineWidth&&(u.strokeweight=t.lineWidth+"px"),t.fillStyle&&(u.filled="true",u.fillcolor=t.fillStyle);var d=Math.min(c.hxy.x,c.tail[0].x,c.tail[1].x,c.cxy.x),p=Math.min(c.hxy.y,c.tail[0].y,c.tail[1].y,c.cxy.y),m=Math.max(c.hxy.x,c.tail[0].x,c.tail[1].x,c.cxy.x),f=Math.max(c.hxy.y,c.tail[0].y,c.tail[1].y,c.cxy.y),g=Math.abs(m-d),b=Math.abs(f-p),v=[d,p,g,b];if(u.path=s(c),u.coordsize=h.w*r+","+h.h*r,v[0]=h.x,v[1]=h.y,v[2]=h.w,v[3]=h.h,null==e.canvas){var y=h._jsPlumb.overlayClass||"",P=n&&1==n.length?n[0].cssClass||"":"";u["class"]=P+" "+y,e.canvas=a("shape",v,u,h.canvas.parentNode,h._jsPlumb.instance,!0),h.appendDisplayElement(e.canvas,!0),e.attachListeners(e.canvas,h),e.attachListeners(e.canvas,e)}else l(e.canvas,v),o(e.canvas,u)},this.reattachListeners=function(){e.canvas&&e.reattachListenersForElement(e.canvas,e)},this.cleanup=function(){null!=e.canvas&&jsPlumb.CurrentLibrary.removeElement(e.canvas)}};jsPlumbUtil.extend(f,d),jsPlumb.Overlays.vml.Arrow=function(){f.apply(this,[jsPlumb.Overlays.Arrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.Arrow,[jsPlumb.Overlays.Arrow,f]),jsPlumb.Overlays.vml.PlainArrow=function(){f.apply(this,[jsPlumb.Overlays.PlainArrow,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.PlainArrow,[jsPlumb.Overlays.PlainArrow,f]),jsPlumb.Overlays.vml.Diamond=function(){f.apply(this,[jsPlumb.Overlays.Diamond,arguments])},jsPlumbUtil.extend(jsPlumb.Overlays.vml.Diamond,[jsPlumb.Overlays.Diamond,f])}(),function(t){var n=function(n){return t("string"==typeof n?"#"+n:n)};jsPlumb.CurrentLibrary={addClass:function(t,e){t=n(t);try{t[0].className.constructor==SVGAnimatedString&&jsPlumbUtil.svg.addClass(t[0],e);
}catch(s){}try{t.addClass(e)}catch(s){}},animate:function(t,n,e){t.animate(n,e)},appendElement:function(t,e){n(e).append(t)},ajax:function(n){n=n||{},n.type=n.type||"get",t.ajax(n)},bind:function(t,e,s){t=n(t),t.bind(e,s)},destroyDraggable:function(n){t(n).data("draggable")&&t(n).draggable("destroy")},destroyDroppable:function(n){t(n).data("droppable")&&t(n).droppable("destroy")},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete"},extend:function(n,e){return t.extend(n,e)},getClientXY:function(t){return[t.clientX,t.clientY]},getDragObject:function(t){return t[1].draggable||t[1].helper},getDragScope:function(n){return t(n).draggable("option","scope")},getDropEvent:function(t){return t[0]},getDropScope:function(n){return t(n).droppable("option","scope")},getDOMElement:function(t){return null==t?null:"string"==typeof t?document.getElementById(t):t.context||null!=t.length?t[0]:t},getElementObject:n,getOffset:function(t){return t.offset()},getOriginalEvent:function(t){return t.originalEvent},getPageXY:function(t){return[t.pageX,t.pageY]},getParent:function(t){return n(t).parent()},getScrollLeft:function(t){return t.scrollLeft()},getScrollTop:function(t){return t.scrollTop()},getSelector:function(e,s){return 2==arguments.length?n(e).find(s):t(e)},getSize:function(n){return n=t(n),[n.outerWidth(),n.outerHeight()]},getTagName:function(t){var e=n(t);return e.length>0?e[0].tagName:null},getUIPosition:function(t,n){if(n=n||1,1==t.length)ret={left:t[0].pageX,top:t[0].pageY};else{var e=t[1],s=e.offset;ret=s||e.absolutePosition,e.position.left/=n,e.position.top/=n}return{left:ret.left/n,top:ret.top/n}},hasClass:function(t,n){return t.hasClass(n)},initDraggable:function(n,e,s,i){e=e||{},n=t(n),e.start=jsPlumbUtil.wrap(e.start,function(){t("body").addClass(i.dragSelectClass)},!1),e.stop=jsPlumbUtil.wrap(e.stop,function(){t("body").removeClass(i.dragSelectClass)}),e.doNotRemoveHelper||(e.helper=null),s&&(e.scope=e.scope||jsPlumb.Defaults.Scope),n.draggable(e)},initDroppable:function(n,e){e.scope=e.scope||jsPlumb.Defaults.Scope,t(n).droppable(e)},isAlreadyDraggable:function(n){return t(n).hasClass("ui-draggable")},isDragSupported:function(n,e){return t(n).draggable},isDropSupported:function(n,e){return t(n).droppable},removeClass:function(t,e){t=n(t);try{if(t[0].className.constructor==SVGAnimatedString)return void jsPlumbUtil.svg.removeClass(t[0],e)}catch(s){}t.removeClass(e)},removeElement:function(t){n(t).remove()},setDragFilter:function(t,n){jsPlumb.CurrentLibrary.isAlreadyDraggable(t)&&t.draggable("option","cancel",n)},setDraggable:function(t,n){t.draggable("option","disabled",!n)},setDragScope:function(t,n){t.draggable("option","scope",n)},setOffset:function(t,e){n(t).offset(e)},trigger:function(t,e,s){var i=jQuery._data(n(t)[0],"handle");i(s)},unbind:function(t,e,s){t=n(t),t.unbind(e,s)}},t(document).ready(jsPlumb.init)}(jQuery);